@model IEnumerable<PMTs.DataAccess.ModelView.Report.MasterCardMoRouting>
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@{
    Layout = null;
}

<table style="width:100% ;height:100% ;border-top:none;border-bottom:none;border-left:none;" class="tableMO">
    <tbody>
        <tr style="height: 100%; width: 100%;padding:0px;margin:0px">
            <td width="100%">
                <table class="tableMO" style="width: fit-content; border-bottom: none; border-left: none; border-right: none;" cellspacing="0" cellpadding="0">
                    <colgroup>
                        <col width="103">
                        <col width="103">
                        <col width="103">
                        <col width="103">
                        <col width="103">
                        <col width="103">
                    </colgroup>
                    <tr style="height: 45px;width:100%">
                        <td style="vertical-align: middle; border: 1px solid black; border-left: none;">
                            <div class="col-xs-4 text-center titleRouting">@Localizer["ยอดเข้า"]</div>
                        </td>
                        <td style="vertical-align: middle; border: 1px solid black;">
                            <div class="col-xs-4 text-center titleRouting">@Localizer["ยอดออก"]</div>
                        </td>
                        <td style="vertical-align: middle; border: 1px solid black;">
                            <div class="col-xs-4 text-center titleRouting">@Localizer["ของเสีย"]</div>
                        </td>
                        <td style="vertical-align: middle; border: 1px solid black;">
                            <div class="col-xs-4 text-center titleRouting">@Localizer["วันที่"]</div>
                        </td>
                        <td style="vertical-align: middle; border: 1px solid black;">
                            <div class="col-xs-4 text-center titleRouting">@Localizer["ผู้ผลิต"]</div>
                        </td>
                        <td style="vertical-align: middle; border: 1px solid black; border-right: none;">
                            <div class="col-xs-4 text-center titleRouting">@Localizer["QA/QC"]</div>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td colspan="6" style="vertical-align: text-top;">
                <div>
                    @foreach (var item in Model)
                    {
                        <div style="margin-left:5px;">
                            <div style="width:440px;word-wrap:break-word" class="titleRouting">@item.Routing.SeqNo. @item.Routing.Machine</div>
                        </div>

                        <table class="tableMO" style="width: fit-content; border-bottom: none; border-left: none; border-right: none;" height="30px" cellspacing="0" cellpadding="0">
                            <colgroup>
                                <col width="104">
                                <col width="108">
                                <col width="104">
                                <col width="104">
                                <col width="103">
                                <col width="103">
                            </colgroup>
                            <tr style="height: 30px;width:100%">
                                <td class="tableMO" style="border-bottom: 1px solid black; border-left: none;"></td>
                                <td class="tableMO" style="border-bottom: 1px solid black;"></td>
                                <td class="tableMO" style="border-bottom: 1px solid black;"></td>
                                <td class="tableMO" style="border-bottom: 1px solid black;"></td>
                                <td class="tableMO" style="border-bottom: 1px solid black;"></td>
                                <td class="tableMO" style="border-bottom: 1px solid black; border-right: none;"></td>
                            </tr>
                        </table>

                        <div style="margin-left:1px;" class="row">
                            <div id="routingMachine_@item.Routing.OrderItem@item.Routing.SeqNo" class="col-xs-12 labelRouting" style="word-wrap:break-word;white-space: pre-wrap;">@item.Routing.MachineDetail</div>
                        </div>
                        <div style="margin-left:1px;" class="row">
                            <div id="routingColor_@item.Routing.OrderItem@item.Routing.SeqNo" class="col-xs-12 labelRouting" style="word-wrap:break-word;">@item.Routing.MachineColorDetail</div>
                        </div>

                        var displayRemark = item.MachineGroup == "9" ? "นน. " + @item.Routing.WeightOut +" kg " + item.Routing.RemarkInprocess : item.Routing.RemarkInprocess ;
                        if (!String.IsNullOrEmpty(displayRemark))
                        {
                            <div style="margin-left:1px;float:none" class="row">
                                <div style="max-width:440px;white-space:pre-wrap;word-wrap:break-word; overflow-wrap:break-word;" class="col-xs-12 labelRouting">@Localizer["note"]: @displayRemark.ToString()</div>
                            </div>
                        }

                        <div class="row">
                            <hr class="col-xs-12 hrStyle" />
                        </div>
                    }
                </div>
            </td>
        </tr>
    </tbody>
</table>