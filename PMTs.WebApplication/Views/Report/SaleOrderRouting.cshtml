@*
    For more information on enabling MVC for empty projects, visit http://go.microsoft.com/fwlink/?LinkID=397860
*@

@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@model PMTs.DataAccess.ModelView.Report.SaleOrderModel
@using System.Linq

@{
    ViewData["Title"] = "Sale Order";
}

<style>
    #classModal {
    }

    .modal-body {
        overflow-x: auto;
    }

    .dataTables_wrapper .myfilter .dataTables_filter {
        float: left
    }

    .dataTables_wrapper .mylength .dataTables_length {
        float: right
    }

    .dataTables_wrapper table thead {
        display: none;
    }

    .WL input {
        padding: 3px;
        text-align: center;
    }

    .dd .control-label {
        font-size: 12px !important;
        width: 200px;
    }
</style>

<form id="RoutingForm" enctype="multipart/form-data">
    <div class="card">
        <div class="card-header">
            <div class="card-title">
                <div class="row justify-content-between">
                    <div class="col-sm-6">
                        <h3 class="text-themecolor">@Localizer["MoRouting"] </h3>
                    </div>
                    <div class="col-sm-6 text-right">
                        <h3>@Localizer["OrderItem"] : @Model.OrderSelect</h3>
                    </div>
                </div> <hr />
            </div>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-sm-12">
                    <div class="form-group">
                        <button type="button" class="btn btn-info waves-effect waves-light" id="btnNew"
                                data-toggle="tooltip" data-original-title="New">
                            <span class="btn-label"><i class="fa fa-plus-square"></i></span>  @Localizer["New"]
                        </button>
                        <button type="button" class="btn btn-success waves-effect waves-light" id="btnInsert"
                                data-toggle="tooltip" data-original-title="Insert">
                            <span class="btn-label"> <i class="fa fa-download"></i></span>   @Localizer["Insert"]
                        </button>

                        <button type="button" class="btn btn-warning waves-effect waves-light" id="btnEdit"
                                data-toggle="tooltip" data-original-title="Insert">
                            <span class="btn-label"> <i class="fa fa-edit"></i></span> @Localizer["Edit"]
                        </button>
                        <label class="control-label" id="lbl_status_insert" style="color:forestgreen;float:right"> </label>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-5" id="cardTitle">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">@Localizer["Title"]</h4>
                            <input type="hidden" asp-for="modelRouting.id" />
                            <input type="hidden" asp-for="modelRouting.SeqNo" />
                            <input type="hidden" asp-for="OrderSelect" />
                            <input type="hidden" asp-for="MaterialNo" />

                            <div class="form-group row">
                                <label class="col-sm-5 control-label">@Localizer["Group Machin"]e</label>
                                <div class="col-sm-7">

                                    <select class="form-control" asp-for="modelRouting.MachineGroupSelect" asp-items="@Model.modelRouting.MachineGroupSelectList">
                                        <option value="">@Localizer["Choose here"]</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-sm-5 control-label">@Localizer["Machine"]<i style="color:red"> *</i></label>
                                <div class="col-sm-7">
                                    <input class="form-control ui-autocomplete-input ui-autocomplete-loading" type="text" data-val="true" data-val-required="The Machine field is required." id="modelRouting_Machine" name="modelRouting.Machine" value="" autocomplete="off">
                                    @*<span asp-validation-for="modelRouting.Machine" class="text-danger"></span>*@
                                    <span id="modelRouting_Machine-error" class="text-danger" style="display: none;">The Machine field is required.</span>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-sm-5 control-label">@Localizer["Machine Move"]</label>
                                <div class="col-sm-7">

                                    <input type="checkbox" class="filled-in" asp-for="modelRouting.MachineMove">
                                    <label for="modelRouting_MachineMove"></label>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <label class="col-sm-5 control-label">@Localizer["Alternative 1"]</label>
                                    <div class="col-sm-7">

                                        <input class="form-control" asp-for="modelRouting.Alternative1" />
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <label class="col-sm-5 control-label">@Localizer["Alternative 2"]</label>
                                    <div class="col-sm-7">
                                        <input class="form-control" asp-for="modelRouting.Alternative2" />
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-12">
                                    <div class="box box-default collapsed-box">
                                        <div class="box-header with-border">
                                            <h3 class="box-title">
                                                <button id="btncolspan" type="button" class="btn btn-info waves-effect waves-light"
                                                        data-toggle="collapse" data-target="#Alternative-Collapse"
                                                        aria-expanded="false" aria-controls="Alternative-Collapse">

                                                    <span class="btn-label"><i class="fas fa-ellipsis-h"></i></span>@Localizer["More Alternative"]
                                                </button>
                                            </h3>
                                            <br />
                                        </div>
                                        <div class="collapse" id="Alternative-Collapse">
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-sm-5">@Localizer["Alternative 3"]</div>
                                                    <div class="col-sm-7">
                                                        <input class="form-control" asp-for="modelRouting.Alternative3" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-sm-5">@Localizer["Alternative 4"]</div>
                                                    <div class="col-sm-7">
                                                        <input class="form-control" asp-for="modelRouting.Alternative4" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-sm-5">@Localizer["Alternative 5"]</div>
                                                    <div class="col-sm-7">
                                                        <input class="form-control" asp-for="modelRouting.Alternative5" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-sm-5">@Localizer["Alternative 6"]</div>
                                                    <div class="col-sm-7">
                                                        <input class="form-control" asp-for="modelRouting.Alternative6" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-sm-5">@Localizer["Alternative 7"]</div>
                                                    <div class="col-sm-7">
                                                        <input class="form-control" asp-for="modelRouting.Alternative7" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="row">
                                                    <div class="col-sm-5">@Localizer["Alternative 8"]</div>
                                                    <div class="col-sm-7">
                                                        <input class="form-control" asp-for="modelRouting.Alternative8" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4" id="cardCalculate">
                    <div class="card" style="height:323px">
                        <div class="card-body">
                            <h4 class="card-title">@Localizer["In/Out properties"]</h4>
                            <div class="box-body">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>@Localizer["IO Title1"]</th>
                                            <th><center>@Localizer["IO Title2"]</center></th>
                                            <th><center>@Localizer["IO Title3"]</center></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="WL">
                                            <td>@Localizer["IO prop3"] x @Localizer["IO prop4"]<i style="color:red"> *</i></td>
                                            <td>
                                                <table>
                                                    <tr>
                                                        <td>
                                                            <input class="form-control input-number-only" asp-for="modelRouting.SheetWidthIn" autocomplete="off">
                                                            <span asp-validation-for="modelRouting.SheetWidthIn" class="text-danger"></span>
                                                        </td>
                                                        <td>
                                                            <input class="form-control input-number-only" asp-for="modelRouting.SheetLengthIn" autocomplete="off">
                                                            <span asp-validation-for="modelRouting.SheetLengthIn" class="text-danger"></span>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td>
                                                <table>
                                                    <tr>
                                                        <td>
                                                            <input class="form-control input-number-only" asp-for="modelRouting.SheetWidthOut" autocomplete="off">
                                                            <span asp-validation-for="modelRouting.SheetWidthOut" class="text-danger"></span>
                                                        </td>
                                                        <td>
                                                            <input class="form-control input-number-only" asp-for="modelRouting.SheetLengthOut" autocomplete="off">
                                                            <span asp-validation-for="modelRouting.SheetLengthOut" class="text-danger"></span>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>@Localizer["IO prop1"]<i style="color:red"> *</i></td>

                                            <td>
                                                <input class="form-control input-number-only" asp-for="modelRouting.NoOpenIn" autocomplete="off">
                                                <span asp-validation-for="modelRouting.NoOpenIn" class="text-danger"></span>
                                            </td>
                                            <td>
                                                <input class="form-control input-number-only" asp-for="modelRouting.NoOpenOut" autocomplete="off">
                                                @*<span asp-validation-for="modelRouting.NoOpenOut" class="text-danger"></span>*@
                                                <span id="modelRouting_NoOpenOut-error" class="text-danger" style="display: none;">The No Open Out field is required.</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>@Localizer["IO prop2"]<i style="color:red"> *</i></td>
                                            <td>
                                                <input class="form-control" asp-for="modelRouting.WeightIn" autocomplete="off" />
                                                <span asp-validation-for="modelRouting.WeightIn" class="text-danger"></span>
                                            </td>

                                            <td>
                                                <input class="form-control" asp-for="modelRouting.WeightOut" autocomplete="off" />
                                                <span asp-validation-for="modelRouting.WeightOut" class="text-danger"></span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="row" id="repeatLength">
                                    <label class="col-sm-5 control-label">Repeat Lenght</label>
                                    <div class="col-sm-7">
                                        <input class="form-control" asp-for="modelRouting.RepeatLength" autocomplete="off" />
                                    </div>
                                </div>
                                <div class="row" id="CustBarcodeNo" style="text-align:center">
                                    <label class="col-sm-12 control-label">Customer Barcode Number</label>
                                    <div class="col-sm-12">
                                        <input class="form-control" asp-for="modelRouting.CustBarcodeNo" autocomplete="off" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="card" style="height:323px">
                        <div class="card-body">
                            <div id="RoutingBox" style="height:290px;padding-right:3px">
                                <partial name="_RoutingDataList" model="Model" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6" id="cardProperty">
                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="box box-warning">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">@Localizer["IO prop6"]</h3>
                                    </div>
                                    <div class="box-body">
                                        <table class="table table-striped table-bordered">
                                            <thead>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>@Localizer["IO prop7"]</td>
                                                    <td>
                                                        <input class="form-control" asp-for="modelRouting.JoinToMaterialNo" autocomplete="off">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>@Localizer["IO prop8"]</td>
                                                    <td>
                                                        <input class="form-control" asp-for="modelRouting.SperateToMaterialNo" autocomplete="off">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <h3 class="box-title" style="padding-left:40px">
                                    <button id="btnSpecialProp" type="button" class="btn btn-info waves-effect waves-light"
                                            data-toggle="collapse" data-target="#SpecialProp-Collapse"
                                            aria-expanded="false" aria-controls="SpecialProp-Collapse">
                                        <span class="btn-label"><i class="fas fa-ellipsis-h"></i></span>Special Properties
                                    </button>
                                </h3>
                            </div>
                        </div>
                    </div>
                    <div class="collapse" id="SpecialProp-Collapse">
                        <div>
                            <div class="card card-outline">
                                <div class="card-header with-border">
                                    <h3 class="card-header">
                                        @Localizer["Special setup Properties"]
                                    </h3>
                                </div>
                                <div class="card-body">

                                    <div class="form-group row">
                                        <label asp-for="modelRouting.Speed" class="col-sm-4 control-label">
                                            @Localizer["Run speed"] :
                                        </label>
                                        <div class="col-sm-5">
                                            <input asp-for="modelRouting.Speed" class="form-control mytextboxNumber" autocomplete="off">
                                        </div>
                                        <label class="col-sm-2 control-label" id="labelRunSpeed">@Localizer["meter/hr."]</label>
                                    </div>
                                    <div class="form-group row">
                                        <label asp-for="modelRouting.SetupTm" class="col-sm-4 control-label">@Localizer["Setup Time"] :</label>
                                        <div class="col-sm-5">
                                            <input asp-for="modelRouting.SetupTm" class="form-control mytextboxNumber" autocomplete="off">
                                        </div>
                                        <label class="col-sm-2 control-label">@Localizer["mins"]</label>
                                    </div>
                                    <div class="form-group row">
                                        <label asp-for="modelRouting.PrepareTm" class="col-sm-4 control-label">@Localizer["Prepare Time"]:</label>
                                        <div class="col-sm-5">
                                            <input asp-for="modelRouting.PrepareTm" class="form-control mytextboxNumber" autocomplete="off">
                                        </div>
                                        <label class="col-sm-2 control-label">@Localizer["mins"]</label>
                                    </div>
                                    <div class="form-group row">
                                        <label asp-for="modelRouting.PostTm" class="col-sm-4 control-label">@Localizer["Post Time"] :</label>
                                        <div class="col-sm-5">
                                            <input asp-for="modelRouting.PostTm" class="form-control mytextboxNumber" autocomplete="off">
                                        </div>
                                        <label class="col-sm-2 control-label">@Localizer["mins"]</label>
                                    </div>
                                    <div class="form-group row">
                                        <label asp-for="modelRouting.SetupWaste" class="col-sm-4 control-label">@Localizer["Setup Waste"]:</label>
                                        <div class="col-sm-5">
                                            <input asp-for="modelRouting.SetupWaste" class="form-control mytextboxNumber" autocomplete="off">
                                        </div>
                                        <label class="col-sm-2 control-label">@Localizer["pcs"]</label>
                                    </div>
                                    <div class="form-group row">
                                        <label asp-for="modelRouting.RunWaste" class="col-sm-4 control-label">@Localizer["Run Waste"] :</label>
                                        <div class="col-sm-5">
                                            <input asp-for="modelRouting.RunWaste" class="form-control mytextboxNumber" autocomplete="off">
                                        </div>
                                        <label class="col-sm-2 control-label">@Localizer[""]แผ่น</label>
                                    </div>
                                    <div class="form-group row">
                                        <label asp-for="modelRouting.Totalcolor" class="col-sm-4 control-label">Total Color :</label>
                                        <div class="col-sm-5">
                                            <input asp-for="modelRouting.Totalcolor" class="form-control mytextboxNumber" autocomplete="off">
                                        </div>
                                        <label class="col-sm-2 control-label">@Localizer[""]</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="card card-outline">
                                <h4 class="card-header">
                                    @Localizer["Spacial stacking Properties"]
                                </h4>
                                <div class="card-body">

                                    <div class="form-group row">
                                        <label asp-for="modelRouting.StackHeight" class="col-sm-4 control-label">
                                            @Localizer["Sheet / Stack"] :
                                        </label>
                                        <div class="col-sm-5">
                                            <input asp-for="modelRouting.StackHeight" class="form-control mytextboxNumber" autocomplete="off">
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="col-sm-4 control-label">Rotation :</label>
                                        <div class="col-sm-3 dd">
                                            <input type="radio" class="group1 control-label" id="noRotate" asp-for="modelRouting.Rotate" value="noRotate">
                                            <label for="noRotate" class="control-label"> @Localizer["No Rotate"]</label>
                                            <br />
                                            <input type="radio" class="group1 control-label" id="modelRouting_RotateIn" asp-for="modelRouting.Rotate" value="rotateIn">
                                            <label for="modelRouting_RotateIn" class="control-label"> @Localizer["Rotation In"]</label>
                                            <br />
                                            <input type="radio" class="group1 control-label" id="modelRouting_RotateOut" asp-for="modelRouting.Rotate" value="rotateOut">
                                            <label for="modelRouting_RotateOut" class="control-label"> @Localizer["Rotation out"]</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <h3>@Localizer["Remark"] <span style="float:right"><i class="fas fa-plus-circle" id="btnGetRemark"></i></span></h3>
                            <textarea class="form-control center" style="height:210px" asp-for="modelRouting.Remark" rows="4" maxlength="300" id="modelRouting_Remark"></textarea>
                            <small id="charCount" class="form-text text-muted" style="text-align: right;">0 / 300</small>
                            <div id="remarkAttachFileBox" style="display:none;">
                                @*<div id="remarkAttachFileBox" style="display: flex;">*@
                                    <input type="hidden" asp-for="modelRouting.RemarkAttachFileStatus" />
                                    <input type="file" id="remarkAttachFile" name="remarkAttachFile" style="display: none;">
                                    <button type="button" id="btnRemarkAttachFileUpload">Choose File</button>
                                    <label for="remarkAttachFile" id="lblRemarkAttachFileName" style="width: auto; margin-top: 5px; margin-left: 5px; color: #555;">No File Choose</label>
                                    <button type="button" class="btn btn-danger remove-me" id="btnRemoveAttachFile" style="display: none; margin-left: 5px;">x</button>
                                </div>
                            </div>
                        </div>
                </div>
                <div class="col-sm-6" id="cardCorrugator">
                    <div class="card" id="MachineTypeCor" style="display:none;">
                        <div class="card-body">
                            <div class="row">
                                <div class="box box-warning">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">  @{ @Localizer["Corrugator properties"] } <span style="text-align:right;margin-right:14px;float: right;color: blue;"><i class="fas fa-calculator" style="cursor:pointer;" data-toggle="tooltip" title="Re-Calculate" id="ReCalculate"></i></span></h3>
                                    </div>
                                    <div class="box-body">
                                        <table class="table table-striped table-bordered">
                                            <tbody>
                                                <tr>
                                                    <td>@Localizer["Cor properties 1"]</td>
                                                    <td>
                                                        <input class="form-control" asp-for="modelRouting.PaperRollWidth" autocomplete="off">
                                                    </td>
                                                    <td>@Localizer["Cor properties 2"]</td>
                                                    <td>
                                                        <input class="form-control" asp-for="modelRouting.Cut" autocomplete="off">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>@Localizer["Cor properties 3"]</td>
                                                    <td>
                                                        <input class="form-control" asp-for="modelRouting.Trim" readonly autocomplete="off">
                                                    </td>
                                                    <td>@Localizer["Cor properties 4"]</td>
                                                    <td>
                                                        <input class="form-control" asp-for="modelRouting.PercentTrim" readonly autocomplete="off">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>@Localizer["Score Type"]</td>
                                                    <td colspan="3">
                                                        <select class="form-control" asp-for="modelRouting.ScoreType" asp-items="@Model.modelRouting.ScoreTypelist">
                                                            <option value="">@Localizer["Choose here"]</option>
                                                        </select>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>@Localizer["Score Gap"]</td>
                                                    <td colspan="3">
                                                        @*<select class="form-control" asp-for="modelRouting.ScoreGap" asp-items="@Model.modelRouting.ScoreGapList">
                                                                <option value="">@Localizer["Choose here"]</option>
                                                            </select>*@
                                                        <input class="form-control" asp-for="modelRouting.ScoreGap" autocomplete="off">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>@Localizer["Cor properties 5"]  </td>
                                                    <td colspan="3">
                                                        <input type="checkbox" asp-for="modelRouting.TearTape" class="filled-in" autocomplete="off">
                                                        <label class="form-check-label" asp-for="modelRouting.TearTape"></label>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>

                                        <table class="table table-striped table-bordered" style="display: none;" id="TeartapeBox">
                                            <tr>
                                                <td> @Localizer["Cor properties 6"] </td>
                                                <td>
                                                    <input class="form-control" asp-for="modelRouting.LineQtyPerBox" onkeyup="manage(this)" maxlength="18" autocomplete="off">
                                                </td>
                                            </tr>
                                            <tr>
                                                <td> @Localizer["Cor properties 7"] </td>
                                                <td>
                                                    <input class="form-control" asp-for="modelRouting.MarginForPaper" disabled maxlength="18" autocomplete="off">
                                                </td>
                                            </tr>
                                        </table>
                                        <div id="sample-tearTape" style="display:none;">
                                            <img src="~/images/teartape.jpg" style="width:100%;" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card" id="MachineTypePrinting" style="display:none;">
                        <div class="card-body">
                            <div class="row" id="MachineTypePrinting">
                                <div class="box box-warning">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">@Localizer["Printing properties"]</h3>
                                    </div>
                                    <div class="box-body">
                                        <div class="form-group">
                                            <table class="table table-striped table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>@Localizer["Title Printing prop1"]</th>
                                                        <th>@Localizer["Title Printing prop2"]</th>
                                                        <th>@Localizer["Title Printing prop3"]</th>
                                                        <th>@Localizer["Title Printing prop4"]</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>@Localizer["Printing prop1"]</td>
                                                        <td>
                                                            <select class="form-control" asp-for="modelRouting.Ink1" asp-items="@Model.modelRouting.InkSelectList">
                                                                <option value="">@Localizer["Choose here"]</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select class="form-control" asp-for="modelRouting.Shade1" asp-items="@Model.modelRouting.ShadeSelectList">
                                                                <option value="">@Localizer["Choose here"]</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <input class="form-control" asp-for="modelRouting.Area1" disabled type="number" autocomplete="off">
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>@Localizer["Printing prop2"]</td>
                                                        <td>
                                                            <select class="form-control" asp-for="modelRouting.Ink2" asp-items="@Model.modelRouting.InkSelectList">
                                                                <option value="">@Localizer["Choose here"]</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select class="form-control" asp-for="modelRouting.Shade2" asp-items="@Model.modelRouting.ShadeSelectList">
                                                                <option value="">@Localizer["Choose here"]</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <input class="form-control" asp-for="modelRouting.Area2" disabled type="number" autocomplete="off">
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>@Localizer["Printing prop3"]</td>
                                                        <td>
                                                            <select class="form-control" asp-for="modelRouting.Ink3" asp-items="@Model.modelRouting.InkSelectList">
                                                                <option value="">@Localizer["Choose here"]</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select class="form-control" asp-for="modelRouting.Shade3" asp-items="@Model.modelRouting.ShadeSelectList">
                                                                <option value="">@Localizer["Choose here"]</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <input class="form-control" asp-for="modelRouting.Area3" disabled type="number" autocomplete="off">
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>@Localizer["Printing prop4"]</td>
                                                        <td>
                                                            <select class="form-control" asp-for="modelRouting.Ink4" asp-items="@Model.modelRouting.InkSelectList">
                                                                <option value="">@Localizer["Choose here"]</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select class="form-control" asp-for="modelRouting.Shade4" asp-items="@Model.modelRouting.ShadeSelectList">
                                                                <option value="">@Localizer["Choose here"]</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <input class="form-control" asp-for="modelRouting.Area4" disabled type="number" autocomplete="off">
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="col-sm-12">
                                            <div class="box box-default collapsed-box">
                                                <div class="box-header with-border">
                                                    <div class="box-tools pull-right">
                                                        <button type="button" class="btn btn-info waves-effect waves-light" data-toggle="collapse" data-target="#Color-Collapse" aria-expanded="false" aria-controls="Color-Collapse">
                                                            <span class="btn-label"><i class="fas fa-ellipsis-h"></i></span>@Localizer["Printing prop"]
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="collapse" id="Color-Collapse">
                                                    <div class="form-group">
                                                        <table class="table table-striped table-bordered">
                                                            <thead>
                                                                <tr>
                                                                    <th>@Localizer["Title Printing prop5"]</th>
                                                                    <th><center>@Localizer["Title Printing prop6"]</center></th>
                                                                    <th><center>@Localizer["Title Printing prop7"]</center></th>
                                                                    <th><center>@Localizer["Title Printing prop8"]</center></th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr>
                                                                    <td>@Localizer["Printing prop5"]</td>
                                                                    <td>
                                                                        <select class="form-control" asp-for="modelRouting.Ink5" asp-items="@Model.modelRouting.InkSelectList">
                                                                            <option value="">--- Choose here ---</option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <select class="form-control" asp-for="modelRouting.Shade5" asp-items="@Model.modelRouting.ShadeSelectList">
                                                                            <option value="">@Localizer["Choose here"]</option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <input class="form-control" asp-for="modelRouting.Area5" type="number" autocomplete="off">
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>@Localizer["Printing prop6"]</td>
                                                                    <td>
                                                                        <select class="form-control" asp-for="modelRouting.Ink6" asp-items="@Model.modelRouting.InkSelectList">
                                                                            <option value="">@Localizer["Choose here"]</option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <select class="form-control" asp-for="modelRouting.Shade6" asp-items="@Model.modelRouting.ShadeSelectList">
                                                                            <option value="">@Localizer["Choose here"]</option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <input class="form-control" asp-for="modelRouting.Area6" type="number" autocomplete="off">
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>@Localizer["Printing prop7"]</td>
                                                                    <td>
                                                                        <select class="form-control" asp-for="modelRouting.Ink7" asp-items="@Model.modelRouting.InkSelectList">
                                                                            <option value="">@Localizer["Choose here"]</option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <select class="form-control" asp-for="modelRouting.Shade7" asp-items="@Model.modelRouting.ShadeSelectList">
                                                                            <option value="">@Localizer["Choose here"]</option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <input class="form-control" asp-for="modelRouting.Area7" type="number" autocomplete="off">
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>@Localizer["Printing prop8.2"]</td>
                                                                    <td>
                                                                        <select class="form-control" asp-for="modelRouting.Ink8" asp-items="@Model.modelRouting.InkSelectList">
                                                                            <option value="">@Localizer["Choose here"]</option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <select class="form-control" asp-for="modelRouting.Shade8" asp-items="@Model.modelRouting.ShadeSelectList">
                                                                            <option value="">@Localizer["Choose here"]</option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <input class="form-control" asp-for="modelRouting.Area8" type="number" autocomplete="off">
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <table class="table table-striped table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>@Localizer["Properties printing"] </th>
                                                    <th>@Localizer["value printing"]</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>
                                                        @Localizer["Printing prop8"]
                                                    </td>
                                                    <td>
                                                        <input class="form-control" asp-for="modelRouting.PrintingPlateNo" maxlength="50" autocomplete="off">
                                                        <span id="modelRouting_PrintingPlateNo-error" class="text-danger" style="display: none;">The PrintingPlateNo field is required.</span>
                                                    </td>
                                                </tr>
                                                <tr id="mylaisnodiecut">
                                                    <td>@Localizer["Printing prop10"]</td>
                                                    <td>
                                                        <input class="form-control" asp-for="modelRouting.MylaNo_Copy" maxlength="50" autocomplete="off">
                                                    </td>
                                                </tr>
                                                <tr style="display:none">
                                                    <td>@Localizer["MylaSize."]</td>
                                                    <td>
                                                        <input class="form-control" asp-for="modelRouting.MylaSize" maxlength="50" autocomplete="off">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <div class="container1" id="printContrainer">
                                            <div class='element1' id='divprint_1'>
                                                <i class="fa fa-plus-circle addprint" style="font-size:22px" aria-hidden="true" id="addprint"></i>
                                                <span class="text-danger">*กดกรณี Plate มากกว่า 1</span>
                                            </div>
                                        </div>
                                        <table class="table table-striped table-bordered">
                                            <thead>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>
                                                        @Localizer["Printing prop11"]
                                                    </td>
                                                    <td>
                                                        <div class="row">
                                                            <div class="col-sm-5">
                                                                <input type="radio" class="with-gap" id="Non-Print" asp-for="modelRouting.PrintingPlateType" value="Non-Print">
                                                                <label for="Non-Print" class="control-label">@Localizer["Printing prop11.1"]</label>
                                                            </div>
                                                            <div class="col-sm-5">
                                                                <input type="radio" class="with-gap" id="Standard" asp-for="modelRouting.PrintingPlateType" value="Standard">
                                                                <label for="Standard" class="control-label">@Localizer["Printing prop11.2"]</label>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-sm-5">
                                                            </div>
                                                            <div class="col-sm-5">
                                                                <input type="radio" class="with-gap" id="Semi" asp-for="modelRouting.PrintingPlateType" value="Semi">
                                                                <label for="Semi" class="control-label">@Localizer["Printing prop11.3"]</label>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-sm-5">
                                                            </div>
                                                            <div class="col-sm-6">
                                                                <input type="radio" class="with-gap" id="Shipping-Mark" asp-for="modelRouting.PrintingPlateType" value="Shipping Mark">
                                                                <label for="Shipping-Mark" class="control-label">@Localizer["Printing prop11.4"] </label>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card" id="MachineTypeDieCutProperty" style="display: none;">
                        <div class="card-body">
                            <div class="row" id="MachineTypeDieCut">
                                <div class="box box-warning">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">@Localizer["Die Cut properties"]</h3>
                                    </div>
                                    <div class="box-body">
                                        <table class="table table-striped table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>@Localizer["Properties printing"] </th>
                                                    <th>@Localizer["value printing"]</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>@Localizer["Printing prop9"]</td>
                                                    <td>
                                                        <input class="form-control" asp-for="modelRouting.CuttingDieNo" maxlength="50" autocomplete="off">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>@Localizer["Printing prop10"]</td>
                                                    <td>
                                                        <input class="form-control" asp-for="modelRouting.MylaNo" maxlength="50" autocomplete="off">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <div class="container" id="DiecutContainer">
                                            <div class='element' id='div_1'>
                                                <i class="fa fa-plus-circle add" style="font-size:22px" aria-hidden="true" id="addDieCut"></i>
                                                <span class="text-danger">*กดกรณี Block มากกว่า 1</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <input type="hidden" id="formHiddenFieldDiecut" asp-for="arrayDiecut" />
        <input type="hidden" id="formHiddenFieldPrint" asp-for="arrayPrint" />
        <input type="hidden" id="checkStatusBtn" />
        <section class="card-footer">
            <div class="row col-sm-12 ">
                <div class="col-sm-6">
                    <button type="button" class="btn btn-primary" id="btnAddMachine"><span class="btn-label"> <i class="fa fa-check"></i> </span>@Localizer["Bt-Add"] </button>
                    <button type="button" class="btn btn-primary" id="btnUpdateMachine" style="display: none;">@Localizer["Bt-Update"] </button>
                    <button type="button" class="btn btn-primary" id="btnInsertMachine" style="display: none;">@Localizer["Bt-Insert"]</button>
                </div>
                <div class="col-sm-6 text-right">
                    <button type="button" id="btnPrintMo"  onclick="PrintMastercardMO()" class="btn btn-success btn-fixsize"> @Localizer["Print"] <i class="fa fa-save"></i> </button>
                    <button type="button" id="btnSubmit" class="btn btn-success btn-fixsize"> @Localizer["Back"] <i class="fa fa-arrow-circle-right"></i></button>
                </div>
            </div>
        </section>
    </div>
    <div id="modalRemark" class="modal bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="classInfo" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        ×
                    </button>
                </div>
                <div class="modal-body ">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-4 col-sm-4">
                                    <table id="tblRemarkMachine" class="table table-striped table-bordered" style="width:100%">
                                        <thead>
                                            <tr>
                                                <th>Group</th>
                                            </tr>
                                        </thead>
                                        <tbody style="cursor:pointer">
                                            @{
                                                if (Model.modelGroupMachineRemark != null)
                                                {
                                                    foreach (var item in Model.modelGroupMachineRemark)
                                                    {
                                                        <tr>
                                                            <td>@item</td>
                                                        </tr>
                                                    }

                                                }

                                            }
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-8 col-sm-8" id="renderRemark">
                                    @*<partial name="_Routing_TblRemarkList" model="Model" />*@
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>

<!-- Modal -->
<div class="modal in" id="modal-show-Insert-seq" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title text-themecolor">Insert Before </h2>
            </div>
            <div class="modal-body text-center">
                <div id="dropdown_seq_partial">
                    <partial name="_Routing_DropdownSeq" model="Model" />
                </div>
                @* <div class="swal2-icon swal2-input swal2-animate-success-icon" style="display: flex;"><div class="swal2-success-fix" style="background-color: rgb(255, 255, 255);"></div><span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span><div class="swal2-success-ring"></div> <div class="swal2-success-fix" style="background-color: rgb(255, 255, 255);"></div><div class="swal2-success-circular-line-right" style="background-color: rgb(255, 255, 255);"></div></div>*@
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger waves-effect waves-light" style="width:60px" id="BtnCancelModal" type="button"><i class="fa fa-times"></i></button>
                <button class="btn btn-success waves-effect waves-light" style="width:60px" id="BtnInsertModal" type="button"><i class="fa fa-check"></i></button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/lib/material-pro/assets/plugins/sweetalert/sweetalert.min.js"></script>
    <script src="~/lib/bootsbox/bootbox.js"></script>
    <script>
        //*************************************************** Document Ready **************************************
         $(document).ready(function () {
             PlatTypeRadioCheck(@Model.amountColor);
            // CheckEnableButtonSave();
             CheckFormGroupIsTCG('@Model.FormGroup');
             CheckFormGroupIsBOM('@Model.FormGroup','@Model.MatCode');
            // CheckEnableButtonSaveByCopy();

            $('#checkStatusBtnEdit').val("")

            $('#repeatLength').hide();
            $('#CustBarcodeNo').hide();
            $("#modelRouting_MachineMove").prop('checked', true);

            if ($("#modelRouting_MachineMove").prop('checked') == false) {
                $("#modelRouting_Alternative1").attr("disabled", "disabled");
                $("#modelRouting_Alternative2").attr("disabled", "disabled");
                $("#btncolspan").attr("disabled", "disabled");
            }

            $('#tblRemarkMachine').dataTable({
                "scrollY": "300px",
                "scrollCollapse": true,
                "paging": false,
                "ordering": false,
                "info": false,
                dom: "<'myfilter'f><'mylength'l>t",

                fixedHeader: {
                    header: true,
                    footer: true
                },
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Search Group"
                }
            });

            var table = $('#tblRemarkMachine').DataTable();

            $('#tblRemarkMachine tbody').on('click', 'tr', function () {
                var datamachine = table.row(this).data();
                $.ajax({
                    url: '@Url.Action("RenderTblRemark", "Report")',
                    type: "POST",
                    dataType: "json",
                    data: { machine: datamachine[0] },
                    success: function (res) {
                        $('#renderRemark').html(res);
                    },
                    error: function () {  }
                });
            });

             $.ajax({
                    url: '@Url.Action("RenderTblRemarkNosearch", "Report")',
                    type: "POST",
                    dataType: "json",
                    success: function (res) {
                        $('#renderRemark').html(res);
                    },
                    error: function () {  }
            });

             $(function () {
                    $('.list-group').on('click', '.list-group-item', function () {
                        $('.list-group-item').removeClass('active');
                        $(this).closest('.list-group-item').addClass('active');
                    });
            });

        $(".addprint").click(function () {
                // Finding total number of elements added
            var total_element = $(".element1").length;
                // last <div> with element class id
                var lastid = $(".element1:last").attr("id");
                var split_id = lastid.split("_");
                var nextindex = Number(split_id[1]) + 1;
                var max = 5;
                // Check total number elements
                if (total_element < max) {
                    // Adding new div container after last occurance of element class
                    $(".element1:last").after("<div class='element1 card card-outline-danger text-center' id='divprint_" + nextindex + "'></div>");
                    $("#divprint_" + nextindex).append('<span style="text-align:right ; margin-right:10px"><i class="fa fa-times removetagprint" id=divprint_' + nextindex + '></i></span><div class="card-block"><table class="table table-striped table-bordered"><thead></thead><tbody><tr><td>@Localizer["Printing prop8"]</td><td><input class="form-control" asp-for="modelRouting.PrintingPlateNo"><span id="modelRouting_PrintingPlateNo-error" class="text-danger" style="display: none;">The PrintingPlateNo field is required.</span></td><td>@Localizer["Plant"]</td><td><input class="form-control" asp-for="modelRouting.PrintingPlateNo"><span id="modelRouting_PrintingPlateNo-error" class="text-danger" style="display: none;">The PrintingPlateNo field is required.</span></td></tr><tbody></table>');
                }
         });

            // Remove element
            $('.container1').on('click', '.removetagprint', function () {
                var id = this.id;
                var split_id = id.split("_");
                var deleteindex = split_id[1];
                swal({
                    title: "Are you sure ?",
                    text: "Do you want delete Printing plate .",
                    icon: "warning",
                    buttons: {
                        confirm: "Yes",
                        cancel: "No",
                    },
                    dangerMode: true,
                })
                    .then((willDelete) => {
                        if (willDelete) {
                            $("#divprint_" + deleteindex).remove();
                        }
                    });

            });

              // Add new element
        $(".add").click(function () {
                // Finding total number of elements added
                var total_element = $(".element").length;
                // last <div> with element class id
                var lastid = $(".element:last").attr("id");
                var split_id = lastid.split("_");
                var nextindex = Number(split_id[1]) + 1;
                var max = 5;
                // Check total number elements
                if (total_element < max) {
                    // Adding new div container after last occurance of element class
                  //  $(".element:last").after("<div class='element' id='div_" + nextindex + "'></div>");
                    $(".element:last").after("<div class='element card card-outline-danger text-center' id='div_" + nextindex + "'></div>");
                    // Adding element to <div>
                    $("#div_" + nextindex).append("<span style='text-align:right ; margin-right:10px'><i class='fa fa-times removetag' id='div_" + nextindex + "'></i></span><div class='card-block'><table class='table table-striped table-bordered'><thead></thead><tbody><tr><td>@Localizer["Printing prop9"]</td><td><input class='form-control' asp-for='modelRouting.CuttingDieNo'</td><td>@Localizer["Plant"]</td><td> <input class='form-control' asp-for='modelRouting.CuttingDieNo'> </td></tr>  <tr> <td>@Localizer["Printing prop10"]</td><td><input class='form-control' asp-for='modelRouting.MylaNo'> </td><td>@Localizer["Plant"]</td><td><input class='form-control' asp-for='modelRouting.CuttingDieNo'></td></tr></tbody></table></div>");
                }
        });
                // Remove element
                $('.container').on('click', '.removetag', function () {
                    var id = this.id;
                    var split_id = id.split("_");
                    var deleteindex = split_id[1];
                    swal({
                        title: "Are you sure ?",
                        text: "Do you want delete Cuting die .",
                        icon: "warning",

                        buttons: {
                            confirm: "Yes",
                            cancel: "No",
                        },
                        dangerMode: true,
                    })
                        .then((willDelete) => {
                            if (willDelete)
                            {
                                $("#div_" + deleteindex).remove();
                            }
                        });
                });
             $('#modelRouting_Remark').on('input', function () {
                 countCharacters();
             });
        });

        function PlatTypeRadioCheck(type) {
            if ('@Model.RealEventFlag' === "Presale") {
                if (type === 0) {
                    $("#Non-Print").prop("checked", true);
                    $("#Standard").prop("checked", false);
                    $("#Non-Print").attr("disabled", false);
                    $("#Standard").attr("disabled", false);
                    $("#Semi").attr("disabled", false);
                    $("#Shipping-Mark").attr("disabled", false);
                }
                else {
                    $("#Non-Print").prop("checked", false);
                    $("#Standard").prop("checked", true);
                    $("#Non-Print").attr("disabled", false);
                    $("#Standard").attr("disabled", false);
                    $("#Semi").attr("disabled", false);
                    $("#Shipping-Mark").attr("disabled", false);
                }
            } else
            {
                if (type === 0) {
                    $("#Non-Print").prop("checked", true);
                    $("#Standard").prop("checked", false);
                    $("#Standard").attr("disabled", true);
                    $("#Semi").attr("disabled", true);
                    $("#Shipping-Mark").attr("disabled", true);

                    $("#Non-Print").attr("disabled", false);
                }
                else {
                    $("#Non-Print").prop("checked", false);
                    $("#Standard").prop("checked", true);
                    $("#Non-Print").attr("disabled", true);
                    $("#Standard").attr("disabled", false);
                    $("#Semi").attr("disabled", false);
                    $("#Shipping-Mark").attr("disabled", false);
                }
            }
        }

        function CheckEnableButtonSave()
        {
                @*$.ajax({
                url: '@Url.Action("CheckDisableButtonSave", "Report")',
                type: "POST",
                dataType: "json",
                data: { OrderItem: '@Model.OrderSelect' },
                success: function (ress) {
                    if (ress.CheckButtonEnable === "1")
                    {
                        $("#btnSubmit").show();  //css("display", "block");
                    }
                    else
                    {
                        $("#btnSubmit").hide();//css("display", "none");
                    }
                },
                error: function () { }
            });*@
        }

        function CheckFormGroupIsTCG(formgroup) {
            if (formgroup === "BOM" || formgroup === "TCG" || formgroup === "DIGITAL")
            {
                $.ajax({
                    url: '@Url.Action("GetWeight", "Report")',
                    data: { OrderItem: '@Model.OrderSelect' },
                    dataType: "json",
                    success: function (data) {
                        $('#modelRouting_WeightOut').val(data[1]);
                        $('#modelRouting_WeightIn').val(data[1]);
                    }
                });
            }
        }

        function CheckFormGroupIsBOM(formgroup , matcode)
        {
            if (formgroup === "BOM" || formgroup === "TCG" || formgroup === "DIGITAL")
            {
            document.querySelector('#modelRouting_MachineGroupSelect').value = '9';
            document.querySelector('#modelRouting_Machine').value = 'คลัง';
            var countroutinglst = @Model.modelRouting.RoutingDataList.Count() ;
            if (countroutinglst  > 0 )
            {
              //  CheckEnableButtonSaveByCopy();
            }
            else
            {
                subAddMachine();
            }
            } else
            if (matcode === "14" || matcode === "24" || matcode === "84")
            {
                document.querySelector('#modelRouting_MachineGroupSelect').value = '9';
                document.querySelector('#modelRouting_Machine').value = 'คลัง';
                var countroutinglst = @Model.modelRouting.RoutingDataList.Count() ;
                if (countroutinglst  > 0 )
                {
                   // CheckEnableButtonSaveByCopy();
                }
                else
                {
                    subAddMachine();
                }
            }
        }

        function CheckEnableButtonSaveByCopy()
        {
                @*$.ajax({
                    url: '@Url.Action("CheckDisableButtonSaveByCopy", "Report")',
                    type: "POST",
                    dataType: "json",
                    data: { OrderItem: '@Model.OrderSelect' },
                    success: function (ress) {
                        if (ress.CheckButtonEnable === "1")
                        {
                            $("#btnSubmit").show();  //css("display", "block");
                        }
                        else
                        {
                            $("#btnSubmit").hide();//css("display", "none");
                        }
                    },
                    error: function () { }
                });*@
        }
         //***************************************************End Document Ready **************************************

        //*************************************************** Bind Data **************************************
         //Routing Data List
        function RoutingSelect(value) {
            $('#btnAddMachine').css('display', 'none');
            $('#btnUpdateMachine').css('display', 'block');
            seqNoSelect = value;
            $('#modelRouting_SeqNo').val(seqNoSelect);

            $('#lbl_status_insert').text('');

            $.ajax({
                type: 'POST',
                async: false,
                url: '@Url.Action("GetRoutingData", "Report")',
                data: { seqNo: seqNoSelect,OrderItem:'@Model.OrderSelect' },
                success: function (res) {

                    $('#modelRouting_SeqNo').val(res[0].SeqNo);
                    $('#modelRouting_MachineGroupSelect').val(res[0].MachineGroupSelect);
                    $('#modelRouting_Machine').val(res[0].Machine); if (res[0].CopyStatus) $('#modelRouting_Machine').prop('disabled', true); else $('#modelRouting_Machine').prop('disabled', false);
                    if (res[0].MachineMove)
                    {
                        $('#modelRouting_MachineMove').prop('checked', true);

                        $('#modelRouting_Alternative1').prop('disabled', false);
                        $('#modelRouting_Alternative2').prop('disabled', false);
                        $('#btncolspan').prop('disabled', false);

                    } else {
                        $('#modelRouting_MachineMove').prop('checked', false);

                        $('#modelRouting_Alternative1').prop('disabled', true);
                        $('#modelRouting_Alternative2').prop('disabled', true);
                        $('#btncolspan').prop('disabled', true);

                        ClearAlternative();
                    }

                    $("#modelRouting_MylaSize").val(res[0].MylaSize);

                    var radioRotate = res[0].Rotate;
                    $("INPUT[name='modelRouting.Rotate']").val([radioRotate]);

                    BindPrintArray(res[0].PlateNo2, res[0].PlateNoPlant2, res[0].PlateNo3, res[0].PlateNoPlant3, res[0].PlateNo4, res[0].PlateNoPlant4, res[0].PlateNo5, res[0].PlateNoPlant5);
                    BindDieCutArray(res[0].BlockNo2, res[0].BlockNoPlant2, res[0].MylaNo2, res[0].MylaNoPlant2, res[0].BlockNo3, res[0].BlockNoPlant3, res[0].MylaNo3, res[0].MylaNoPlant3, res[0].BlockNo4, res[0].BlockNoPlant4, res[0].MylaNo4, res[0].MylaNoPlant4, res[0].BlockNo5, res[0].BlockNoPlant5, res[0].MylaNo5, res[0].MylaNoPlant5);

                    $('#modelRouting_Alternative1').val(res[0].Alternative1);
                    $('#modelRouting_Alternative2').val(res[0].Alternative2);
                    $('#modelRouting_Alternative3').val(res[0].Alternative3);
                    $('#modelRouting_Alternative4').val(res[0].Alternative4);
                    $('#modelRouting_Alternative5').val(res[0].Alternative5);
                    $('#modelRouting_Alternative6').val(res[0].Alternative6);
                    $('#modelRouting_Alternative7').val(res[0].Alternative7);
                    $('#modelRouting_Alternative8').val(res[0].Alternative8);

                    // In/Out properties
                    $('#modelRouting_NoOpenIn').val(res[0].NoOpenIn);
                    $('#modelRouting_NoOpenOut').val(res[0].NoOpenOut);
                    $('#modelRouting_WeightIn').val(res[0].WeightIn);
                    $('#modelRouting_WeightOut').val(res[0].WeightOut);
                    $('#modelRouting_SheetLengthIn').val(res[0].SheetLengthIn);
                    $('#modelRouting_SheetLengthOut').val(res[0].SheetLengthOut);
                    $('#modelRouting_SheetWidthIn').val(res[0].SheetWidthIn);
                    $('#modelRouting_SheetWidthOut').val(res[0].SheetWidthOut);
                    $('#modelRouting_Coat').val(res[0].Coat);

                    // Join to/ Sperate to
                    $('#modelRouting_JoinToMaterialNo').val(res[0].JoinToMaterialNo);
                    $('#modelRouting_SperateToMaterialNo').val(res[0].SperateToMaterialNo);

                    // Corrugator properties
                    $('#modelRouting_PaperRollWidth').val(res[0].PaperRollWidth);
                    $('#modelRouting_Cut').val(res[0].Cut);
                    $('#modelRouting_Trim').val(res[0].Trim);
                    $('#modelRouting_PercentTrim').val(res[0].PercentTrim);
                   // debugger;
                    if (res[0].TearTape) {
                        $('#modelRouting_TearTape').prop('checked', true);
                        $('#TeartapeBox').show();
                        $('#sample-tearTape').show();
                        $('#MachineTypeDieCutProperty').css('display', 'block');
                    } else {
                        $('#modelRouting_TearTape').prop('checked', false);
                        $('#TeartapeBox').show();
                        $('#sample-tearTape').hide();
                        $('#MachineTypeDieCutProperty').css('display', 'none');
                    }
                    if (res[0].LineQtyPerBox === 0) { $('#modelRouting_LineQtyPerBox').val(""); } else { $('#modelRouting_LineQtyPerBox').val(res[0].LineQtyPerBox); }
                    $('#modelRouting_MarginForPaper').val(res[0].MarginForPaper);

                    // Printing properties
                    $('#modelRouting_Ink1').val(res[0].Ink1);
                    $('#modelRouting_Ink2').val(res[0].Ink2);
                    $('#modelRouting_Ink3').val(res[0].Ink3);
                    $('#modelRouting_Ink4').val(res[0].Ink4);
                    $('#modelRouting_Ink5').val(res[0].Ink5);
                    $('#modelRouting_Ink6').val(res[0].Ink6);
                    $('#modelRouting_Ink7').val(res[0].Ink7);
                    $('#modelRouting_Ink8').val(res[0].Ink8);

                    BindingShadeByColor(res[0].Ink1, "1");
                    BindingShadeByColor(res[0].Ink2, "2");
                    BindingShadeByColor(res[0].Ink3, "3");
                    BindingShadeByColor(res[0].Ink4, "4");
                    BindingShadeByColor(res[0].Ink5, "5");
                    BindingShadeByColor(res[0].Ink6, "6");
                    BindingShadeByColor(res[0].Ink7, "7");
                    BindingShadeByColor(res[0].Ink8, "8");

                    //  debugger;
                    if ($('#modelRouting_Ink1').val() !== "") { $('#modelRouting_Area1').prop("disabled", false); } else { $('#modelRouting_Area1').prop("disabled", true); }
                    if ($('#modelRouting_Ink2').val() !== "") { $('#modelRouting_Area2').prop("disabled", false); } else { $('#modelRouting_Area2').prop("disabled", true); }
                    if ($('#modelRouting_Ink3').val() !== "") { $('#modelRouting_Area3').prop("disabled", false); } else { $('#modelRouting_Area3').prop("disabled", true); }
                    if ($('#modelRouting_Ink4').val() !== "") { $('#modelRouting_Area4').prop("disabled", false); } else { $('#modelRouting_Area4').prop("disabled", true); }
                    if ($('#modelRouting_Ink5').val() !== "") { $('#modelRouting_Area5').prop("disabled", false); } else { $('#modelRouting_Area5').prop("disabled", true); }
                    if ($('#modelRouting_Ink6').val() !== "") { $('#modelRouting_Area6').prop("disabled", false); } else { $('#modelRouting_Area6').prop("disabled", true); }
                    if ($('#modelRouting_Ink7').val() !== "") { $('#modelRouting_Area7').prop("disabled", false); } else { $('#modelRouting_Area7').prop("disabled", true); }
                    if ($('#modelRouting_Ink8').val() !== "") { $('#modelRouting_Area8').prop("disabled", false); } else { $('#modelRouting_Area8').prop("disabled", true); }

                    $('#modelRouting_PrintingPlateNo').val(res[0].PrintingPlateNo);
                    $('#modelRouting_CuttingDieNo').val(res[0].CuttingDieNo);
                 //   $('#modelRouting_MylaNo').val(res[0].MylaNo);

                    debugger;
                    var radioPalate =  res[0].PrintingPlateType;
                    $("INPUT[name='modelRouting.PrintingPlateType']").val([radioPalate]);

                    $('#modelRouting_Remark').val(res[0].Remark);
                    countCharacters();
                    $('#lblRemarkAttachFileName').text(res[0].RemarkImageFileName);
                    $('#modelRouting_RemarkAttachFileStatus').val(res[0].RemarkAttachFileStatus);

                    /// binding update field

                    $('#modelRouting_ScoreType').val(res[0].ScoreType);
                    $('#modelRouting_ScoreGap').val(res[0].ScoreGap);
                    //$('#modelRouting_ScoreGap').empty();
                    //$('#modelRouting_ScoreGap').append("<option>--- Choose here ---</option>");
                    //if (res[0].ScoreGap != "") {
                    //    $('#modelRouting_ScoreGap').empty();
                    //   // $('#modelRouting_ScoreGap').append("<option>--- Choose here ---</option>");
                    //    $('#modelRouting_ScoreGap').append($("<option></option>").attr("value", res[0].ScoreGap).text(res[0].ScoreGap));
                    //}

                    $('#modelRouting_Speed').val(res[0].Speed);
                    $('#modelRouting_SetupTm').val(res[0].SetupTm);
                    $('#modelRouting_PrepareTm').val(res[0].PrepareTm);
                    $('#modelRouting_PostTm').val(res[0].PostTm);
                    $('#modelRouting_SetupWaste').val(res[0].SetupWaste);
                    $('#modelRouting_RunWaste').val(res[0].RunWaste);
                    $('#modelRouting_Totalcolor').val(res[0].Totalcolor);

                    $('#modelRouting_StackHeight').val(res[0].StackHeight);

                    if ($("#modelRouting_MachineGroupSelect").val() === "1") { $("#labelRunSpeed").text("sheet/hr."); }
                    else { $("#labelRunSpeed").text("meter/hr."); }

                    if ($('#lblRemarkAttachFileName').text() !== "") {
                        $('#btnRemoveAttachFile').show();
                    }
                    else {
                        $('#lblRemarkAttachFileName').text("No File Choose");
                        $('#btnRemoveAttachFile').hide();
                    }

                    $.ajax({
                        url: '@Url.Action("GetMachineGroup", "NewProduct")',
                        type: "POST",
                        async: false,
                        dataType: "json",
                        data: { machine: res[0].Machine },
                        success: function (res) {
                            $('#modelRouting_MachineGroupSelect').val(res.MachineGroup);
                        },
                        error: function () { }
                    });

                    $.ajax({
                        url: '@Url.Action("GetDataToCondition", "NewProduct")',
                        type: "POST",
                        async: false,
                        dataType: "json",
                        data: { machine: res[0].Machine },
                        success: function (res2) {
                            if (res2.isPropCor === 1) {
                                $('#MachineTypeCor').css('display', 'block');
                            } else
                            {
                                $('#MachineTypeCor').css('display', 'none');
                            }
                            if (res2.isPropPrint === 1) {

                                $('#MachineTypePrinting').css('display', 'block');
                                if (res[0].Shade1 !== null) {

                                    $('#modelRouting_Shade1').val(res[0].Shade1);
                                }
                                else
                                {
                                    $('#modelRouting_Shade1').empty();
                                    $('#modelRouting_Shade1').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade2 !== null) {

                                    $('#modelRouting_Shade2').val(res[0].Shade2);
                                }
                                else {
                                    $('#modelRouting_Shade2').empty();
                                    $('#modelRouting_Shade2').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade3 !== null) {
                                    $('#modelRouting_Shade3').val(res[0].Shade3);
                                }
                                else {
                                    $('#modelRouting_Shade3').empty();
                                    $('#modelRouting_Shade3').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade4 !== null) {
                                    $('#modelRouting_Shade4').val(res[0].Shade4);
                                }
                                else {
                                    $('#modelRouting_Shade4').empty();
                                    $('#modelRouting_Shade4').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade5 !== null) {
                                    $('#modelRouting_Shade5').val(res[0].Shade5);
                                }
                                else {
                                    $('#modelRouting_Shade5').empty();
                                    $('#modelRouting_Shade5').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade6 !== null) {
                                    $('#modelRouting_Shade6').val(res[0].Shade6);
                                }
                                else {
                                    $('#modelRouting_Shade6').empty();
                                    $('#modelRouting_Shade6').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade7 !== null) {
                                    $('#modelRouting_Shade7').val(res[0].Shade7);
                                }
                                else {
                                    $('#modelRouting_Shade7').empty();
                                    $('#modelRouting_Shade7').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade8 !== null) {
                                    $('#modelRouting_Shade8').val(res[0].Shade8);
                                }
                                else {
                                    $('#modelRouting_Shade8').empty();
                                    $('#modelRouting_Shade8').append("<option value=''>--- Choose here ---</option>");
                                }

                                $('#modelRouting_Area1').val(res[0].Area1);
                                $('#modelRouting_Area2').val(res[0].Area2);
                                $('#modelRouting_Area3').val(res[0].Area3);
                                $('#modelRouting_Area4').val(res[0].Area4);
                                $('#modelRouting_Area5').val(res[0].Area5);
                                $('#modelRouting_Area6').val(res[0].Area6);
                                $('#modelRouting_Area7').val(res[0].Area7);
                                $('#modelRouting_Area8').val(res[0].Area8);
                                printerSelect = true;
                            } else {
                                $('#MachineTypePrinting').css('display', 'none');
                            }
                            if (res2.isPropDieCut === 1) {
                                $('#MachineTypeDieCutProperty').css('display', 'block');
                            } else
                            {
                                $('#MachineTypeDieCutProperty').css('display', 'none');
                            }
                            if (CheckActiveAltenativeCollapse()) {
                                $("#Alternative-Collapse").collapse('show');
                            } else { $("#Alternative-Collapse").collapse('hide'); }

                            if (CheckActiveSpecialPropertyCollapse()) {
                                $("#SpecialProp-Collapse").collapse('show');
                            } else { $("#SpecialProp-Collapse").collapse('hide');}

                            if (CheckActiveMoreColor()) {
                                $("#Color-Collapse").collapse('show');
                            }
                            else { $("#Color-Collapse").collapse('hide'); }

                            if (res2.isPropDieCut === 1) {
                                $('#mylaisnodiecut').hide();
                                $('#modelRouting_MylaNo').val(res[0].MylaNo);
                            } else {
                                $('#mylaisnodiecut').show();
                                $('#modelRouting_MylaNo_Copy').val(res[0].MylaNo);
                            }

                            if (res2.IsRepeatLength === 1) {
                                $('#repeatLength').show();
                                $('#modelRouting_RepeatLength').val(res[0].RepeatLength);
                            } else { $('#repeatLength').hide(); }

                            if ($("#modelRouting_MachineGroupSelect").val() === "5") { $('#CustBarcodeNo').show(); $('#modelRouting_CustBarcodeNo').val(res[0].CustBarcodeNo); }
                            else { $('#CustBarcodeNo').hide(); }
                        },
                        error: function () { }
                    });
                },
                error: function () { }
            });

            $('#btnAddMachine').css('display', 'none');
            $('#btnInsertMachine').css('display', 'none');
            $('#btnUpdateMachine').css('display', 'none');
            setReadOnly("1");
        }

        function RoutingEdit(value) {
            $('#checkStatusBtnEdit').val("")
            setReadOnly("0");
            $('#btnAddMachine').css('display', 'none');
            $('#btnUpdateMachine').css('display', 'block');
            seqNoSelect = value;
            $('#modelRouting_SeqNo').val(seqNoSelect);

            $.ajax({
                type: 'POST',
                async: false,
                url: '@Url.Action("GetRoutingData", "Report")',
                    data: { seqNo: seqNoSelect,OrderItem:'@Model.OrderSelect' },
                success: function (res) {

                    $('#modelRouting_SeqNo').val(res[0].SeqNo);
                    $('#modelRouting_MachineGroupSelect').val(res[0].MachineGroupSelect);
                    $('#modelRouting_Machine').val(res[0].Machine); if (res[0].CopyStatus) $('#modelRouting_Machine').prop('disabled', true); else $('#modelRouting_Machine').prop('disabled', false);
                    if (res[0].MachineMove) {
                        $('#modelRouting_MachineMove').prop('checked', true);
                        $('#modelRouting_Alternative1').prop('disabled', false);
                        $('#modelRouting_Alternative2').prop('disabled', false);
                        $('#btncolspan').prop('disabled', false);
                    } else
                    {
                        $('#modelRouting_MachineMove').prop('checked', false);
                        $('#modelRouting_Alternative1').prop('disabled', true);
                        $('#modelRouting_Alternative2').prop('disabled', true);
                        $('#btncolspan').prop('disabled', true);
                        ClearAlternative();
                    }

                    $("#modelRouting_MylaSize").val(res[0].MylaSize);
                    var radioRotate = res[0].Rotate;
                    $("INPUT[name='modelRouting.Rotate']").val([radioRotate]);
                    BindPrintArray(res[0].PlateNo2, res[0].PlateNoPlant2, res[0].PlateNo3, res[0].PlateNoPlant3, res[0].PlateNo4, res[0].PlateNoPlant4, res[0].PlateNo5, res[0].PlateNoPlant5);
                    BindDieCutArray(res[0].BlockNo2, res[0].BlockNoPlant2, res[0].MylaNo2, res[0].MylaNoPlant2, res[0].BlockNo3, res[0].BlockNoPlant3, res[0].MylaNo3, res[0].MylaNoPlant3, res[0].BlockNo4, res[0].BlockNoPlant4, res[0].MylaNo4, res[0].MylaNoPlant4, res[0].BlockNo5, res[0].BlockNoPlant5, res[0].MylaNo5, res[0].MylaNoPlant5);
                    $('#modelRouting_Alternative1').val(res[0].Alternative1);
                    $('#modelRouting_Alternative2').val(res[0].Alternative2);
                    $('#modelRouting_Alternative3').val(res[0].Alternative3);
                    $('#modelRouting_Alternative4').val(res[0].Alternative4);
                    $('#modelRouting_Alternative5').val(res[0].Alternative5);
                    $('#modelRouting_Alternative6').val(res[0].Alternative6);
                    $('#modelRouting_Alternative7').val(res[0].Alternative7);
                    $('#modelRouting_Alternative8').val(res[0].Alternative8);

                    // In/Out properties
                    $('#modelRouting_NoOpenIn').val(res[0].NoOpenIn);
                    $('#modelRouting_NoOpenOut').val(res[0].NoOpenOut);
                    $('#modelRouting_WeightIn').val(res[0].WeightIn);
                    $('#modelRouting_WeightOut').val(res[0].WeightOut);
                    $('#modelRouting_SheetLengthIn').val(res[0].SheetLengthIn);
                    $('#modelRouting_SheetLengthOut').val(res[0].SheetLengthOut);
                    $('#modelRouting_SheetWidthIn').val(res[0].SheetWidthIn);
                    $('#modelRouting_SheetWidthOut').val(res[0].SheetWidthOut);
                    $('#modelRouting_Coat').val(res[0].Coat);

                    // Join to/ Sperate to
                    $('#modelRouting_JoinToMaterialNo').val(res[0].JoinToMaterialNo);
                    $('#modelRouting_SperateToMaterialNo').val(res[0].SperateToMaterialNo);

                    // Corrugator properties
                    $('#modelRouting_PaperRollWidth').val(res[0].PaperRollWidth);
                    $('#modelRouting_Cut').val(res[0].Cut);
                    $('#modelRouting_Trim').val(res[0].Trim);
                    $('#modelRouting_PercentTrim').val(res[0].PercentTrim);
                    if (res[0].TearTape) {
                        $('#modelRouting_TearTape').prop('checked', true);
                        $('#TeartapeBox').show();
                        $('#sample-tearTape').show();
                        $('#MachineTypeDieCutProperty').css('display', 'block');
                    } else {
                        $('#modelRouting_TearTape').prop('checked', false);
                        $('#TeartapeBox').show();
                        $('#sample-tearTape').hide();
                        $('#MachineTypeDieCutProperty').css('display', 'none');
                    }
                    if (res[0].LineQtyPerBox === 0) { $('#modelRouting_LineQtyPerBox').val(""); } else { $('#modelRouting_LineQtyPerBox').val(res[0].LineQtyPerBox); }
                    $('#modelRouting_MarginForPaper').val(res[0].MarginForPaper);

                    // Printing properties
                    $('#modelRouting_Ink1').val(res[0].Ink1);
                    $('#modelRouting_Ink2').val(res[0].Ink2);
                    $('#modelRouting_Ink3').val(res[0].Ink3);
                    $('#modelRouting_Ink4').val(res[0].Ink4);
                    $('#modelRouting_Ink5').val(res[0].Ink5);
                    $('#modelRouting_Ink6').val(res[0].Ink6);
                    $('#modelRouting_Ink7').val(res[0].Ink7);
                    $('#modelRouting_Ink8').val(res[0].Ink8);

                    BindingShadeByColor(res[0].Ink1, "1");
                    BindingShadeByColor(res[0].Ink2, "2");
                    BindingShadeByColor(res[0].Ink3, "3");
                    BindingShadeByColor(res[0].Ink4, "4");
                    BindingShadeByColor(res[0].Ink5, "5");
                    BindingShadeByColor(res[0].Ink6, "6");
                    BindingShadeByColor(res[0].Ink7, "7");
                    BindingShadeByColor(res[0].Ink8, "8");

                    if ($('#modelRouting_Ink1').val() !== "") { $('#modelRouting_Area1').prop("disabled", false); } else { $('#modelRouting_Area1').prop("disabled", true); }
                    if ($('#modelRouting_Ink2').val() !== "") { $('#modelRouting_Area2').prop("disabled", false); } else { $('#modelRouting_Area2').prop("disabled", true); }
                    if ($('#modelRouting_Ink3').val() !== "") { $('#modelRouting_Area3').prop("disabled", false); } else { $('#modelRouting_Area3').prop("disabled", true); }
                    if ($('#modelRouting_Ink4').val() !== "") { $('#modelRouting_Area4').prop("disabled", false); } else { $('#modelRouting_Area4').prop("disabled", true); }
                    if ($('#modelRouting_Ink5').val() !== "") { $('#modelRouting_Area5').prop("disabled", false); } else { $('#modelRouting_Area5').prop("disabled", true); }
                    if ($('#modelRouting_Ink6').val() !== "") { $('#modelRouting_Area6').prop("disabled", false); } else { $('#modelRouting_Area6').prop("disabled", true); }
                    if ($('#modelRouting_Ink7').val() !== "") { $('#modelRouting_Area7').prop("disabled", false); } else { $('#modelRouting_Area7').prop("disabled", true); }
                    if ($('#modelRouting_Ink8').val() !== "") { $('#modelRouting_Area8').prop("disabled", false); } else { $('#modelRouting_Area8').prop("disabled", true); }

                    $('#modelRouting_PrintingPlateNo').val(res[0].PrintingPlateNo);
                    $('#modelRouting_CuttingDieNo').val(res[0].CuttingDieNo);

                    debugger;
                    var radioPalate =  res[0].PrintingPlateType;
                    $("INPUT[name='modelRouting.PrintingPlateType']").val([radioPalate]);

                    $('#modelRouting_Remark').val(res[0].Remark);
                    $('#lblRemarkAttachFileName').text(res[0].RemarkImageFileName);
                    $('#modelRouting_RemarkAttachFileStatus').val(res[0].RemarkAttachFileStatus);

                    /// binding update fields

                    $('#modelRouting_ScoreType').val(res[0].ScoreType);
                    $('#modelRouting_ScoreGap').val(res[0].ScoreGap);
                    //$('#modelRouting_ScoreGap').empty();
                    //$('#modelRouting_ScoreGap').append("<option>--- Choose here ---</option>");
                    //if (res[0].ScoreGap != "") {
                    //    $('#modelRouting_ScoreGap').empty();
                    //   // $('#modelRouting_ScoreGap').append("<option>--- Choose here ---</option>");
                    //    $('#modelRouting_ScoreGap').append($("<option></option>").attr("value", res[0].ScoreGap).text(res[0].ScoreGap));
                    //}

                    $('#modelRouting_Speed').val(res[0].Speed);
                    $('#modelRouting_SetupTm').val(res[0].SetupTm);
                    $('#modelRouting_PrepareTm').val(res[0].PrepareTm);
                    $('#modelRouting_PostTm').val(res[0].PostTm);
                    $('#modelRouting_SetupWaste').val(res[0].SetupWaste);
                    $('#modelRouting_RunWaste').val(res[0].RunWaste);
                    $('#modelRouting_Totalcolor').val(res[0].Totalcolor);
                    $('#modelRouting_StackHeight').val(res[0].StackHeight);

                    if ($("#modelRouting_MachineGroupSelect").val() === "1") { $("#labelRunSpeed").text("sheet/hr."); }
                    else { $("#labelRunSpeed").text("meter/hr."); }

                    if ($('#lblRemarkAttachFileName').text() !== "")
                    {
                        $('#btnRemoveAttachFile').show();
                    }
                    else
                    {
                        $('#lblRemarkAttachFileName').text("No File Choose");
                        $('#btnRemoveAttachFile').hide();
                    }

                    $.ajax({
                        url: '@Url.Action("GetMachineGroup", "NewProduct")',
                        type: "POST",
                        async: false,
                        dataType: "json",
                        data: { machine: res[0].Machine },
                        success: function (res) {
                            $('#modelRouting_MachineGroupSelect').val(res.MachineGroup);
                        },
                        error: function () { }
                    });

                    $.ajax({
                        url: '@Url.Action("GetDataToCondition", "NewProduct")',
                        type: "POST",
                        async: false,
                        dataType: "json",
                        data: { machine: res[0].Machine },
                        success: function (res2) {
                            if (res2.isPropCor === 1)
                            {
                                $('#MachineTypeCor').css('display', 'block');
                            } else
                            {
                                $('#MachineTypeCor').css('display', 'none');
                            }
                            if (res2.isPropPrint === 1)
                            {
                                $('#MachineTypePrinting').css('display', 'block');
                                if (res[0].Shade1 !== null) {

                                    $('#modelRouting_Shade1').val(res[0].Shade1);
                                }
                                else
                                {
                                    $('#modelRouting_Shade1').empty();
                                    $('#modelRouting_Shade1').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade2 !== null) {

                                    $('#modelRouting_Shade2').val(res[0].Shade2);
                                }
                                else {
                                    $('#modelRouting_Shade2').empty();
                                    $('#modelRouting_Shade2').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade3 !== null) {
                                    $('#modelRouting_Shade3').val(res[0].Shade3);
                                }
                                else {
                                    $('#modelRouting_Shade3').empty();
                                    $('#modelRouting_Shade3').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade4 !== null) {
                                    $('#modelRouting_Shade4').val(res[0].Shade4);
                                }
                                else {
                                    $('#modelRouting_Shade4').empty();
                                    $('#modelRouting_Shade4').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade5 !== null) {
                                    $('#modelRouting_Shade5').val(res[0].Shade5);
                                }
                                else {
                                    $('#modelRouting_Shade5').empty();
                                    $('#modelRouting_Shade5').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade6 !== null) {
                                    $('#modelRouting_Shade6').val(res[0].Shade6);
                                }
                                else {
                                    $('#modelRouting_Shade6').empty();
                                    $('#modelRouting_Shade6').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade7 !== null) {
                                    $('#modelRouting_Shade7').val(res[0].Shade7);
                                }
                                else {
                                    $('#modelRouting_Shade7').empty();
                                    $('#modelRouting_Shade7').append("<option value=''>--- Choose here ---</option>");
                                }
                                if (res[0].Shade8 !== null) {
                                    $('#modelRouting_Shade8').val(res[0].Shade8);
                                }
                                else {
                                    $('#modelRouting_Shade8').empty();
                                    $('#modelRouting_Shade8').append("<option value=''>--- Choose here ---</option>");
                                }

                                $('#modelRouting_Area1').val(res[0].Area1);
                                $('#modelRouting_Area2').val(res[0].Area2);
                                $('#modelRouting_Area3').val(res[0].Area3);
                                $('#modelRouting_Area4').val(res[0].Area4);
                                $('#modelRouting_Area5').val(res[0].Area5);
                                $('#modelRouting_Area6').val(res[0].Area6);
                                $('#modelRouting_Area7').val(res[0].Area7);
                                $('#modelRouting_Area8').val(res[0].Area8);
                                printerSelect = true;
                            } else
                            {
                                $('#MachineTypePrinting').css('display', 'none');
                            }

                            if (res2.isPropDieCut === 1)
                            {
                                $('#MachineTypeDieCutProperty').css('display', 'block');
                            }
                            else
                            {
                                $('#MachineTypeDieCutProperty').css('display', 'none');
                            }

                            if (CheckActiveAltenativeCollapse())
                            {
                                $("#Alternative-Collapse").collapse('show');
                            }
                            else
                            {
                                $("#Alternative-Collapse").collapse('hide');
                            }

                            if (CheckActiveSpecialPropertyCollapse())
                            {
                                $("#SpecialProp-Collapse").collapse('show');
                            }
                            else
                            {
                                $("#SpecialProp-Collapse").collapse('hide');
                            }

                            if (CheckActiveMoreColor())
                            {
                                $("#Color-Collapse").collapse('show');
                            }
                            else
                            {
                                $("#Color-Collapse").collapse('hide');
                            }

                            if (res2.isPropDieCut === 1)
                            {
                                $('#mylaisnodiecut').hide();
                                $('#modelRouting_MylaNo').val(res[0].MylaNo);
                            }
                            else
                            {
                                $('#mylaisnodiecut').show();
                                $('#modelRouting_MylaNo_Copy').val(res[0].MylaNo);
                            }

                            if (res2.IsRepeatLength === 1)
                            {
                                $('#repeatLength').show();
                                $('#modelRouting_RepeatLength').val(res[0].RepeatLength);
                            }
                            else
                            {
                                $('#repeatLength').hide();
                            }

                            if ($("#modelRouting_MachineGroupSelect").val() === "5")
                            {
                                $('#CustBarcodeNo').show();
                                $('#modelRouting_CustBarcodeNo').val(res[0].CustBarcodeNo);
                            }
                            else
                            {
                                $('#CustBarcodeNo').hide();
                            }

                                     console.log(res)
                                    debugger;
                            //  PlatTypeRadioCheck(@Model.amountColor);
                          //  consol.log(res[0].NoneBlk.toString())

                            if (res[0].NoneBlk === "True") {
                                //$("#Non-Print").prop("checked", true);
                                //$("#Standard").prop("checked", false);
                                $("#Standard").attr("disabled", true);
                                $("#Semi").attr("disabled", true);
                                $("#Shipping-Mark").attr("disabled", true);
                                $("#Non-Print").attr("disabled", false);
                            }
                            else {
                                //$("#Non-Print").prop("checked", false);
                                //$("#Standard").prop("checked", true);
                                $("#Non-Print").attr("disabled", true);
                                $("#Standard").attr("disabled", false);
                                $("#Semi").attr("disabled", false);
                                $("#Shipping-Mark").attr("disabled", false);
                            }

                            if (res[0].NoneBlk === "True")
                            {
                                $("#Non-Print").prop("checked", true);
                                $("#Standard").prop("checked", false);
                                $("#Semi").prop("checked", false);
                                $("#Shipping-Mark").prop("checked", false);
                            }
                            if (res[0].StanBlk === "True") {
                                $("#Non-Print").prop("checked", false);
                                $("#Standard").prop("checked", true);
                                $("#Semi").prop("checked", false);
                                $("#Shipping-Mark").prop("checked", false);
                            }
                            if (res[0].SemiBlk === "True") {
                                $("#Non-Print").prop("checked", false);
                                $("#Standard").prop("checked", false);
                                $("#Semi").prop("checked", true);
                                $("#Shipping-Mark").prop("checked", false);
                            }
                            if (res[0].ShipBlk === "True") {
                                $("#Non-Print").prop("checked", false);
                                $("#Standard").prop("checked", false);
                                $("#Semi").prop("checked", false);
                                $("#Shipping-Mark").prop("checked", true);
                            }

                        },
                        error: function () { }
                    });

                },
                error: function () { }
            });

            $("#modelRouting_MachineGroupSelect").attr("disabled", true);

            //  $('#modelRouting_MachineGroupSelect option:not(:selected)').prop('disabled', true);

            $('#btnAddMachine').css('display', 'none');
            $('#btnInsertMachine').css('display', 'none');
            $('#btnUpdateMachine').css('display', 'block');
        }

        function BindingShadeByColor(colorselect, targetSelectionIDNumber) {
            if (colorselect !== null)
            {
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("GetShadeByInk", "NewProduct")',
                    data: { inkName: colorselect },
                    async:false,
                    success: function (res) {
                        var hasValue = false;
                        $.each(res, function (index) {
                            hasValue = true;
                        });

                        if (hasValue)
                        {
                            $('#modelRouting_Shade' + targetSelectionIDNumber).empty();
                            $('#modelRouting_Shade' + targetSelectionIDNumber).append("<option>--- Choose here ---</option>");
                            $.each(res, function (index) {
                                $('#modelRouting_Shade' + targetSelectionIDNumber).append($("<option></option>").attr("value", res[index].Shade).text(res[index].Shade));
                            });
                        }
                    },
                    error: function () { }
                });

            }
         }

        //***************************************************End Bind Data **************************************

         //*************************************************** Clear Data **************************************
        function ClearAlternative() {
            $('#modelRouting_Alternative1').val('');
            $('#modelRouting_Alternative2').val('');
            $('#modelRouting_Alternative3').val('');
            $('#modelRouting_Alternative4').val('');
            $('#modelRouting_Alternative5').val('');
            $('#modelRouting_Alternative6').val('');
            $('#modelRouting_Alternative7').val('');
            $('#modelRouting_Alternative8').val('');
        }

        function ClearArear() {
            $('#modelRouting_Area1').prop("disabled", true);
            $('#modelRouting_Area2').prop("disabled", true);
            $('#modelRouting_Area3').prop("disabled", true);
            $('#modelRouting_Area4').prop("disabled", true);
            $('#modelRouting_Area5').prop("disabled", true);
            $('#modelRouting_Area6').prop("disabled", true);
            $('#modelRouting_Area7').prop("disabled", true);
            $('#modelRouting_Area8').prop("disabled", true);
        }

        // Clear All Field
        function ClearField() {
            $('#checkStatusBtnEdit').val("")
            $("#RoutingForm")[0].reset();
            $('#repeatLength').hide();
            $('#CustBarcodeNo').hide();

            $('#modelRouting_MachineMove').prop('checked', true);
            $('#btncolspan').prop('disabled', false);

            $("input[id='modelRouting_PrintingPlateType'][value='Non-Print']").prop('checked', true);
            $('#lblRemarkAttachFileName').text("No File Choose");
            $('#MachineTypeCor').css('display', 'none');
            $('#MachineTypePrinting').css('display', 'none');
            $('#MachineTypeDieCutProperty').css('display', 'none');

           // CheckEnableButtonSave();
            ClearArear();

            $("#Alternative-Collapse").collapse('hide');
            $("#SpecialProp-Collapse").collapse('hide');
            $("#Color-Collapse").collapse('hide');

            $("#modelRouting_PrintingPlateNo-error").hide();
            $('#modelRouting_Machine-error').hide()
            $('#modelRouting_NoOpenOut-error').hide()

            $("#modelRouting_MachineGroupSelect").attr("disabled", false);

            $('#modelRouting_ScoreType').val("");
            //$('#modelRouting_ScoreType').append("<option>--- Choose here ---</option>");
            //$('#modelRouting_ScoreGap').empty();
            //$('#modelRouting_ScoreGap').append("<option>--- Choose here ---</option>");
            $('#modelRouting_ScoreGap').val("");

            window.scroll({
                top: 0,
                left: 0,
                behavior: 'smooth'
            });
        }
         //*************************************************** End Clear Data **************************************

        //*************************************************** AutoComplete Machine **************************************
         // On MachineGroup Change
        $('#modelRouting_MachineGroupSelect').change(function () {
            $("#modelRouting_Machine, #modelRouting_Alternative1, #modelRouting_Alternative2, #modelRouting_Alternative3, #modelRouting_Alternative4, #modelRouting_Alternative5, #modelRouting_Alternative6, #modelRouting_Alternative7, #modelRouting_Alternative8").val('');

            if ($('#modelRouting_MachineGroupSelect').val() === "") {
                $('#MachineTypeCor').hide();
                $('#MachineTypePrinting').hide();
            }

            if (@Model.amountColor > 0) {
                $("#Non-Print").attr('disabled', true);
            } else {
                $("#Non-Print").attr('disabled', false);
            }

            SetRemarkWhenUnUpdate();
        });

        // AutoComplete for Machine
        $('#modelRouting_Machine').autocomplete({
            minLength: 0,
            maxShowItems: 5,
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("GetMachine", "NewProduct")',
                    type: "POST",
                    dataType: "json",
                    data: { keywordMachine: request.term, machineGroup: $('#modelRouting_MachineGroupSelect').val() },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.Machine1, value: item.Machine1 };
                        }));
                    }
                });
            },
            select: function (event, ui) {
                var label = ui.item.label;
                var value = ui.item.value;

                $.ajax({
                    url: '@Url.Action("GetMachineGroup", "NewProduct")',
                    type: "POST",
                    dataType: "json",
                    data: { machine: value },
                        success: function (res) {
                            $('#modelRouting_MachineGroupSelect').val(res.MachineGroup);
                            SetRemarkWhenUnUpdate()
                    },
                    error: function () {  }
                });

                $.ajax({
                    url: '@Url.Action("GetDataToCondition", "NewProduct")',
                    type: "POST",
                    dataType: "json",
                    data: { machine: value },
                    success: function (res) {

                        if ($('#checkStatusBtnEdit').val() === "") {

                            $('#MachineTypeCor').hide();
                            $('#MachineTypePrinting').hide();

                            $('#MachineTypeDieCutProperty').hide();

                            if (res.isPropPrint === 1) {
                            } else {
                                ClearColor();
                            }

                            if (res.isPropCor === 1) {
                                $('#MachineTypeCor').show();
                                $("#TeartapeBox").hide();
                                $("#sample-tearTape").hide();
                            }

                            if (res.isPropPrint === 1) {
                                $('#MachineTypePrinting').show();
                                CheckRemarkFlex();
                                printerSelect = true;
                            }

                            if (res.isPropDieCut === 1) {
                                $('#MachineTypeDieCutProperty').show();
                            }

                            if (res.isCalPaperwidth === 1) {
                                if ('@Model.MatCode' === "14" || '@Model.MatCode' === "24" || '@Model.MatCode' === "84") {

                                } else {
                                    ReCalculate();
                                }

                            }

                            if ($('#checkStatusBtnEdit').val() === "") {
                                SetSlitByFormGroup();
                                setInOutPropertiesAutoComplete();
                            }

                            if (res.IsRepeatLength === 1) {
                                $('#repeatLength').show();
                            } else {
                                $('#repeatLength').hide();
                            }

                            if (res.isPropDieCut === 1) {
                                $('#mylaisnodiecut').hide();
                            }
                            else {
                                $('#mylaisnodiecut').show();
                            }

                            if ($("#modelRouting_MachineGroupSelect").val() === "1") {
                                $("#labelRunSpeed").text("meter/hr.");
                            }
                            else {
                                $("#labelRunSpeed").text("sheet/hr.");
                            }

                            if ($("#modelRouting_MachineGroupSelect").val() === "5") {
                                $('#CustBarcodeNo').show();
                            }
                            else {
                                $('#CustBarcodeNo').hide();
                            }

                            //ข้ามไปก่อน
                        @*if ('@Model.FormGroup' === "HB")
                        {
                             $.ajax({
                                            url: '@Url.Action("CheckHoneyCore", "NewProduct")',
                                             dataType: "json",
                                             async: false,
                                            success: function (datas) {
                                                if (datas.CheckData === "1")
                                                {
                                                    $('#modelRouting_Remark').val("Honey coreSize " + datas.value);
                                                }
                                            }
                            });
                        }*@

                            if (res.isPropPrint === 1) {
                                PlatTypeRadioCheck(@Model.amountColor);
                            } else {
                                $("#Non-Print").prop("checked", false);
                                $("#Standard").prop("checked", false);
                                $("#Semi").prop("checked", false);
                                $("#Shipping-Mark").prop("checked", false);
                            }
                        }

                    },
                    error: function () {  }
                });

            },
            change: function (event, ui) {
                if (ui.item === null) {
                    $(this).val('');
                }
            },
            messages: {
                noResults: "", results: ""
            }
        }).on('focus', function (event) {
            var self = this;
            $(self).autocomplete("search", this.value);
         });

        function SetRemarkWhenUnUpdate() {
            // ถ้า UnUpgrad_Board (MasterData) = true ให้โชว์ remark "ห้ามอัพเกรดแกรม" ใน Machine GroupCode 0 และ 1 **************************

            if ('@Model.UnUpgradBoard' === "True") {
                if ($('#modelRouting_MachineGroupSelect').val() === "0") {
                    $('#modelRouting_Remark').val("ห้ามอัพเกรดแกรม");
                }
                else if ($('#modelRouting_MachineGroupSelect').val() === "1") {
                    $('#modelRouting_Remark').val("ห้ามอัพเกรดแกรม");
                }
                else {
                   // $('#modelRouting_Remark').val("");
                }
            } else
            {
                // $('#modelRouting_Remark').val("");
            }
        }

        function ClearColor() {
            $("#modelRouting_Ink1, #modelRouting_Ink2, #modelRouting_Ink3, #modelRouting_Ink4, #modelRouting_Ink5, #modelRouting_Ink6, #modelRouting_Ink7, #modelRouting_Ink8").val("");
            $("#modelRouting_Shade1, #modelRouting_Shade2, #modelRouting_Shade3, #modelRouting_Shade4, #modelRouting_Shade5, #modelRouting_Shade6, #modelRouting_Shade7, #modelRouting_Shade8").empty();
            $("#modelRouting_Shade1, #modelRouting_Shade2, #modelRouting_Shade3, #modelRouting_Shade4, #modelRouting_Shade5, #modelRouting_Shade6, #modelRouting_Shade7, #modelRouting_Shade8").append("<option>--- Choose here ---</option>");
        }

        function CheckRemarkFlex() {

                var GLTail // = '@Model.GLTail';
                if (GLTail === "True") {
                    $.ajax({
                        type: 'POST',
                        async: false,
                        url: '@Url.Action("CheckRemarkForFlex", "Report")',
                        data: {OrderItem:'@Model.OrderSelect'},
                        async: false,
                        success: function (res) {
                            if (res.CheckFlexResult === "1")
                            {
                             //   $('#modelRouting_Remark').val("");
                            }
                            else
                            {
                                $('#modelRouting_Remark').val("ลิ้นกาวมีหาง");
                            }
                        },
                        error: function () { }
                    });
                }
        }

        function ReCalculate() {
                         $.ajax({
                                url: '@Url.Action("GetCalculateCorProp", "Report")',
                                type: "POST",
                                dataType: "json",
                                data: { machine: $("#modelRouting_Machine").val(), OrderItem:'@Model.OrderSelect' },
                                success: function (res) {
                                    if (res.exError === "1")
                                    {
                                            @*$.ajax({
                                            url: '@Url.Action("GetCalculateCorProp", "NewProduct")',
                                            type: "POST",
                                            dataType: "json",
                                            data: { machine: $("#modelRouting_Machine").val()},
                                                success: function (res) {

                                                },
                                                error: function () { }
                                            });*@

                                       // swal("The number of cut or paperwidth is too high.", "", "warning");
                                        $('#modelRouting_PaperRollWidth').val("0");
                                        $('#modelRouting_Cut').val("0");
                                        $('#modelRouting_Trim').val("0");
                                        $('#modelRouting_PercentTrim').val("0");
                                        $('#modelRouting_LineQtyPerBox').val("");
                                        $('#modelRouting_MarginForPaper').val("")
                                    }
                                    else
                                    {
                                        $('#modelRouting_PaperRollWidth').val(res.PaperRollWidth);
                                        $('#modelRouting_Cut').val(res.Cut);
                                        $('#modelRouting_Trim').val(res.Trim);
                                        $('#modelRouting_PercentTrim').val(parseFloat(res.PercentTrim).toFixed(2));
                                        $('#modelRouting_LineQtyPerBox').val("");
                                        $('#modelRouting_MarginForPaper').val("")
                                    }

                                    if ($('#modelRouting_TearTape').prop('checked'))
                                    {
                                        var remarkText;
                                        remarkText = " Tear Tape";
                                        $('#modelRouting_Remark').val(remarkText);
                                    }
                                    else
                                    {
                                        SetRemarkWhenUnUpdate();
                                    }

                                },
                        error: function () {  }
               });
        }

        function SetSlitByFormGroup()
        {
            // คำนวณหัก Slit ที่ Sheet Length Out กรณี Form Grop เท่ากับ STDRSC
            if ('@Model.FormGroup' === "STDRSC" || '@Model.FormGroup' === "SPCRSC" ) {
                var Slit = '@Model.Slit';
                var Slittmp = 0;
                if (Slit === "")
                {
                    Slittmp = 0
                } else
                {
                    Slittmp = Slit
                }

                if ('@Model.MatCode' === "14" || '@Model.MatCode' === "24" || '@Model.MatCode' === "84") {

                } else
                {
                              $.ajax({
                                            url: '@Url.Action("GetMachineGroupToMangeSheetlength", "Report")',
                                  type: "POST",
                                  data: {OrderItem:'@Model.OrderSelect'},
                                         dataType: "json",
                                         async: false,
                                              success: function (resc) {
                                                  if ($('#modelRouting_MachineGroupSelect').val() === "2" && resc.CheckMachineCount === "0")
                                                    {
                                                        var value_in = $('#modelRouting_SheetLengthIn').val() - Slittmp ;
                                                        $('#modelRouting_SheetLengthOut').val(value_in);
                                                    }
                                                    else
                                                    {
                                                        GetLastNumberList();
                                                    }
                                            },
                                            error: function () {  }
                                        });
                }

                }
                else
                {
                    GetLastNumberList();
                }
        }

        function GetLastNumberList() {
             $.ajax({
                    type: 'POST',
                 url: '@Url.Action("GetLastNumberInRouting", "Report")',
                 data: { OrderItem:'@Model.OrderSelect'},
                 async: false,
                    success: function (res) {
                        if (res.CheckData === "1")
                        {
                            $('#modelRouting_NoOpenIn').val(res.LastNoOut);
                            $('#modelRouting_NoOpenOut').val(res.LastNoOut);
                            $('#modelRouting_WeightIn').val(res.LastWidthOut);
                            $('#modelRouting_WeightOut').val(res.LastWidthOut);
                            $('#modelRouting_SheetLengthIn').val(res.LastSheetLOut);
                            $('#modelRouting_SheetLengthOut').val(res.LastSheetLOut);
                            $('#modelRouting_SheetWidthIn').val(res.LastSheetWOut);
                            $('#modelRouting_SheetWidthOut').val(res.LastSheetWOut);
                        } else
                        {
                            $('#modelRouting_NoOpenIn').val(lastnop);
                            $('#modelRouting_NoOpenOut').val(lastnop);
                            $('#modelRouting_WeightIn').val(lastweigth);
                            $('#modelRouting_WeightOut').val(lastweigth);
                            $('#modelRouting_SheetLengthIn').val(lastsheetlout);
                            $('#modelRouting_SheetLengthOut').val(lastsheetlout);
                            $('#modelRouting_SheetWidthIn').val(lastsheetwout);
                            $('#modelRouting_SheetWidthOut').val(lastsheetwout);
                        }
                    },
                    error: function () { }
                });
        }

        function setInOutPropertiesAutoComplete()
        {
            var openin = $('#modelRouting_NoOpenIn').val();
            var openout = $('#modelRouting_NoOpenOut').val();
                        //คำนวณหา Weight Out
                        if ($('#modelRouting_MachineGroupSelect').val() === "2") {
                            CheckFinishGood();

                        }
                        else if ((openin > openout) && openout === "1") {
                            CheckFinishGood();
                        }
                        else
                        {
                            $.ajax({
                            url: '@Url.Action("GetDataToCondition", "NewProduct")',
                            type: "POST",
                            dataType: "json",
                                data: { machine: $('#modelRouting_Machine').val() },
                                async: false,
                                success: function (res) {
                                    debugger;
                                if (openin === "1" && openout === "1" && res.isPropDieCut === 1) {
                                    if ($('#modelRouting_MachineGroupSelect').val() === "3") {

                                        swal({
                                            title: "Are you sure ?",
                                            text: "พิมพ์อย่างเดียวใช่หรือไม่",
                                            icon: "info",
                                            buttons: {
                                                confirm: "Yes",
                                                cancel: "No",
                                            },
                                          //  buttons: true,
                                            dangerMode: false,
                                        })
                                            .then((alertres) => {
                                                if (alertres) {
                                                    // $('#modelRouting_WeightOut').val(tmpweigth);
                                                    // tmpweigth = null;
                                                }
                                                else
                                                {
                                                    CheckFinishGood();
                                                }
                                            });
                                    }
                                    else
                                    {
                                        CheckFinishGood();
                                    }
                                }
                            },
                            error: function () {  }
                            });
                        }
        }

        function CheckFinishGood()
        {
             $.ajax({
                 url: '@Url.Action("GetWeight", "Report")',
                 data: { OrderItem: '@Model.OrderSelect' },
                dataType: "json",
                success: function (data) {
                    var ck1 = $('#modelRouting_WeightOut').val();
                    if (ck1 === data[1]) {   // data[0] = Weight Sheetbaord, data[1] = Weight FG
                        //
                    } else {
                        $('#modelRouting_WeightOut').val(data[1]);
                    }
                }
            });
        }

      //*************************************************** End AutoComplete Machine **************************************

       //***************************************************  AutoComplete AlterNative **************************************
                    // AutoComplete for Machine
        $('#modelRouting_Alternative1, #modelRouting_Alternative2, #modelRouting_Alternative3, #modelRouting_Alternative4, #modelRouting_Alternative5, #modelRouting_Alternative6, #modelRouting_Alternative7, #modelRouting_Alternative8').autocomplete({
            minLength: 0,
            maxShowItems: 5,
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("GetMachine", "NewProduct")',
                    type: "POST",
                    dataType: "json",
                    data: { keywordMachine: request.term, machineGroup: $('#modelRouting_MachineGroupSelect').val() },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.Machine1, value: item.Machine1 };
                        }));
                    }
                });
            },
            select: function (event, ui) {
                var label = ui.item.label;
                var value = ui.item.value;

                $.ajax({
                    url: '@Url.Action("GetMachineGroup", "NewProduct")',
                    type: "POST",
                    dataType: "json",
                    data: { machine: value },
                        success: function (res) {
                            $('#modelRouting_MachineGroupSelect').val(res.MachineGroup);
                    },
                    error: function () {  }
                });

            },
            change: function (event, ui) {
                if (ui.item === null) {
                    $(this).val('');
                }
            },
            messages: {
                noResults: "", results: ""
            }
        }).on('focus', function (event) {
            var self = this;
            $(self).autocomplete("search", this.value);
        });

       //***************************************************  End AutoComplete AlterNative **************************************

        //***************************************************  AutoComplete Color Shade **************************************
             // On Color Change
        $('#modelRouting_Ink1, #modelRouting_Ink2, #modelRouting_Ink3, #modelRouting_Ink4, #modelRouting_Ink5, #modelRouting_Ink6, #modelRouting_Ink7, #modelRouting_Ink8').change(function () {
        var targetSelectionIDNumber = $(this).attr('id').substr($(this).attr('id').length - 1);
            $.ajax({
                    type: 'POST',
                    url: '@Url.Action("GetShadeByInk", "NewProduct")',
                    data: { inkName: $(this).val() },
                    success: function (res) {
                        var hasValue = false;
                        $.each(res, function (index) {
                                hasValue = true;
                        });

                        if (hasValue)
                        {
                            $('#modelRouting_Shade' + targetSelectionIDNumber).empty();
                            $('#modelRouting_Shade' + targetSelectionIDNumber).append("<option>--- Choose here ---</option>");
                            $.each(res, function (index) {
                                $('#modelRouting_Shade' + targetSelectionIDNumber).append($("<option></option>").attr("value", res[index].Shade).text(res[index].Shade));
                            });
                        }
                    },
                    error: function () { }
            });

        var id = $(this).attr('id');

        if ($(this).val() !== "")
        {
                if (id === "modelRouting_Ink1")
                {
                    $("#modelRouting_Area1").prop("disabled", false);
                    $("#modelRouting_Area1").val("");
                }
                else if (id === "modelRouting_Ink2")
                {
                    $("#modelRouting_Area2").prop("disabled", false);
                    $("#modelRouting_Area2").val("");
                }
                else if (id === "modelRouting_Ink3")
                {
                    $("#modelRouting_Area3").prop("disabled", false);
                    $("#modelRouting_Area3").val("");
                }
                else if (id === "modelRouting_Ink4")
                {
                    $("#modelRouting_Area4").prop("disabled", false);
                    $("#modelRouting_Area4").val("");
                }
                else if (id === "modelRouting_Ink5")
                {
                    $("#modelRouting_Area5").prop("disabled", false);
                    $("#modelRouting_Area5").val("");
                }
                else if (id === "modelRouting_Ink6")
                {
                    $("#modelRouting_Area6").prop("disabled", false);
                    $("#modelRouting_Area6").val("");
                }
                else if (id === "modelRouting_Ink7")
                {
                    $("#modelRouting_Area7").prop("disabled", false);
                    $("#modelRouting_Area7").val("");
                }
                else if (id === "modelRouting_Ink8") {
                    $("#modelRouting_Area8").prop("disabled", false);
                    $("#modelRouting_Area8").val("");
                }
            }
            else {
                if (id === "modelRouting_Ink1")
                {
                    $("#modelRouting_Area1").prop("disabled", true);
                    $("#modelRouting_Area1").val("");

                }
                else if (id === "modelRouting_Ink2")
                {
                    $("#modelRouting_Area2").prop("disabled", true);
                    $("#modelRouting_Area2").val("");
                }
                else if (id === "modelRouting_Ink3")
                {
                    $("#modelRouting_Area3").prop("disabled", true);
                    $("#modelRouting_Area3").val("");
                }
                else if (id === "modelRouting_Ink4")
                {
                    $("#modelRouting_Area4").prop("disabled", true);
                    $("#modelRouting_Area4").val("");
                }
                else if (id === "modelRouting_Ink5")
                {
                    $("#modelRouting_Area5").prop("disabled", true);
                    $("#modelRouting_Area4").val("");
                }
                else if (id === "modelRouting_Ink6")
                {
                    $("#modelRouting_Area6").prop("disabled", true);
                    $("#modelRouting_Area6").val("");
                }
                else if (id === "modelRouting_Ink7")
                {
                    $("#modelRouting_Area7").prop("disabled", true);
                    $("#modelRouting_Area7").val("");
                }
                else if (id === "modelRouting_Ink8") {
                    $("#modelRouting_Area8").prop("disabled", true);
                    $("#modelRouting_Area8").val("");
                }
            }
        });
        //***************************************************  End AutoComplete Color Shade **************************************

        //***************************************************  Manage TextBox **************************************
                // AutoComplete for Weight
        $('#modelRouting_WeightIn, #modelRouting_WeightOut').autocomplete({
            minLength: 0,
            maxShowItems: 5,
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("GetWeight", "Report")',
                    data: { OrderItem: '@Model.OrderSelect' },
                    dataType: "json",
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item, value: item };
                        }));
                    }
                });
            },
            select: function (event, ui) {
                var label = ui.item.label;
                var value = ui.item.value;
            },
            messages: {
                noResults: "", results: ""
            }
        }).on('focus', function (event) {
            var self = this;
            $(self).autocomplete("search", this.value);
        });

         // On Score Change
        $('#modelRouting_ScoreType').change(function () {
            //var tSelectionIDNumber = $(this).attr('id').substr($(this).attr('id').length - 1);
            var flut = '@Model.Flute';
            var ScoreT = $('#modelRouting_ScoreType').val();
                $.ajax({
                        type: 'POST',
                        url: '@Url.Action("GetScoreGab", "NewProduct")',
                        data: { flut: flut, scoretypeid: ScoreT},
                        success: function (res) {
                            if (res.length > 0) {
                                $('#modelRouting_ScoreGap').val(res[0].ScoreGap1);
                            } else
                            {
                                $('#modelRouting_ScoreGap').val(0);
                            }

                        },
                        error: function () { }
            });
        });

        // On Teartape Check
        var tearTapeText = null;
        $('#modelRouting_TearTape').click(function () {
            if ($('#modelRouting_TearTape').prop('checked')) {
                $('#sample-tearTape').show();
                var remarkText;
                tearTapeText = " Tear Tape";
                remarkText = $('#modelRouting_Remark').val() + tearTapeText;
                $('#modelRouting_Remark').val(remarkText);
            }
            else {
                $('#sample-tearTape').hide();
                remarkText = $('#modelRouting_Remark').val().replace(tearTapeText, "");
                $('#modelRouting_Remark').val(remarkText);

                if (lineQtyPerBoxText !== null) remarkText = $('#modelRouting_Remark').val().replace(lineQtyPerBoxText, ""); $('#modelRouting_Remark').val(remarkText);
                if (marginForPaperText !== null) remarkText = $('#modelRouting_Remark').val().replace(marginForPaperText, ""); $('#modelRouting_Remark').val(remarkText);

                $('#modelRouting_LineQtyPerBox').val(null);
                $('#modelRouting_MarginForPaper').val(null);

                tearTapeText = null;
                lineQtyPerBoxText = null;
                marginForPaperText = null;
            }
        });

        var lineQtyPerBoxText = null;
        $('#modelRouting_LineQtyPerBox').focusout(function () {
            var remarkText;
            if ($(this).val() !== "" && lineQtyPerBoxText === null) {
                lineQtyPerBoxText = " จำนวน " + $('#modelRouting_LineQtyPerBox').val() + " เส้น";
                remarkText = $('#modelRouting_Remark').val() + lineQtyPerBoxText;
                $('#modelRouting_Remark').val(remarkText);
            }
            else if ($(this).val() === "" && lineQtyPerBoxText !== null) {
                remarkText = $('#modelRouting_Remark').val().replace(lineQtyPerBoxText, "");
                $('#modelRouting_Remark').val(remarkText);
                lineQtyPerBoxText = null;
            }
            else {
                remarkText = $('#modelRouting_Remark').val().replace(lineQtyPerBoxText, "");
                lineQtyPerBoxText = " จำนวน " + $('#modelRouting_LineQtyPerBox').val() + " เส้น";
                remarkText = remarkText + lineQtyPerBoxText;
                $('#modelRouting_Remark').val(remarkText);
            }
        });

        var marginForPaperText = null;
        $('#modelRouting_MarginForPaper').focusout(function () {
            var remarkText;
            if ($(this).val() !== "" && marginForPaperText === null) {
                marginForPaperText = " ระยะจากขอบกระดาษ " + $('#modelRouting_MarginForPaper').val() + " มิลลิเมตร";
                remarkText = $('#modelRouting_Remark').val() + marginForPaperText;
                $('#modelRouting_Remark').val(remarkText);
            }
            else if ($(this).val() === "" && marginForPaperText !== null) {
                remarkText = $('#modelRouting_Remark').val().replace(marginForPaperText, "");
                $('#modelRouting_Remark').val(remarkText);
                marginForPaperText = null;
            }
            else {
                remarkText = $('#modelRouting_Remark').val().replace(marginForPaperText, "");
                marginForPaperText = " ระยะจากขอบกระดาษ " + $('#modelRouting_MarginForPaper').val() + " มิลลิเมตร";
                remarkText = remarkText + marginForPaperText;
                $('#modelRouting_Remark').val(remarkText);
            }
        });

        var tmpweigth = null;
        $('#modelRouting_NoOpenIn').keyup(function () {
            if ($(this).val() !== "") {
                if ($(this).val() <= $('#modelRouting_NoOpenOut').val()) {
                    $('#modelRouting_NoOpenOut').val($('#modelRouting_NoOpenIn').val())
                }
            }
            setInOutProperties();
        });

        $('#modelRouting_NoOpenOut').keyup(function () {
            if ($(this).val() > $('#modelRouting_NoOpenIn').val()) {
                swal("จำนวนเปิด Out ต้องน้อยกว่าหรือเท่ากับ จำนวนเปิด In", "", "warning");
                $('#modelRouting_NoOpenOut').val($('#modelRouting_NoOpenIn').val())
            }
            setInOutProperties();
        });

         var wotold = "";
        $('#modelRouting_JoinToMaterialNo').keyup(function () {
            //เปลี่ยนเป็น ถ้ากรอก Join to material No. เท่ากับ Mat ที่ทำอยู่ ให้น้ำหนัก  Out = (In *2 ) ที่ process นั้นเลย
            if (wotold === "")
            {
                wotold  = $('#modelRouting_WeightOut').val()
            }

            if ($(this).val() === '@Model.MaterialNo')
            {
                var win = $('#modelRouting_WeightIn').val();
                var cal_in = win * 2;
                $('#modelRouting_WeightOut').val(cal_in.toFixed(3));
            } else
            {
                $('#modelRouting_WeightOut').val(wotold)
                wotold = "";
            }
        });

        $('#modelRouting_LineQtyPerBox').change(function () {
            CheckValidateCore();
        });

        $('#modelRouting_Cut').change(function () {
            if ($('#modelRouting_TearTape').prop('checked')) {
                if (ChecTearTapeMaxInCal())
                {
                   // swal("The number of teartape max is too high.", "", "warning");
                    $('#modelRouting_PaperRollWidth').val("0");
                    $('#modelRouting_Cut').val("0");
                    $('#modelRouting_Trim').val("0");
                    $('#modelRouting_PercentTrim').val("0");
                }
                else
                {
                   $.ajax({
                       url: '@Url.Action("CalculateNewCut", "NewProduct")',
                       type: "POST",
                       dataType: "json",
                       data: { cut: $('#modelRouting_Cut').val(), WidthIn: $('#modelRouting_SheetWidthIn').val(), Flut: '@Model.Flute'},
                       success: function (data) {
                           if (data.exError === "1")
                           {
                               $('#modelRouting_PaperRollWidth').val(data.model.PaperRollWidth);
                               $('#modelRouting_Cut').val(data.model.Cut);
                               $('#modelRouting_Trim').val(data.model.Trim);
                               $('#modelRouting_PercentTrim').val(data.model.PercentTrim);
                           }
                           else
                           {
                               //swal("The number of cuts is too high.", "", "warning");
                               $('#modelRouting_PaperRollWidth').val("0");
                               $('#modelRouting_Cut').val("0");
                               $('#modelRouting_Trim').val("0");
                               $('#modelRouting_PercentTrim').val("0");
                           }
                          }
                       });
                }
            }
            else
            {
                       $.ajax({
                       url: '@Url.Action("CalculateNewCut", "NewProduct")',
                       type: "POST",
                       dataType: "json",
                       data: { cut: $('#modelRouting_Cut').val(), WidthIn: $('#modelRouting_SheetWidthIn').val(), Flut: '@Model.Flute'},
                       success: function (data) {
                           if (data.exError === "1")
                           {
                               $('#modelRouting_PaperRollWidth').val(data.model.PaperRollWidth);
                               $('#modelRouting_Cut').val(data.model.Cut);
                               $('#modelRouting_Trim').val(data.model.Trim);
                               $('#modelRouting_PercentTrim').val(data.model.PercentTrim);
                           }
                           else
                           {
                              // swal("The number of cuts is too high.", "", "warning");
                               $('#modelRouting_PaperRollWidth').val("0");
                               $('#modelRouting_Cut').val("0");
                               $('#modelRouting_Trim').val("0");
                               $('#modelRouting_PercentTrim').val("0");

                           }
                          }
                       });
           }
        });

        $('#modelRouting_PaperRollWidth').change(function () {
            if ($('#modelRouting_TearTape').prop('checked')) {
                    $.ajax({
                    url: '@Url.Action("CalculatePaperRollWidth", "NewProduct")',
                    type: "POST",
                    dataType: "json",
                    data: { PaperwWidth: $('#modelRouting_PaperRollWidth').val(), WidthIn: $('#modelRouting_SheetWidthIn').val(), Flut: '@Model.Flute' },
                    success: function (data) {
                        if (data.exError === "1")
                        {
                            $('#modelRouting_PaperRollWidth').val(data.model.PaperRollWidth);
                            $('#modelRouting_Cut').val(data.model.Cut);
                            $('#modelRouting_Trim').val(data.model.Trim);
                            $('#modelRouting_PercentTrim').val(data.model.PercentTrim);
                            if (ChecTearTapeMaxInCal())
                            {
                                //swal("The number of teartape max is too high.", "", "warning");
                                $('#modelRouting_PaperRollWidth').val("0");
                                $('#modelRouting_Cut').val("0");
                                $('#modelRouting_Trim').val("0");
                                $('#modelRouting_PercentTrim').val("0");
                            }
                        }
                        else
                        {
                            //swal("The number of paperwidth is too high.", "", "warning");
                            $('#modelRouting_PaperRollWidth').val("0");
                            $('#modelRouting_Cut').val("0");
                            $('#modelRouting_Trim').val("0");
                            $('#modelRouting_PercentTrim').val("0");
                        }

                    }
                });

            } else {
                $.ajax({
                    url: '@Url.Action("CalculatePaperRollWidth", "NewProduct")',
                    type: "POST",
                    dataType: "json",
                    data: { PaperwWidth: $('#modelRouting_PaperRollWidth').val(), WidthIn: $('#modelRouting_SheetWidthIn').val(), Flut: '@Model.Flute' },
                    success: function (data) {
                        if (data.exError === "1")
                        {
                            $('#modelRouting_PaperRollWidth').val(data.model.PaperRollWidth);
                            $('#modelRouting_Cut').val(data.model.Cut);
                            $('#modelRouting_Trim').val(data.model.Trim);
                            $('#modelRouting_PercentTrim').val(data.model.PercentTrim);
                        }
                        else
                        {
                            //swal("The number of paperwidth is too high.", "", "warning");
                            $('#modelRouting_PaperRollWidth').val("0");
                            $('#modelRouting_Cut').val("0");
                            $('#modelRouting_Trim').val("0");
                            $('#modelRouting_PercentTrim').val("0");
                        }

                    }
                });
            }
        });

        $("#ReCalculate").click(
            function () {
                ReCalculate();
            }
        );

        // On Teartape Check
        $('#modelRouting_TearTape').click(function () {
            if ($('#modelRouting_TearTape').prop('checked')) {
                $('#TeartapeBox').show();
            }
            else {
                $('#TeartapeBox').hide();
                $('#modelRouting_LineQtyPerBox').val("")
                ReCalculate();
            }
        });

        $(function () {
            $('#modelRouting_MachineMove').on('change', function () {
                var checked = $(this).prop('checked');
                $('#modelRouting_Alternative1').prop('disabled', !checked);
                $('#modelRouting_Alternative2').prop('disabled', !checked);
                $('#btncolspan').prop('disabled', !checked);
                if (!checked) { ClearAlternative(); }
            });
        });

        //higthligth list select
        $(function () {
            $('.list-group').on('click', '.list-group-item', function () {
                $('.list-group-item').removeClass('active');
                $(this).closest('.list-group-item').addClass('active');
            });
        });
        //***************************************************  End Manage TextBox **************************************

        //***************************************************  Remark **************************************
        $("#btnGetRemark").click(function () {
            $('#modalRemark').modal('show');
        });

         // AutoComplete for Remark
        $("#modelRouting_Remark").autocomplete({
            minLength: 0,
            maxShowItems: 5,
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("GetRemark", "NewProduct")',
                    type: "POST",
                    dataType: "json",
                    data: { keywordRemark: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.List, value: item.List };
                        }));

                    }
                });
            },
            messages: {
                noResults: "", results: ""
            }
        }).on('focus', function (event) {
            var self = this;
            $(self).autocomplete("search", this.value);
        });
        //***************************************************  End Remark **************************************

        //***************************************************  Manage Button Add **************************************
            // Create Function
        $('#btnNew').click(function () {
          //  $('#checkStatusBtn').val("")
            $('#checkStatusBtnEdit').val("")
           // $('#btnSubmit').css('display', 'none');
            $('#lbl_status_insert').text('');
            setReadOnly("0");
            ClearField();
            ClearPrintArray();
            ClearDieCutArray();

            $('.list-group-item').removeClass('active');

            $("#modelRouting_MachineMove").prop('checked', true);
            $('#modelRouting_Alternative1').prop('disabled', false);
            $('#modelRouting_Alternative2').prop('disabled', false);

            $('#btnRemoveAttachFile').hide();

            $("#modelRouting_Machine").prop("disabled", false);

            $('#RoutingData').val(null);

            GetLastNumberList();

            $('#btnAddMachine').css('display', 'block');
            $('#btnInsertMachine').css('display', 'none');
            $('#btnUpdateMachine').css('display', 'none');

            PlatTypeRadioCheck(@Model.amountColor);
        });

         // Add Machine
        $('#btnAddMachine').click(function () {
            //if (checkSelectShard()) {
            //    swal("Please Select Shade!", "", "warning");
            //}
            //else {
                if (!checkMatchineBeforeAdd()) {
                    var $form = $("form");
                    $.ajax({
                        url: '@Url.Action("CheckPlattenAndRotary", "NewProduct")',
                        type: "POST",
                        dataType: "json",
                        data: { machine: $("#modelRouting_Machine").val() },
                        success: function (ress) {
                            var checkbool = CheckValidateInk(@Model.amountColor, $("#modelRouting_Ink1").val(), $("#modelRouting_Ink2").val(), $("#modelRouting_Ink3").val(), $("#modelRouting_Ink4").val(), $("#modelRouting_Ink5").val(), $("#modelRouting_Ink6").val(), $("#modelRouting_Ink7").val(), $("#modelRouting_Ink8").val());
                            if (!CheckPrintingPage('@Model.amountColor')) {
                                $.ajax({
                                    type: 'POST',
                                    url: '@Url.Action("GetDataToCondition", "NewProduct")',
                                    data: { machine: $('#modelRouting_Machine').val() },
                                    success: function (res) {
                                        //********************** check conditon all = 0
                                        if (res.isPropCor === 0 && res.isPropPrint === 0 && res.isPropDieCut === 0 && res.isCalPaperwidth === 0) {
                                            _subAddMachineToDataBase()
                                        }
                                        else {
                                            //swal({
                                            //    title: "Are you sure ?",
                                            //    text: "ยังไม่ได้กรอกข้อมูล Printing Plate No.",
                                            //    icon: "info",
                                            //    buttons: true,
                                            //    dangerMode: false,
                                            //})
                                            //    .then((willDel) => {
                                            //        if (willDel) {
                                                        if (ress.CheckPlatenRotary === "1") {
                                                            var cuttingDie = $("#modelRouting_CuttingDieNo").val();
                                                            if (cuttingDie !== "" && cuttingDie !== null) {
                                                                if (checkCuttingAndNoout()) {
                                                                    var noIn = $("#modelRouting_NoOpenIn").val();
                                                                    var noOut = $("#modelRouting_NoOpenOut").val();
                                                                    if (noOut > noIn) {
                                                                        swal({
                                                                            title: "Are you sure ?",
                                                                            text: "จำนวนเปิด Out ต้องน้อยกว่าหรือเท่ากับ จำนวนเปิด In",
                                                                            icon: "info",
                                                                            buttons: true,
                                                                            dangerMode: false,
                                                                        })
                                                                            .then((willDelete) => {
                                                                                if (willDelete) {
                                                                                    //if (checkbool) {
                                                                                    //    swal({
                                                                                    //        title: "Are you sure ?",
                                                                                    //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                                                                    //        icon: "info",
                                                                                    //        buttons: true,
                                                                                    //        dangerMode: false,
                                                                                    //    })
                                                                                    //        .then((willDelete) => {
                                                                                    //            if (willDelete) {
                                                                                    //                subAddMachine();
                                                                                    //            }
                                                                                    //        });
                                                                                    //}
                                                                                    //else {
                                                                                        subAddMachine();
                                                                                   // }
                                                                                }
                                                                            });
                                                                    }
                                                                    else {
                                                                        subAddMachine();
                                                                    }
                                                                }
                                                                else {
                                                                    //if (checkbool) {
                                                                    //    swal({
                                                                    //        title: "Are you sure ?",
                                                                    //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                                                    //        icon: "info",
                                                                    //        buttons: true,
                                                                    //        dangerMode: false,
                                                                    //    })
                                                                    //        .then((willDelete) => {
                                                                    //            if (willDelete) {
                                                                    //                subAddMachine();
                                                                    //            }
                                                                    //        });
                                                                    //}
                                                                    //else {
                                                                        subAddMachine();
                                                                    //}
                                                                }
                                                            }
                                                            else {
                                                                //if (checkbool) {
                                                                //    swal({
                                                                //        title: "Are you sure ?",
                                                                //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                                                //        icon: "info",
                                                                //        buttons: true,
                                                                //        dangerMode: false,
                                                                //    })
                                                                //        .then((willDelete) => {
                                                                //            if (willDelete) {
                                                                //                subAddMachine();
                                                                //            }
                                                                //        });

                                                                //}
                                                                //else {
                                                                    subAddMachine();
                                                                //}
                                                            }
                                                        }
                                                        else {
                                                            subAddMachine();
                                                        }
                                                   // }
                                               // });
                                        }

                                    },
                                    error: function () { }
                                });
                            }
                            else {
                                if (ress.CheckPlatenRotary === "1") {
                                    var cuttingDie = $("#modelRouting_CuttingDieNo").val();
                                    if (cuttingDie !== "" && cuttingDie !== null) {
                                        var noIn = $("#modelRouting_NoOpenIn").val();
                                        var noOut = $("#modelRouting_NoOpenOut").val();
                                        if (noOut > noIn) {
                                            swal({
                                                title: "Are you sure ?",
                                                text: "จำนวนเปิด Out ต้องน้อยกว่าหรือเท่ากับ จำนวนเปิด In",
                                                icon: "info",
                                                buttons: {
                                                    confirm: "Ok",
                                                    cancel: true,
                                                },
                                                dangerMode: false,
                                            })
                                                .then((willDelete) => {
                                                    if (willDelete) {
                                                        //if (checkbool) {
                                                        //    swal({
                                                        //        title: "Are you sure ?",
                                                        //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                                        //        icon: "info",
                                                        //        buttons: true,
                                                        //        dangerMode: false,
                                                        //    })
                                                        //        .then((willDelete) => {
                                                        //            if (willDelete) {
                                                        //                subAddMachine();
                                                        //            }
                                                        //        });

                                                        //} else {
                                                            subAddMachine();
                                                       // }
                                                    }
                                                });
                                        }
                                        else {
                                            //if (checkbool) {
                                            //    swal({
                                            //        title: "Are you sure ?",
                                            //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                            //        icon: "info",
                                            //        buttons: true,
                                            //        dangerMode: false,
                                            //    })
                                            //        .then((willDelete) => {
                                            //            if (willDelete) {
                                            //                subAddMachine();
                                            //            }
                                            //        });
                                            //}
                                            //else {
                                                subAddMachine();
                                           // }
                                        }
                                    }
                                    else {
                                        //if (checkbool) {
                                        //    swal({
                                        //        title: "Are you sure ?",
                                        //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                        //        icon: "info",
                                        //        buttons: true,
                                        //        dangerMode: false,
                                        //    })
                                        //        .then((willDelete) => {
                                        //            if (willDelete) {
                                        //                subAddMachine();
                                        //            }
                                        //        });
                                        //}
                                        //else {
                                            subAddMachine();
                                        //}
                                    }
                                }
                                else {
                                    subAddMachine();
                                }
                            }
                        },
                        error: function () { }
                    });
                }
           // }
        });

        function subAddMachine()
            {
                if ($("#modelRouting_MachineGroupSelect").val() === "3" && ($("#modelRouting_NoOpenIn").val() > $("#modelRouting_NoOpenOut").val())) {
                    //**********************เช็ค NoOpenOut < NoOpenIn ให้ใส่ Cutting Dieno (machine Flexo /rotary) ให้ใส่ cutting dieno
                    if ($('#modelRouting_CuttingDieNo').val() === "")
                    {
                        swal({
                            title: "Are you sure ?",
                            text: "โปรดระบุข้อมูล Cutting die No..",
                            icon: "info",
                            buttons: {
                                confirm: "Ok",
                                cancel: true,
                            },
                            dangerMode: false,
                        })
                            .then((willDelete) => {
                                if (willDelete) {
                                    _subAddMachineToDataBase();
                                }
                            });
                    }
                    else
                    {
                        _SubAddCheckMachinegroup4();
                    }
                }
                else
                {
                    _SubAddCheckMachinegroup4();
                }
        }

        function _SubAddCheckMachinegroup4() {
            if ($("#modelRouting_MachineGroupSelect").val() === "4") {
                if ($('#modelRouting_CuttingDieNo').val() === "") {
                    swal({
                        title: "Are you sure ?",
                        text: "โปรดระบุข้อมูล Cutting die No..",
                        icon: "info",
                        buttons: {
                            confirm: "Ok",
                            cancel: true,
                        },
                        dangerMode: false,
                    })
                        .then((willDelete) => {
                            if (willDelete) {
                                _subAddMachineToDataBase();
                            }
                        });
                }
                else
                {
                    _subAddMachineToDataBase();
                }
            }
            else
            {
                $.ajax({
                type: 'POST',
                url: '@Url.Action("GetDataToCondition", "NewProduct")',
                data: { machine: $('#modelRouting_Machine').val() },
                success: function (res) {
                    var noIn = $("#modelRouting_NoOpenIn").val();
                    var noOut = $("#modelRouting_NoOpenOut").val();
                    if (res.isPropDieCut === 1 && (noIn !== noOut) && $('#modelRouting_CuttingDieNo').val() === "") {
                        swal({
                            title: "Are you sure ?",
                            text: "โปรดระบุข้อมูล Cutting die No..",
                            icon: "info",
                            buttons: {
                                confirm: "Ok",
                                cancel: true,
                            },
                            dangerMode: false,
                        })
                            .then((willDelete) => {
                                if (willDelete)
                                {
                                    _subAddMachineToDataBase();
                                }

                            });
                    }
                    else if (res.isPropDieCut === 1 && '@Model.BoxHandle' === "True" && $('#modelRouting_CuttingDieNo').val() === "") {
                        swal({
                            title: "Are you sure ?",
                            text: "โปรดระบุข้อมูล Cutting die No..",
                            icon: "info",
                            buttons: {
                                confirm: "Ok",
                                cancel: true,
                            },
                            dangerMode: false,
                        })
                            .then((willDelete) => {
                                if (willDelete)
                                {
                                    _subAddMachineToDataBase();
                                }
                            });
                    }
                    else
                    {
                        _subAddMachineToDataBase();
                    }

                    },
                    error: function () { }
               });

            }
        }

        function _subAddMachineToDataBase() {
                lastweigth, lastnop, lastsheetwout, lastsheetlout;

                lastnop = $('#modelRouting_NoOpenOut').val();
                lastweigth = $('#modelRouting_WeightOut').val();
                lastsheetwout = $('#modelRouting_SheetWidthOut').val();
                lastsheetwout = $('#modelRouting_SheetWidthOut').val();
                lastsheetlout = $('#modelRouting_SheetLengthOut').val();

                NoOpenInLast = $('#modelRouting_NoOpenIn').val();
                NoOpenOutLast = $('#modelRouting_NoOpenOut').val();

                weightInLast = $('#modelRouting_WeightIn').val();
                weightOutLast = $('#modelRouting_WeightOut').val();

                lengthout = $('#modelRouting_SheetLengthOut').val();
                wiegthout = $('#modelRouting_SheetWidthOut').val();

                $("#formHiddenFieldDiecut").val(JSON.stringify(DiecutGetData()))
                $("#formHiddenFieldPrint").val(JSON.stringify(PrintGetData()))

                var formData = $('#RoutingForm').serialize();
                $.ajax({
                    type: 'post',
                    url: '@Url.Action("RoutingAddMachine", "Report")',
                    data: formData,
                    async: false,
                    //beforeSend: function () {
                    //    $("#loader").modal("show");
                    //},
                    success: function (res) {

                        $('#RoutingBox').html(res);
                        ClearField();

                        if ($("#modelRouting_MachineMove").prop('checked') == false) {
                            $("#modelRouting_Alternative1").attr("disabled", "disabled");
                            $("#modelRouting_Alternative2").attr("disabled", "disabled");
                            $("#btncolspan").attr("disabled", "disabled");
                        }

                        $("#modelRouting_MachineMove").prop('checked', true);
                        $('#modelRouting_Alternative1').prop('disabled', false);
                        $('#modelRouting_Alternative2').prop('disabled', false);

                        $('#btnRemoveAttachFile').hide();

                        $('#modelRouting_NoOpenIn').val(lastnop);
                        $('#modelRouting_NoOpenOut').val(lastnop);

                        $('#modelRouting_WeightIn').val(lastweigth);
                        $('#modelRouting_WeightOut').val(lastweigth);

                        $('#modelRouting_SheetLengthIn').val(lastsheetlout);
                        $('#modelRouting_SheetLengthOut').val(lastsheetlout);
                        $('#modelRouting_SheetWidthIn').val(lastsheetwout);
                        $('#modelRouting_SheetWidthOut').val(lastsheetwout);
                        printerSelect = false;
                    },
                    error: function () { $("#loader").modal("hide"); }
            });
        }
         //*************************************************** End Manage Button Add**************************************

         //***************************************************  Manage Button  Insert**************************************
        $('#BtnCancelModal').click(function () {
            $("#modal-show-Insert-seq").modal("hide");
            $('#lbl_status_insert').text('');
        });

        $('#btnInsert').click(function () {
           // $('#checkStatusBtn').val("Insert Machine")
            $('#checkStatusBtnEdit').val("")
                $.ajax({
                    url: '@Url.Action("GetListModalSeq", "Report")',
                    data: { OrderItem:'@Model.OrderSelect'},
                    type: "POST",
                    async: false,
                    dataType: "json",
                    success: function (res) {
                        $('#dropdown_seq_partial').html(res);
                        $("#modal-show-Insert-seq").modal({ backdrop: 'static', keyboard: false });
                        $("#modal-show-Insert-seq").modal("show");
                    },
                    error: function () {  }
                });
        });

        $('#BtnInsertModal').click(function () {
            $('#lbl_status_insert').text('Insert Data Before : ' + $('#id_seq option:selected').text());

            var seq = $('.list-group').find('.active').data('itemtype');
            setReadOnly("0");
            $('.list-group-item').removeClass('active');
            ClearPrintArray();
            ClearDieCutArray();
            $("#modal-show-Insert-seq").modal("hide");

            if (seq !== '') {

                lastweigth, lastnop, lastsheetwout, lastsheetlout;
                lastnop = $('#modelRouting_NoOpenOut').val();
                lastweigth = $('#modelRouting_WeightOut').val();
                lastsheetwout = $('#modelRouting_SheetWidthOut').val();
                lastsheetlout = $('#modelRouting_SheetLengthOut').val();
                ClearField();

                $("#modelRouting_MachineMove").prop('checked', true);
                $('#modelRouting_Alternative1').prop('disabled', false);
                $('#modelRouting_Alternative2').prop('disabled', false);
                $('#btncolspan').prop('disabled', false);

                $('#btnRemoveAttachFile').hide();

                $("#modelRouting_Machine").prop("disabled", false);

                $('#modelRouting_NoOpenIn').val(lastnop);
                $('#modelRouting_NoOpenOut').val(lastnop);

                $('#modelRouting_WeightIn').val(lastweigth);
                $('#modelRouting_WeightOut').val(lastweigth);

                $('#modelRouting_SheetLengthIn').val(lastsheetlout);
                $('#modelRouting_SheetLengthOut').val(lastsheetlout);
                $('#modelRouting_SheetWidthIn').val(lastsheetwout);
                $('#modelRouting_SheetWidthOut').val(lastsheetwout);

                $('#btnAddMachine').css('display', 'none');
                $("#btnUpdateMachine").css("display", "none");
                $('#btnInsertMachine').css('display', 'block');
            }
        });

                // Insert Function
        $('#btnInsertMachine').click(function () {
            //if (checkSelectShard()) {
            //    swal("Please Select Shade!", "", "warning");
            //}
            //else {
                if (!checkMatchineBeforeAdd()) {
                    lastweigth, lastnop, lastsheetwout, lastsheetlout;
                    lastnop = $('#modelRouting_NoOpenOut').val();
                    lastweigth = $('#modelRouting_WeightOut').val();
                    lastsheetwout = $('#modelRouting_SheetWidthOut').val();
                    lastsheetlout = $('#modelRouting_SheetLengthOut').val();

                    $.ajax({
                        url: '@Url.Action("CheckPlattenAndRotary", "NewProduct")',
                        type: "POST",
                        dataType: "json",
                        data: { machine: $("#modelRouting_Machine").val() },
                        success: function (ress) {
                            var checkbool = CheckValidateInk(@Model.amountColor, $("#modelRouting_Ink1").val(), $("#modelRouting_Ink2").val(), $("#modelRouting_Ink3").val(), $("#modelRouting_Ink4").val(), $("#modelRouting_Ink5").val(), $("#modelRouting_Ink6").val(), $("#modelRouting_Ink7").val(), $("#modelRouting_Ink8").val());
                            if (!CheckPrintingPage('@Model.amountColor')) {
                                $.ajax({
                                    type: 'POST',
                                    url: '@Url.Action("GetDataToCondition", "NewProduct")',
                                    data: { machine: $('#modelRouting_Machine').val() },
                                    success: function (res) {
                                        //********************** check conditon all = 0
                                        if (res.isPropCor === 0 && res.isPropPrint === 0 && res.isPropDieCut === 0 && res.isCalPaperwidth === 0) {
                                            SubInsert();
                                        }
                                        else {
                                            //swal({
                                            //    title: "Are you sure ?",
                                            //    text: "ยังไม่ได้กรอกข้อมูล Printing Plate No.",
                                            //    icon: "info",
                                            //    buttons: true,
                                            //    dangerMode: false,
                                            //})
                                            //    .then((willDel) => {
                                            //        if (willDel) {
                                                        if (ress.CheckPlatenRotary === "1") {
                                                            var cuttingDie = $("#modelRouting_CuttingDieNo").val();
                                                            if (cuttingDie !== "" && cuttingDie !== null) {
                                                                if (checkCuttingAndNoout()) {
                                                                    var noIn = $("#modelRouting_NoOpenIn").val();
                                                                    var noOut = $("#modelRouting_NoOpenOut").val();
                                                                    if (noOut > noIn) {
                                                                        swal({
                                                                            title: "Are you sure ?",
                                                                            text: "จำนวนเปิด Out ต้องน้อยกว่าหรือเท่ากับ จำนวนเปิด In",
                                                                            icon: "info",
                                                                            buttons: true,
                                                                            dangerMode: false,
                                                                        })
                                                                            .then((willDelete) => {
                                                                                if (willDelete) {
                                                                                    //if (checkbool) {
                                                                                    //    swal({
                                                                                    //        title: "Are you sure ?",
                                                                                    //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                                                                    //        icon: "info",
                                                                                    //        buttons: true,
                                                                                    //        dangerMode: false,
                                                                                    //    })
                                                                                    //        .then((willDelete) => {
                                                                                    //            if (willDelete) {
                                                                                    //                SubInsert();
                                                                                    //            }
                                                                                    //        });
                                                                                    //}
                                                                                    //else {
                                                                                        SubInsert();
                                                                                    //}
                                                                                }
                                                                            });
                                                                    }
                                                                    else {
                                                                        SubInsert();
                                                                    }
                                                                }
                                                                else {
                                                                    //if (checkbool) {
                                                                    //    swal({
                                                                    //        title: "Are you sure ?",
                                                                    //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                                                    //        icon: "info",
                                                                    //        buttons: true,
                                                                    //        dangerMode: false,
                                                                    //    })
                                                                    //        .then((willDelete) => {
                                                                    //            if (willDelete) {
                                                                    //                SubInsert();
                                                                    //            }
                                                                    //        });
                                                                    //} else {
                                                                        SubInsert();
                                                                    //}
                                                                }
                                                            }
                                                            else {
                                                                //if (checkbool) {
                                                                //    swal({
                                                                //        title: "Are you sure ?",
                                                                //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                                                //        icon: "info",
                                                                //        buttons: true,
                                                                //        dangerMode: false,
                                                                //    })
                                                                //        .then((willDelete) => {
                                                                //            if (willDelete) {
                                                                //                SubInsert();
                                                                //            }
                                                                //        });
                                                                //}
                                                                //else {
                                                                    SubInsert();
                                                               // }
                                                            }
                                                        }
                                                        else {
                                                            SubInsert();
                                                        }
                                                //    }
                                                //});
                                        }
                                    },
                                    error: function () { }
                                });
                            }
                            else {
                                if (ress.CheckPlatenRotary === "1") {
                                    var cuttingDie = $("#modelRouting_CuttingDieNo").val();
                                    if (cuttingDie !== "" && cuttingDie !== null) {
                                        var noIn = $("#modelRouting_NoOpenIn").val();
                                        var noOut = $("#modelRouting_NoOpenOut").val();
                                        if (noOut > noIn) {
                                            swal({
                                                title: "Are you sure ?",
                                                text: "จำนวนเปิด Out ต้องน้อยกว่าหรือเท่ากับ จำนวนเปิด In",
                                                icon: "info",
                                                buttons: {
                                                    confirm: "Ok",
                                                    cancel: true,
                                                },
                                                dangerMode: false,
                                            })
                                                .then((willDelete) => {
                                                    if (willDelete) {
                                                        //if (checkbool) {
                                                        //    swal({
                                                        //        title: "Are you sure ?",
                                                        //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                                        //        icon: "info",
                                                        //        buttons: true,
                                                        //        dangerMode: false,
                                                        //    })
                                                        //        .then((willDelete) => {
                                                        //            if (willDelete) {
                                                        //                SubInsert();
                                                        //            }
                                                        //        });
                                                        //}
                                                        //else {
                                                            SubInsert();
                                                        //}
                                                    }
                                                });
                                        }
                                        else {
                                            //if (checkbool) {
                                            //    swal({
                                            //        title: "Are you sure ?",
                                            //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                            //        icon: "info",
                                            //        buttons: true,
                                            //        dangerMode: false,
                                            //    })
                                            //        .then((willDelete) => {
                                            //            if (willDelete) {
                                            //                SubInsert();
                                            //            }
                                            //        });
                                            //}
                                            //else {
                                                SubInsert();
                                            //}
                                        }
                                    }
                                    else {
                                        //if (checkbool) {
                                        //    swal({
                                        //        title: "Are you sure ?",
                                        //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                        //        icon: "info",
                                        //        buttons: true,
                                        //        dangerMode: false,
                                        //    })
                                        //        .then((willDelete) => {
                                        //            if (willDelete) {
                                        //                SubInsert();
                                        //            }
                                        //        });
                                        //}
                                        //else {
                                            SubInsert();
                                       // }
                                    }
                                }
                                else {
                                    SubInsert();
                                }
                            }
                        },
                        error: function () { }
                    });

                }
            //}
        });

        function SubInsert()
        {
        if ($("#modelRouting_MachineGroupSelect").val() === "3" && ($("#modelRouting_NoOpenIn").val() > $("#modelRouting_NoOpenOut").val())) {
            //**********************เช็ค NoOpenOut < NoOpenIn ให้ใส่ Cutting Dieno (machine Flexo /rotary) ให้ใส่ cutting dieno
            if ($('#modelRouting_CuttingDieNo').val() === "") {
                swal({
                    title: "Are you sure ?",
                    text: "โปรดระบุข้อมูล Cutting die No..",
                    icon: "info",
                    buttons: {
                        confirm: "Ok",
                        cancel: true,
                    },
                    dangerMode: false,
                })
                    .then((willDelete) => {
                        if (willDelete) {
                            _subInsertMachineToDataBase();
                        }
                    });
            }
            else
            {
                _SubInsertCheckMachinegroup4();
            }
        }
        else
        {
            _SubInsertCheckMachinegroup4();
        }
        }

        function _SubInsertCheckMachinegroup4() {
            if ($("#modelRouting_MachineGroupSelect").val() === "4") {
                if ($('#modelRouting_CuttingDieNo').val() === "") {
                    swal({
                        title: "Are you sure ?",
                        text: "โปรดระบุข้อมูล Cutting die No..",
                        icon: "info",
                        buttons: {
                            confirm: "Ok",
                            cancel: true,
                        },
                        dangerMode: false,
                    })
                        .then((willDelete) => {
                            if (willDelete) {
                                _subInsertMachineToDataBase();
                            }
                        });
                }
                else
                {
                    _subInsertMachineToDataBase();
                }
            }
            else
            {
                $.ajax({
                type: 'POST',
                url: '@Url.Action("GetDataToCondition", "NewProduct")',
                data: { machine: $('#modelRouting_Machine').val() },
                success: function (res) {
                    var noIn = $("#modelRouting_NoOpenIn").val();
                    var noOut = $("#modelRouting_NoOpenOut").val();
                    if (res.isPropDieCut === 1 && (noIn !== noOut) && $('#modelRouting_CuttingDieNo').val() === "") {
                        swal({
                            title: "Are you sure ?",
                            text: "โปรดระบุข้อมูล Cutting die No..",
                            icon: "info",
                            buttons: {
                                confirm: "Ok",
                                cancel: true,
                            },
                            dangerMode: false,
                        })
                            .then((willDelete) => {
                                if (willDelete)
                                {
                                    _subInsertMachineToDataBase();
                                }

                            });
                    }
                    else if (res.isPropDieCut === 1 && '@Model.BoxHandle' === "True" && $('#modelRouting_CuttingDieNo').val() === "") {
                        swal({
                            title: "Are you sure ?",
                            text: "โปรดระบุข้อมูล Cutting die No..",
                            icon: "info",
                            buttons: {
                                confirm: "Ok",
                                cancel: true,
                            },
                            dangerMode: false,
                        })
                            .then((willDelete) => {
                                if (willDelete)
                                {
                                    _subInsertMachineToDataBase();
                                }
                            });
                    }
                    else
                    {
                        _subInsertMachineToDataBase();
                    }

                    },
                    error: function () { }
               });

            }
        }

        function _subInsertMachineToDataBase()
        {
            $("#formHiddenFieldDiecut").val(JSON.stringify(DiecutGetData()))
            $("#formHiddenFieldPrint").val(JSON.stringify(PrintGetData()))

            var seq_num = $('#id_seq').val();
            $('#modelRouting_SeqNo').val(seq_num);
            var formData = $('#RoutingForm').serialize();
            $.ajax({
                type: 'POST',
                url: '@Url.Action("RoutingInsertMachine", "Report")',
                data: formData,
                async: false,
                //beforeSend: function () {
                //    $("#loader").modal("show");
                //},
                success: function (res) {

                    $('#RoutingBox').html(res);
                    ClearField();

                    $('#btnRemoveAttachFile').hide();

                    $("#modelRouting_MachineMove").prop('checked', true);
                    $('#modelRouting_Alternative1').prop('disabled', false);
                    $('#modelRouting_Alternative2').prop('disabled', false);

                    $('#modelRouting_NoOpenIn').val(lastnop);
                    $('#modelRouting_NoOpenOut').val(lastnop);

                    $('#modelRouting_WeightIn').val(lastweigth);
                    $('#modelRouting_WeightOut').val(lastweigth);

                    $('#modelRouting_SheetLengthIn').val(lastsheetlout);
                    $('#modelRouting_SheetLengthOut').val(lastsheetlout);
                    $('#modelRouting_SheetWidthIn').val(lastsheetwout);
                    $('#modelRouting_SheetWidthOut').val(lastsheetwout);

                    $('#btnInsertMachine').css('display', 'none');
                    $('#btnAddMachine').css('display', 'block');

                    $('#lbl_status_insert').text('');
                },
                error: function () { $("#loader").modal("hide"); }
            });
        }
         //***************************************************  End Manage Button  Insert**************************************

        //***************************************************  Manage Button  Update**************************************
        $("#btnEdit").click(function () {
            // $('#checkStatusBtn').val("Update Machine")
            $('#checkStatusBtnEdit').val("Edit")
           // $('#btnSubmit').css('display', 'none');
            $('#lbl_status_insert').text('');
            let seq = $('.list-group').find('.active').data('itemtype');
            if (seq > 0) {
                RoutingEdit(seq);
            }
            else {
                swal("โปรดเลือกข้อมูลที่จะเเก้ไข", "", "warning");
            }
        });

          // Update Machine
        $('#btnUpdateMachine').click(function () {
            $("#modelRouting_Machine").prop("disabled", false);
            lastweigth, lastnop, lastsheetwout, lastsheetlout;

            lastnop = $('#modelRouting_NoOpenOut').val();
            lastweigth = $('#modelRouting_WeightOut').val();
            lastsheetwout = $('#modelRouting_SheetWidthOut').val();
            lastsheetlout = $('#modelRouting_SheetLengthOut').val();
            //if (checkSelectShard()) {
            //    swal("Please Select Shade!", "", "warning");
            //}
            //else
            //{
                if (!checkMatchineBeforeAdd()) {
                    $.ajax({
                        url: '@Url.Action("CheckPlattenAndRotary", "NewProduct")',
                        type: "POST",
                        dataType: "json",
                        data: { machine: $("#modelRouting_Machine").val() },
                        success: function (ress) {
                            var checkbool = CheckValidateInk(@Model.amountColor, $("#modelRouting_Ink1").val(), $("#modelRouting_Ink2").val(), $("#modelRouting_Ink3").val(), $("#modelRouting_Ink4").val(), $("#modelRouting_Ink5").val(), $("#modelRouting_Ink6").val(), $("#modelRouting_Ink7").val(), $("#modelRouting_Ink8").val());
                            if (!CheckPrintingPage('@Model.amountColor')) {
                                $.ajax({
                                    type: 'POST',
                                    url: '@Url.Action("GetDataToCondition", "NewProduct")',
                                    data: { machine: $('#modelRouting_Machine').val() },
                                    success: function (res) {
                                        //********************** check conditon all = 0
                                        if (res.isPropCor === 0 && res.isPropPrint === 0 && res.isPropDieCut === 0 && res.isCalPaperwidth === 0) {
                                            SubUpdate();
                                        }
                                        else {
                                            //swal({
                                            //    title: "Are you sure ?",
                                            //    text: "ยังไม่ได้กรอกข้อมูล Printing Plate No.",
                                            //    icon: "info",
                                            //    buttons: true,
                                            //    dangerMode: false,
                                            //})
                                            //    .then((willDel) => {
                                            //        if (willDel) {
                                                        if (ress.CheckPlatenRotary === "1") {
                                                            var cuttingDie = $("#modelRouting_CuttingDieNo").val();
                                                            if (cuttingDie !== "" && cuttingDie !== null) {
                                                                if (checkCuttingAndNoout()) {
                                                                    var noIn = $("#modelRouting_NoOpenIn").val();
                                                                    var noOut = $("#modelRouting_NoOpenOut").val();
                                                                    if (noOut > noIn) {
                                                                        swal({
                                                                            title: "Are you sure ?",
                                                                            text: "จำนวนเปิด Out ต้องน้อยกว่าหรือเท่ากับ จำนวนเปิด In",
                                                                            icon: "info",
                                                                            buttons: true,
                                                                            dangerMode: false,
                                                                        })
                                                                            .then((willDelete) => {
                                                                                if (willDelete) {
                                                                                    //if (checkbool) {
                                                                                    //    swal({
                                                                                    //        title: "Are you sure ?",
                                                                                    //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                                                                    //        icon: "info",
                                                                                    //        buttons: true,
                                                                                    //        dangerMode: false,
                                                                                    //    })
                                                                                    //        .then((willDelete) => {
                                                                                    //            if (willDelete) {
                                                                                    //                SubUpdate();
                                                                                    //            }
                                                                                    //        });
                                                                                    //}
                                                                                    //else {
                                                                                        SubUpdate();
                                                                                    //}
                                                                                }
                                                                            });
                                                                    }
                                                                    else {
                                                                        SubUpdate();
                                                                    }
                                                                }
                                                                else {
                                                                    //if (checkbool) {
                                                                    //    swal({
                                                                    //        title: "Are you sure ?",
                                                                    //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                                                    //        icon: "info",
                                                                    //        buttons: true,
                                                                    //        dangerMode: false,
                                                                    //    })
                                                                    //        .then((willDelete) => {
                                                                    //            if (willDelete) {
                                                                    //                SubUpdate();
                                                                    //            }
                                                                    //        });
                                                                    //}
                                                                    //else {
                                                                        SubUpdate();
                                                                   // }
                                                                }
                                                            }
                                                            else {
                                                                //if (checkbool) {
                                                                //    swal({
                                                                //        title: "Are you sure ?",
                                                                //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                                                //        icon: "info",
                                                                //        buttons: true,
                                                                //        dangerMode: false,
                                                                //    })
                                                                //        .then((willDelete) => {
                                                                //            if (willDelete) {
                                                                //                SubUpdate();
                                                                //            }
                                                                //        });
                                                                //}
                                                                //else {
                                                                    SubUpdate();
                                                               // }
                                                            }

                                                        }
                                                        else {
                                                            SubUpdate();
                                                        }
                                                //    }
                                                //});
                                        }

                                    },
                                    error: function () { }
                                });
                            }
                            else {
                                if (ress.CheckPlatenRotary === "1") {
                                    var cuttingDie = $("#modelRouting_CuttingDieNo").val();
                                    if (cuttingDie !== "" && cuttingDie !== null) {
                                        var noIn = $("#modelRouting_NoOpenIn").val();
                                        var noOut = $("#modelRouting_NoOpenOut").val();
                                        if (noOut > noIn) {
                                            swal({
                                                title: "Are you sure ?",
                                                text: "จำนวนเปิด Out ต้องน้อยกว่าหรือเท่ากับ จำนวนเปิด In",
                                                icon: "info",
                                                buttons: {
                                                    confirm: "Ok",
                                                    cancel: true,
                                                },
                                                dangerMode: false,
                                            })
                                                .then((willDelete) => {
                                                    if (willDelete) {
                                                        //if (checkbool) {
                                                        //    swal({
                                                        //        title: "Are you sure ?",
                                                        //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                                        //        icon: "info",
                                                        //        buttons: true,
                                                        //        dangerMode: false,
                                                        //    })
                                                        //        .then((willDelete) => {
                                                        //            if (willDelete) {
                                                        //                SubUpdate();
                                                        //            }
                                                        //        });
                                                        //}
                                                        //else {
                                                            SubUpdate();
                                                        //}
                                                    }
                                                });
                                        }
                                        else {
                                            //if (checkbool) {
                                            //    swal({
                                            //        title: "Are you sure ?",
                                            //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                            //        icon: "info",
                                            //        buttons: true,
                                            //        dangerMode: false,
                                            //    })
                                            //        .then((willDelete) => {
                                            //            if (willDelete) {
                                            //                SubUpdate();
                                            //            }
                                            //        });

                                            //}
                                            //else {
                                                SubUpdate();
                                           // }
                                        }
                                    }
                                    else {
                                        //if (checkbool) {
                                        //    swal({
                                        //        title: "Are you sure ?",
                                        //        text: "จำนวนสีไม่เท่ากับที่เลือกไว้",
                                        //        icon: "info",
                                        //        buttons: true,
                                        //        dangerMode: false,
                                        //    })
                                        //        .then((willDelete) => {
                                        //            if (willDelete) {
                                        //                SubUpdate();
                                        //            }
                                        //        });
                                        //}
                                        //else {
                                            SubUpdate();
                                       // }
                                    }

                                }
                                else {
                                    SubUpdate();
                                }
                            }
                        },
                        error: function () { }
                    });

                }
           // }
        });

        function SubUpdate() {
                if ($("#modelRouting_MachineGroupSelect").val() === "3" && ($("#modelRouting_NoOpenIn").val() > $("#modelRouting_NoOpenOut").val())) {
                    //**********************เช็ค NoOpenOut < NoOpenIn ให้ใส่ Cutting Dieno (machine Flexo /rotary) ให้ใส่ cutting dieno
                    if ($('#modelRouting_CuttingDieNo').val() === "") {
                        swal({
                            title: "Are you sure ?",
                            text: "โปรดระบุข้อมูล Cutting die No..",
                            icon: "info",
                            buttons: {
                                confirm: "Ok",
                                cancel: true,
                            },
                            dangerMode: false,
                        })
                            .then((willDelete) => {
                                if (willDelete) {
                                    __SubUpdateToDataBase();
                                }
                            });
                    }
                    else
                    {
                        _SubUpdateCheckMachinegroup4();

                    }
                }
                else
                {
                    _SubUpdateCheckMachinegroup4();

                }
        }

        function _SubUpdateCheckMachinegroup4() {
            if ($("#modelRouting_MachineGroupSelect").val() === "4") {
                if ($('#modelRouting_CuttingDieNo').val() === "") {
                    swal({
                        title: "Are you sure ?",
                        text: "โปรดระบุข้อมูล Cutting die No..",
                        icon: "info",
                        buttons: {
                            confirm: "Ok",
                            cancel: true,
                        },
                        dangerMode: false,
                    })
                        .then((willDelete) => {
                            if (willDelete) {
                                __SubUpdateToDataBase();
                            }
                        });
                }
                else
                {
                    __SubUpdateToDataBase();
                }
            }
            else
            {
                $.ajax({
                type: 'POST',
                url: '@Url.Action("GetDataToCondition", "NewProduct")',
                data: { machine: $('#modelRouting_Machine').val() },
                success: function (res) {
                    var noIn = $("#modelRouting_NoOpenIn").val();
                    var noOut = $("#modelRouting_NoOpenOut").val();
                    if (res.isPropDieCut === 1 && (noIn !== noOut) && $('#modelRouting_CuttingDieNo').val() === "") {
                        swal({
                            title: "Are you sure ?",
                            text: "โปรดระบุข้อมูล Cutting die No..",
                            icon: "info",
                            buttons: {
                                confirm: "Ok",
                                cancel: true,
                            },
                            dangerMode: false,
                        })
                            .then((willDelete) => {
                                if (willDelete)
                                {
                                    __SubUpdateToDataBase();
                                }

                            });
                    }
                    else if (res.isPropDieCut === 1 && '@Model.BoxHandle' === "True" && $('#modelRouting_CuttingDieNo').val() === "") {
                        swal({
                            title: "Are you sure ?",
                            text: "โปรดระบุข้อมูล Cutting die No..",
                            icon: "info",
                            buttons: {
                                confirm: "Ok",
                                cancel: true,
                            },
                            dangerMode: false,
                        })
                            .then((willDelete) => {
                                if (willDelete)
                                {
                                    __SubUpdateToDataBase();
                                }
                            });
                    }
                    else
                    {
                        __SubUpdateToDataBase();
                    }

                    },
                    error: function () { }
               });

            }
        }

        function __SubUpdateToDataBase()
        {
            $("#formHiddenFieldDiecut").val(JSON.stringify(DiecutGetData()))
            $("#formHiddenFieldPrint").val(JSON.stringify(PrintGetData()))
            var formData = $('#RoutingForm').serialize();
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("RoutingUpdateMachine", "Report")',
                    data: formData,
                    async: false,
                    //beforeSend: function () {
                    //    $("#loader").modal("show");
                    //},
                    success: function (res) {

                        $('#RoutingBox').html(res);

                        ClearField();

                        $('#btnRemoveAttachFile').hide();
                        $('#modelRouting_NoOpenIn').val(lastnop);
                        $('#modelRouting_NoOpenOut').val(lastnop);

                        $("#modelRouting_MachineMove").prop('checked', true);
                        $('#modelRouting_Alternative1').prop('disabled', false);
                        $('#modelRouting_Alternative2').prop('disabled', false);

                        $('#modelRouting_WeightIn').val(lastweigth);
                        $('#modelRouting_WeightOut').val(lastweigth);

                        $('#modelRouting_SheetLengthIn').val(lastsheetlout);
                        $('#modelRouting_SheetLengthOut').val(lastsheetlout);
                        $('#modelRouting_SheetWidthIn').val(lastsheetwout);
                        $('#modelRouting_SheetWidthOut').val(lastsheetwout);

                        $('#btnUpdateMachine').css('display', 'none');
                        $('#btnAddMachine').css('display', 'block');
                    },
                    error: function () { $("#loader").modal("hide");}
                });
        }
        //***************************************************  End Manage Button  Insert**************************************

        //***************************************************  Manage Button  Delete**************************************
            // Delete Function
        function DeleteRouting(value)
        {
            swal({
                title: "Are you sure ?",
                text: "ลบข้อมูล !",
                icon: "info",
                buttons: {
                    confirm: "Ok",
                    cancel: true,
                },
                dangerMode: false,
            })
                .then((willDelete) => {
                    if (willDelete)
                    {
                        $('.list-group-item').removeClass('active');
                        ClearDieCutArray();
                        ClearPrintArray();
                        if (value !== '') {
                            lastweigth, lastnop, lastsheetwout, lastsheetlout;

                            lastnop = $('#modelRouting_NoOpenOut').val();
                            lastweigth = $('#modelRouting_WeightOut').val();
                            lastsheetwout = $('#modelRouting_SheetWidthOut').val();
                            lastsheetlout = $('#modelRouting_SheetLengthOut').val();
                                $.ajax({
                                    type: 'POST',
                                    url: '@Url.Action("RoutingDelete", "Report")',
                                    data: { OrderItem: '@Model.OrderSelect' ,Material:'@Model.MaterialNo'  ,seqNo: value },
                                    success: function (res) {

                                        $('#RoutingBox').html(res);

                                        ClearField();

                                        $("#modelRouting_Machine").prop("disabled", false);

                                        $("#modelRouting_MachineMove").prop('checked', true);
                                        $('#modelRouting_Alternative1').prop('disabled', false);
                                        $('#modelRouting_Alternative2').prop('disabled', false);

                                        $('#modelRouting_NoOpenIn').val(lastnop);
                                        $('#modelRouting_NoOpenOut').val(lastnop);

                                        $('#modelRouting_WeightIn').val(lastweigth);
                                        $('#modelRouting_WeightOut').val(lastweigth);

                                        $('#modelRouting_SheetLengthIn').val(lastsheetlout);
                                        $('#modelRouting_SheetLengthOut').val(lastsheetlout);
                                        $('#modelRouting_SheetWidthIn').val(lastsheetwout);
                                        $('#modelRouting_SheetWidthOut').val(lastsheetwout);

                                        $("#btnUpdateMachine").css("display", "none");
                                        $("#btnAddMachine").css("display", "block");

                                        setReadOnly("0");
                                    },
                                    error: function () { }
                                });
                            }
                    }
                });
         }
        //*************************************************** End  Manage Button  Delete**************************************

        //***************************************************  Manage Button  Submit**************************************
        $("#btnSubmit").click(function () {
           // $('#checkStatusBtnEdit').val("")
           // SubmitAfterCheckStatus();
            window.location.href = '@Url.Action("SaleOrder", "Report")'
        });

        function SubmitAfterCheckStatus()
        {
            if ('@Model.PLANTCODE' !== ''  ) {
                checkOutsorcingSubmitRouting();
            }
            else if ('@Model.PlantOs' !== '') {
                checkOutsorcingSubmitRouting();
            } else
            {
                if (checkPresaleMachineList()) {
                    swal("Cannot find Machine in Database!", "", "warning");
                }
                else {
                    checkValidateSubmitRouting();
                }
            }

        }

        function checkOutsorcingSubmitRouting()
        {
             $.ajax({
                 url: '@Url.Action("ValidateOutsorcingBeforeSubmit", "Report")',
                 type: 'post',
                 data: {OrderItem:'@Model.OrderSelect'},
                    async: false,
                    success: function (res) {
                    if (res.Result)
                    {
                        submitRoutingOutsourcingFinal();
                    }
                    else
                    {
                        submitRoutingOutsourcingFinal();
                    }
            },
                error: function () {  }
            });
        }

        function submitRoutingOutsourcingFinal()
        {
            $.ajax({
                    url: '@Url.Action("UpdateAndSavePlantByPlantOS", "NewProduct")',
                    type: 'post',
                        async: false,
                        success: function (res) {
                                if (res.Result)
                                {
                                    window.location.href = '@Url.Action("ProductERPMain", "NewProduct")';
                                }
                                else
                                {
                                    swal("Save  Failed", "", "warning");
                                }

                },
                    error: function () {  }
                });

        }

        //  check คลัง is last seq
        function checkValidateSubmitRouting()
        {
             $.ajax({
                    url: '@Url.Action("CheckValidateSubmitRouting", "Report")',
                 async: false,
                 data: {OrderItem:'@Model.OrderSelect'},
                    success: function (res) {
                    if (res.Result)
                    {
                        submitRoutingFinal();
                    }
                    else
                    {
                        swal("Save  Failed", "", "warning");
                    }
            },
                error: function () {  }
            });
        }

        function submitRoutingFinal()
        {
                        var formData = $('#RoutingForm').serialize();
                        let form = new FormData();
                        form.append("modelToSave", formData);
                        formData
                        $.ajax({
                            type: 'post',
                            dataType: 'json',
                            data: form,
                            cache: false,
                            processData: false,
                            contentType: false,
                            url: '@Url.Action("SaveRouting", "NewProduct")',
                            //beforeSend: function () {
                            //    $("#loader").modal("show");
                            //},
                            success: function (res) {

                                if (res.Result)
                                {
                                    window.location.href = '@Url.Action("ProductERPMain", "NewProduct")';
                                }
                                else
                                {
                                    swal("Save  Failed", "", "warning");
                                }
                            },
                            error: function () { }
                        });
        }
        //***************************************************  End Manage Button  Submit**************************************

        //***************************************************   Manage Button  AttachFile**************************************
        // On RemarkAttachFile Click
        $('#btnRemarkAttachFileUpload').click(function () {
            $('#remarkAttachFile').click();
        });

        // Dialog RemarkAttachFile Show
        $('#remarkAttachFile').change(function () {
            var fileName = $('#remarkAttachFile').prop("files")[0]['name'];
            $('#lblRemarkAttachFileName').text(fileName);
            var form = $('#RoutingForm')[0];
            var data = new FormData(form);
            $.ajax({
                type: 'POST',
                enctype: 'multipart/form-data',
                url: '@Url.Action("SaveImageFileToTemp", "NewProduct")',
                data: data,
                processData: false,
                contentType: false,
                cache: false,
                success: function (res) {
                    $('#btnRemoveAttachFile').show();

                    $('#modelRouting_RemarkAttachFileStatus').val(1);
                },
                error: function () { }
            });
        });

        // Remove RemarkAttachFile
        $('#btnRemoveAttachFile').click(function () {
            $.ajax({
                url: '@Url.Action("RemoveAttachFile", "NewProduct")',
                success: function (res) {
                    $('#remarkAttachFile').val(null);
                    $('#btnRemoveAttachFile').hide();
                    $('#lblRemarkAttachFileName').text("No File Choose");
                    $('#modelRouting_RemarkAttachFileStatus').val(0);
                },
                error: function () { }
            });
        });
        //***************************************************  End Manage Button  AttachFile**************************************

         //***************************************************  Dynamic BlockNo **************************************
        function DiecutGetData() {
        var ArrayDiecut = [];
         $('#DiecutContainer input').each(function (key, value) {
                ArrayDiecut.push(this.value);
        });
        return ArrayDiecut;
         }

        function PrintGetData() {
            var ArrayPrint = [];
            $('#printContrainer input').each(function (key, value) {
                ArrayPrint.push(this.value);
            });
            return ArrayPrint;
        }

         function DiecutBindData(array) {
        var i, text1, text3, text4, text2;
        for (i = 1; i <= array.length; i++) {
                    var nextindex = i;
                    if (i === 4 && i < 5)
                    {
                        text1 = array[i - 4];
                        text2 = array[i - 3];
                        text3 = array[i - 2];
                        text4 = array[i - 1];

                        var total_element = $(".element").length;

                        // last <div> with element class id
                        var lastid = $(".element:last").attr("id");
                        var split_id = lastid.split("_");
                        var nextindex = Number(split_id[1]) + 1;

                        var max = 5;
                        // Check total number elements
                        if (total_element < max) {
                            $(".element:last").after("<div class='element card card-outline-danger text-center' id='div_" + nextindex + "'></div>");
                            $("#div_" + nextindex).append('<span style="text-align:right ; margin-right:10px"><i class="fa fa-times removetag"  id=div_' + nextindex + '></i></span><div class="card-block"> <table class="table table-striped table-bordered"> <thead> </thead><tbody><tr><td>@Localizer["Printing prop9"]</td><td> <input class="form-control" asp-for="modelRouting.CuttingDieNo"  value=' + text1 + '> </td><td>@Localizer["Plant"]</td> <td><input class="form-control" asp-for="modelRouting.CuttingDieNo"  value=' + text2 + '></td></tr><tr> <td>@Localizer["Printing prop10"]</td> <td> <input class="form-control" asp-for="modelRouting.MylaNo"  value=' + text3 + '> </td><td>@Localizer["Plant"]</td><td> <input class="form-control" asp-for="modelRouting.CuttingDieNo" value=' + text4 + '> </td></tr></tbody></table></div>');
                        }
                     }

                    if (i === 8 && i < 9)
                    {
                        text1 = array[i - 4];
                        text2 = array[i - 3];
                        text3 = array[i - 2];
                        text4 = array[i - 1];
                        var total_element = $(".element").length;

                        // last <div> with element class id
                        var lastid = $(".element:last").attr("id");
                        var split_id = lastid.split("_");
                        var nextindex = Number(split_id[1]) + 1;

                        var max = 5;
                        // Check total number elements
                        if (total_element < max) {
                            $(".element:last").after("<div class='element card card-outline-danger text-center' id='div_" + nextindex + "'></div>");
                            $("#div_" + nextindex).append('<span style="text-align:right ; margin-right:10px"><i class="fa fa-times removetag"  id=div_' + nextindex + '></i></span><div class="card-block"> <table class="table table-striped table-bordered"> <thead> </thead><tbody><tr><td>@Localizer["Printing prop9"]</td><td> <input class="form-control" asp-for="modelRouting.CuttingDieNo"  value=' + text1 + '> </td><td>@Localizer["Plant"]</td> <td><input class="form-control" asp-for="modelRouting.CuttingDieNo"  value=' + text2 + '></td></tr><tr> <td>@Localizer["Printing prop10"]</td> <td> <input class="form-control" asp-for="modelRouting.MylaNo"  value=' + text3 + '> </td><td>@Localizer["Plant"]</td><td> <input class="form-control" asp-for="modelRouting.CuttingDieNo" value=' + text4 + '> </td></tr></tbody></table></div>');
                        }
                    }

                    if (i === 12 && i < 13) {
                        text1 = array[i - 4];
                        text2 = array[i - 3];
                        text3 = array[i - 2];
                        text4 = array[i - 1];
                        var total_element = $(".element").length;

                        // last <div> with element class id
                        var lastid = $(".element:last").attr("id");
                        var split_id = lastid.split("_");
                        var nextindex = Number(split_id[1]) + 1;

                        var max = 5;
                        // Check total number elements
                        if (total_element < max) {
                            $(".element:last").after("<div class='element card card-outline-danger text-center' id='div_" + nextindex + "'></div>");
                           $("#div_" + nextindex).append('<span style="text-align:right ; margin-right:10px"><i class="fa fa-times removetag"  id=div_' + nextindex + '></i></span><div class="card-block"> <table class="table table-striped table-bordered"> <thead> </thead><tbody><tr><td>@Localizer["Printing prop9"]</td><td> <input class="form-control" asp-for="modelRouting.CuttingDieNo"  value=' + text1 + '> </td><td>@Localizer["Plant"]</td> <td><input class="form-control" asp-for="modelRouting.CuttingDieNo"  value=' + text2 + '></td></tr><tr> <td>@Localizer["Printing prop10"]</td> <td> <input class="form-control" asp-for="modelRouting.MylaNo"  value=' + text3 + '> </td><td>@Localizer["Plant"]</td><td> <input class="form-control" asp-for="modelRouting.CuttingDieNo" value=' + text4 + '> </td></tr></tbody></table></div>');
                        }
                    }
                    if (i === 16 && i < 17)
                    {
                        text1 = array[i - 4];
                        text2 = array[i - 3];
                        text3 = array[i - 2];
                        text4 = array[i - 1];
                        var total_element = $(".element").length;

                        // last <div> with element class id
                        var lastid = $(".element:last").attr("id");
                        var split_id = lastid.split("_");
                        var nextindex = Number(split_id[1]) + 1;

                        var max = 5;
                        // Check total number elements
                        if (total_element < max) {
                            $(".element:last").after("<div class='element card card-outline-danger text-center' id='div_" + nextindex + "'></div>");
                            $("#div_" + nextindex).append('<span style="text-align:right ; margin-right:10px"><i class="fa fa-times removetag"  id=div_' + nextindex + '></i></span><div class="card-block"> <table class="table table-striped table-bordered"> <thead> </thead><tbody><tr><td>@Localizer["Printing prop9"]</td><td> <input class="form-control" asp-for="modelRouting.CuttingDieNo"  value=' + text1 + '> </td><td>@Localizer["Plant"]</td> <td><input class="form-control" asp-for="modelRouting.CuttingDieNo"  value=' + text2 + '></td></tr><tr> <td>@Localizer["Printing prop10"]</td> <td> <input class="form-control" asp-for="modelRouting.MylaNo"  value=' + text3 + '> </td><td>@Localizer["Plant"]</td><td> <input class="form-control" asp-for="modelRouting.CuttingDieNo" value=' + text4 + '> </td></tr></tbody></table></div>');
                        }
                    }
            }
        }

        function PrintBindData(array) {
        var i, text1, text2;
        for (i = 1; i <= array.length; i++) {
                    var nextindex = i;
                    if (i === 2 && i <3)
                    {
                        text1 = array[i - 2];
                        text2 = array[i-1];
                        $(".element1:last").after("<div class='element1 card card-outline-danger text-center' id='divprint_" + nextindex + "'></div>");
                        $("#divprint_" + nextindex).append('<span style="text-align:right ; margin-right:10px"><i class="fa fa-times removetagprint" id=divprint_' + nextindex + '></i></span> <div class="card-block"> <table class="table table-striped table-bordered"> <thead> </thead> <tbody><tr> <td>@Localizer["Printing prop8"]</td> <td> <input class="form-control" asp-for="modelRouting.PrintingPlateNo" value='+text1+'><span id="modelRouting_PrintingPlateNo-error" class="text-danger" style="display: none;">The PrintingPlateNo field is required.</span> </td><td> @Localizer["Plant"] </td> <td> <input class="form-control" asp-for="modelRouting.PrintingPlateNo" value='+text2+'><span id="modelRouting_PrintingPlateNo-error" class="text-danger" style="display: none;">The PrintingPlateNo field is required.</span> </td></tr> </tbody></table></div>');
                    }

                    if (i === 4 && i <5)
                    {
                        text1 = array[i - 2];
                        text2 = array[i - 1];
                        $(".element1:last").after("<div class='element1 card card-outline-danger text-center' id='divprint_" + nextindex + "'></div>");
                        $("#divprint_" + nextindex).append('<span style="text-align:right ; margin-right:10px"><i class="fa fa-times removetagprint" id=divprint_' + nextindex + '></i></span> <div class="card-block"> <table class="table table-striped table-bordered"> <thead> </thead> <tbody><tr> <td>@Localizer["Printing prop8"]</td> <td> <input class="form-control" asp-for="modelRouting.PrintingPlateNo" value='+text1+'><span id="modelRouting_PrintingPlateNo-error" class="text-danger" style="display: none;">The PrintingPlateNo field is required.</span> </td><td> @Localizer["Plant"] </td> <td> <input class="form-control" asp-for="modelRouting.PrintingPlateNo" value='+text2+'><span id="modelRouting_PrintingPlateNo-error" class="text-danger" style="display: none;">The PrintingPlateNo field is required.</span> </td></tr> </tbody></table></div>');

                    }

                    if (i === 6 && i < 7)
                    {
                        text1 = array[i - 2];
                        text2 = array[i - 1];
                        $(".element1:last").after("<div class='element1 card card-outline-danger text-center' id='divprint_" + nextindex + "'></div>");
                        $("#divprint_" + nextindex).append('<span style="text-align:right ; margin-right:10px"><i class="fa fa-times removetagprint" id=divprint_'+ nextindex + '></i></span> <div class="card-block"> <table class="table table-striped table-bordered"> <thead> </thead> <tbody><tr> <td>@Localizer["Printing prop8"]</td> <td> <input class="form-control" asp-for="modelRouting.PrintingPlateNo" value='+text1+'><span id="modelRouting_PrintingPlateNo-error" class="text-danger" style="display: none;">The PrintingPlateNo field is required.</span> </td><td> @Localizer["Plant"] </td> <td> <input class="form-control" asp-for="modelRouting.PrintingPlateNo" value='+text2+'><span id="modelRouting_PrintingPlateNo-error" class="text-danger" style="display: none;">The PrintingPlateNo field is required.</span> </td></tr> </tbody></table></div>');
                    }

                    if (i === 8 && i < 9)
                    {
                        text1 = array[i - 2];
                        text2 = array[i - 1];
                        $(".element1:last").after("<div class='element1 card card-outline-danger text-center' id='divprint_" + nextindex + "'></div>");
                        $("#divprint_" + nextindex).append('<span style="text-align:right ; margin-right:10px"><i class="fa fa-times removetagprint" id=divprint_' + nextindex + '></i></span> <div class="card-block"> <table class="table table-striped table-bordered"> <thead> </thead> <tbody><tr> <td>@Localizer["Printing prop8"]</td> <td> <input class="form-control" asp-for="modelRouting.PrintingPlateNo" value='+text1+'><span id="modelRouting_PrintingPlateNo-error" class="text-danger" style="display: none;">The PrintingPlateNo field is required.</span> </td><td> @Localizer["Plant"] </td> <td> <input class="form-control" asp-for="modelRouting.PrintingPlateNo" value='+text2+'><span id="modelRouting_PrintingPlateNo-error" class="text-danger" style="display: none;">The PrintingPlateNo field is required.</span> </td></tr> </tbody></table></div>');

                    }
            }
        }

        function ClearPrintArray() {
            var countdiv = $(".element1").length;
            var i;
            arrayid = [];
            for (i = 0; i < countdiv; i++) {
                var idelement = ""
                idelement = document.getElementsByClassName('element1')[i].id;
                arrayid.push(idelement);
            }
            var j;
            for (j = 0; j < arrayid.length; j++) {
                idname = arrayid[j];
                if (idname !== "divprint_1") {
                    $("#" + idname).remove();
                }
            }
        }

        function BindPrintArray(platno2, platplant2, platno3, platplant3, platno4, platplant4, platno5, platplant5) {
            ClearPrintArray();
            var ArrayPrint = [];
            if (platno2 === null && platplant2 === null) {
            }
            else {
                ArrayPrint.push(platno2);
                ArrayPrint.push(platplant2);
            }
            if (platno3 === null && platplant3 === null) {
            }
            else {
                ArrayPrint.push(platno3);
                ArrayPrint.push(platplant3);
            }
            if (platno4 === null && platplant4 === null) {
            }
            else {
                ArrayPrint.push(platno4);
                ArrayPrint.push(platplant4);
            }
            if (platno5 === null && platplant5 === null) {
            }
            else {
                ArrayPrint.push(platno5);
                ArrayPrint.push(platplant5);
            }
            PrintBindData(ArrayPrint);
        }

        function ClearDieCutArray() {
            var countdivcut = $(".element").length;
            var icut;
            arrayidcut = [];
            for (icut = 0; icut < countdivcut; icut++) {
                var idelementcut = ""
                idelementcut = document.getElementsByClassName('element')[icut].id;
                arrayidcut.push(idelementcut);
            }
            var jcut;
            for (jcut = 0; jcut < arrayidcut.length; jcut++) {
                idnamecut = arrayidcut[jcut];
                if (idnamecut !== "div_1") {
                    $("#" + idnamecut).remove();
                }
            }
        }

        function BindDieCutArray(blockno2, blockplant2, mylano2, mylaplant2, blockno3, blockplant3, mylano3, mylaplant3, blockno4, blockplant4, mylano4, mylaplant4, blockno5, blockplant5, mylano5, mylaplant5) {
            ClearDieCutArray();
            var ArrayDieCut = [];
            if (blockno2 === null && blockplant2 === null && mylano2 === null && mylaplant2 === null) {
            }
            else {
                ArrayDieCut.push(blockno2);
                ArrayDieCut.push(blockplant2);
                ArrayDieCut.push(mylano2);
                ArrayDieCut.push(mylaplant2);
            }
            if (blockno3 === null && blockplant3 === null && mylano3 === null && mylaplant3 === null) {
            }
            else {
                ArrayDieCut.push(blockno3);
                ArrayDieCut.push(blockplant3);
                ArrayDieCut.push(mylano3);
                ArrayDieCut.push(mylaplant3);
            }

            if (blockno4 === null && blockplant4 === null && mylano4 === null && mylaplant4 === null) {
            }
            else {
                ArrayDieCut.push(blockno4);
                ArrayDieCut.push(blockplant4);
                ArrayDieCut.push(mylano4);
                ArrayDieCut.push(mylaplant4);
            }

            if (blockno5 === null && blockplant5 === null && mylano5 === null && mylaplant5 === null) {
            }
            else {
                ArrayDieCut.push(blockno5);
                ArrayDieCut.push(blockplant5);
                ArrayDieCut.push(mylano5);
                ArrayDieCut.push(mylaplant5);
            }
            DiecutBindData(ArrayDieCut);
        }
         //***************************************************  End Dynamic BlockNo **************************************

        //***************************************************  Function Check **************************************
        function CheckValidateInk(fieldcolor, ink1, ink2, ink3, ink4, ink5, ink6, ink7, ink8) {
            var countink = 0;
            if (ink1 != "") { countink = countink + 1; }
            if (ink2 != "") { countink = countink + 1; }
            if (ink3 != "") { countink = countink + 1; }
            if (ink4 != "") { countink = countink + 1; }
            if (ink5 != "") { countink = countink + 1; }
            if (ink6 != "") { countink = countink + 1; }
            if (ink7 != "") { countink = countink + 1; }
            if (ink8 != "") { countink = countink + 1; }

            var checkroutingSelect = $('#modelRouting_MachineGroupSelect').val();
            var ischeck = 0;
            if (checkroutingSelect === "2") {
                ischeck = 1;
            }

            if (checkroutingSelect === "3") {
                ischeck = 1;
            }

            if (fieldcolor === countink) {
                return false;
            }
            else {
                return true;
            }

            if (ischeck === 0) {
                return false;
            }
        }

         function CheckMatCodeIsBOM(formgroup)
        {
           // alert(formgroup)
            if (formgroup === "14" || formgroup === "24" || formgroup === "84")
            {
                document.querySelector('#modelRouting_MachineGroupSelect').value = '9';
                document.querySelector('#modelRouting_Machine').value = 'คลัง';
                var countroutinglst = @Model.modelRouting.RoutingDataList.Count() ;
                if (countroutinglst  > 0 )
                {
                   //CheckEnableButtonSaveByCopy();
                }
                else
                {
                    subAddMachine();
                }
            }
        }

       function manage(txt) {
            var bt = document.getElementById('modelRouting_MarginForPaper');
            if (txt.value != '')
            {
                bt.removeAttribute("disabled");
            }
            else
            {
                $("#modelRouting_MarginForPaper").val("");
                bt.setAttribute("disabled", "true");
            }
        }

    // Global Variable
        var lastweigth, lastnop, lastsheetwout, lastsheetlout;

        var seqNoSelect;
        var NoOpenInLast, NoOpenOutLast;
        var weightInLast, weightOutLast;
        var sheetLength, sheetWidth;
        var printerSelect = false;

        // On Page Load
        $(function () {
            var eventFlag = '@Model.EventFlag';
            var weightSheetDefault = '@Model.modelRouting.WeightSheetDefault';

            NoOpenInLast = "1";
            NoOpenOutLast = "1";
            $('#modelRouting_NoOpenIn').val(NoOpenInLast);
            $('#modelRouting_NoOpenOut').val(NoOpenOutLast);

            $('#modelRouting_WeightIn').val(weightSheetDefault);
            $('#modelRouting_WeightOut').val(weightSheetDefault);

            if (eventFlag === "Edit") {
                weightInLast = $('#modelRouting_WeightIn').val();
                weightOutLast = $('#modelRouting_WeightOut').val();
            }

            sheetLength = $('#modelRouting_SheetLengthIn').val();
            sheetWidth = $('#modelRouting_SheetWidthIn').val();

            if (eventFlag === "Edit") {

                lastweigth, lastnop, lastsheetwout, lastsheetlout;

                lastnop = '@Model.modelRouting.NoOpenOut';
                lastweigth = '@Model.modelRouting.WeightOut';
                lastsheetwout ='@Model.modelRouting.SheetWidthOut';
                lastsheetlout = '@Model.modelRouting.SheetLengthOut';

                $('#modelRouting_NoOpenIn').val(lastnop);
                $('#modelRouting_NoOpenOut').val(lastnop);

                $('#modelRouting_WeightIn').val(lastweigth);
                $('#modelRouting_WeightOut').val(lastweigth);

                $('#modelRouting_SheetLengthIn').val(lastsheetlout);
                $('#modelRouting_SheetLengthOut').val(lastsheetlout);
                $('#modelRouting_SheetWidthIn').val(lastsheetwout);
                $('#modelRouting_SheetWidthOut').val(lastsheetwout);

            }

           lastweigth, lastnop, lastsheetwout, lastsheetlout;
            lastnop =  $('#modelRouting_NoOpenOut').val();
            lastweigth = $('#modelRouting_WeightOut').val();
            lastsheetwout = $('#modelRouting_SheetWidthOut').val();
            lastsheetlout = $('#modelRouting_SheetLengthOut').val();

          //  CheckEnableButtonSave();

            // Input Field Number Only
            $(".input-number-only").keydown(function (e) {
                var keyPressed;
                if (!e) var e = window.event;
                if (e.keyCode) keyPressed = e.keyCode;
                else if (e.which) keyPressed = e.which;
                var hasDecimalPoint = (($(this).val().split('.').length - 1) > 0);
                if (keyPressed === 46 || keyPressed === 8 || ((keyPressed === 190 || keyPressed === 110) && (!hasDecimalPoint && !e.shiftKey)) || keyPressed === 9 || keyPressed === 27 || keyPressed === 13 ||
                    // Allow: Ctrl+A
                    (keyPressed === 65 && e.ctrlKey === true) ||
                    // Allow: home, end, left, right
                    (keyPressed >= 35 && keyPressed <= 39)) {
                    // let it happen, don't do anything
                    return;
                }
                else {
                    // Ensure that it is a number and stop the keypress
                    if (e.shiftKey || (keyPressed < 48 || keyPressed > 57) && (keyPressed < 96 || keyPressed > 105)) {
                        e.preventDefault();
                    }
                }

            });
        });

        function checMathCodeEqualMaterialNo() {
            var checkbool = false;
            var mat = '@Model.MaterialNo';
            $.ajax({
                 type: 'POST',
                 url: '@Url.Action("CheckMathDuplicates", "NewProduct")',
                data: { material: mat },
                 async: false,
                 success: function (res) {
                     if (res.CheckData === "1")
                     {
                         checkbool = true;
                     }
                    },
                 error: function () { }
            });

            @*@foreach (var d in Model.modelRouting.RoutingDataList)
            {
                if (@d.JoinToMaterialNo == @Model.MaterialNo) {
                    @:checkbool = true;
                }
                 @:Additivelst.push("@d");
               @:Additivelst[indexcount] = { };
               @:Additivelst[indexcount].Type = "@d.Type";
               @:Additivelst[indexcount].Description = "@d.Description";
               @:indexcount++ ;
            }*@
            return checkbool;
        }

        function CheckValidateCore() {
            var MachineSelect = $('#modelRouting_MachineGroupSelect').val();
            var Machinename = $('#modelRouting_Machine').val();
            var cut = $('#modelRouting_Cut').val();
            var tapeqty = $('#modelRouting_LineQtyPerBox').val();
            if (MachineSelect === "1")
            {
                var checkbool = false;
                 $.ajax({
                     type: 'POST',
                     url: '@Url.Action("CheckCoreConfixTearTapeMax", "NewProduct")',
                     data: { machine: Machinename, cut: cut, line: tapeqty },
                     async: false,
                     success: function (res) {
                         if (res.LineMax === "1")
                         {
                             swal("จำนวนเส้น/กล่อง ต้องไม่เกิน " + res.LineMaxVal, "", "warning");
                         }
                         else
                         {
                             if (res.CheckTearTape === "1")
                             {
                                 $('#modelRouting_Cut').val(res.TearTapeNewCut);
                                   $.ajax({
                                   url: '@Url.Action("CalculateNewCut", "NewProduct")',
                                   type: "POST",
                                   dataType: "json",
                                   data: { cut: $('#modelRouting_Cut').val(), WidthIn: $('#modelRouting_SheetWidthIn').val(), Flut: '@Model.Flute'},
                                   success: function (data) {
                                       if (data.exError === "1") {
                                           $('#modelRouting_PaperRollWidth').val(data.model.PaperRollWidth);
                                           $('#modelRouting_Cut').val(data.model.Cut)
                                           $('#modelRouting_Trim').val(data.model.Trim)
                                           $('#modelRouting_PercentTrim').val(data.model.PercentTrim)
                                       }
                                       else
                                       {
                                           swal("หน้ากว้างกระดาษเกิดความผิดพลาด!", "", "warning");
                                           $('#modelRouting_PaperRollWidth').val("0");
                                           $('#modelRouting_Cut').val("0");
                                           $('#modelRouting_Trim').val("0");
                                           $('#modelRouting_PercentTrim').val("0");

                                       }
                                      }
                                   });

                             }
                         }

                        },
                     error: function () { }
                });
            }
            else
            {
            }
        }

        function ChecTearTapeMaxInCal() {
        var MachineSelect = $('#modelRouting_MachineGroupSelect').val();
        var Machinename = $('#modelRouting_Machine').val();
        var cut = $('#modelRouting_Cut').val();
        var tapeqty = $('#modelRouting_LineQtyPerBox').val();
        var checkbool = false;
        if (MachineSelect === "1")
        {
             $.ajax({
                 type: 'POST',
                 url: '@Url.Action("CheckCoreConfixTearTapeMax", "NewProduct")',
                 data: { machine: Machinename, cut: cut, line: tapeqty },
                 async: false,
                 success: function (res) {
                     if (res.CheckTearTape === "1")
                     {
                         checkbool = true;
                     } else
                     {
                         checkbool = false;
                     }
                    },
                 error: function () { }
            });
            }
            return checkbool;
        }

          function setInOutProperties()
        {
            var openin = $('#modelRouting_NoOpenIn').val();
            var openout = $('#modelRouting_NoOpenOut').val();
                        //คำนวณหา Weight Out
                        if (tmpweigth === null)
                        {
                            tmpweigth = $('#modelRouting_WeightOut').val();
                        }

                        if ($('#modelRouting_MachineGroupSelect').val() === "2") {
                            CheckFinishGood();
                        }
                        else if ((openin > openout) && openout === "1")
                        {
                            CheckFinishGood();
                        }
                        else
                        {
                            if ($('#modelRouting_Machine').val() === "")
                            {
                                $('#modelRouting_WeightOut').val(tmpweigth);
                                tmpweigth = null;
                            }
                            else
                            {
                                    $.ajax({
                                    url: '@Url.Action("GetDataToCondition", "NewProduct")',
                                    type: "POST",
                                    dataType: "json",
                                        data: { machine: $('#modelRouting_Machine').val() },
                                        async: false,
                                        success: function (res) {
                                        //  debugger;
                                        if (openin === "1" && openout === "1" && res.isPropDieCut === 1) {
                                            if ($('#modelRouting_MachineGroupSelect').val() === "3")
                                            {

                                                swal({
                                                    title: "Are you sure ?",
                                                    text: "พิมพ์อย่างเดียวใช่หรือไม่",
                                                    icon: "info",
                                                    buttons: {
                                                        confirm: "Yes",
                                                        cancel: "No",
                                                    },
                                                   // buttons: true,
                                                    dangerMode: false,
                                                })
                                                    .then((alertres) => {
                                                        if (alertres)
                                                        {
                                                            $('#modelRouting_WeightOut').val(tmpweigth);
                                                            tmpweigth = null;
                                                        } else
                                                        {
                                                            CheckFinishGood();
                                                        }
                                                    });

                                            }
                                            else
                                            {
                                                CheckFinishGood();
                                            }

                                        } else
                                        {
                                            $('#modelRouting_WeightOut').val(tmpweigth);
                                            tmpweigth = null;

                                        }
                                    },
                                    error: function () {  }
                                    });
                            }
                         }
        }

        function checkMatchineBeforeAdd() {
            let result = false;
            if ($('#modelRouting_Machine').val() === "") {
                swal("กรุณาเลือก Machine ", "", "warning");
                $('#modelRouting_Machine-error').show()
                result = true;
            } else { result = false }
            return result;
        }

        function disableScoreType(hasval) {
            var bt = document.getElementById('modelRouting_ScoreGap');
            if (hasval) {
                bt.removeAttribute("disabled");
            } else {
                bt.setAttribute("disabled", "true");
            }

        }

        function CheckActiveAltenativeCollapse() {
            if ($('#modelRouting_Alternative4').val() !== "")
            {
                return true;
            }
            else if ($('#modelRouting_Alternative5').val() !== "")
            {
                return true;
            }
            else if ($('#modelRouting_Alternative6').val() !== "")
            {
                return true;
            }
            else if ($('#modelRouting_Alternative7').val() !== "")
            {
                return true;
            }
            else if ($('#modelRouting_Alternative8').val() !== "")
            {
                return true;
            } else
            {
                return false;
            }

        }

        function CheckActiveSpecialPropertyCollapse() {
            if ($('#modelRouting_Speed').val() > 0) { return true; }
            else if ($('#modelRouting_SetupTm').val() > 0) { return true; }
            else if ($('#modelRouting_PrepareTm').val() > 0) { return true; }
            else if ($('#modelRouting_PostTm').val() > 0) { return true; }
            else if ($('#modelRouting_SetupWaste').val() > 0) { return true; }
            else if ($('#modelRouting_RunWaste').val() > 0) { return true; }
            else if ($('#modelRouting_StackHeight').val() > 0) { return true; }
            else if ($('#modelRouting_Totalcolor').val() > 0) { return true; }
            else { return false; }
        }

        function CheckActiveMoreColor() {
            if ($('#modelRouting_Ink5').val() !== "")
            {
                return true;
            }
            else if ($('#modelRouting_Ink6').val() !== "")
            {
                return true;
            }
            else if ($('#modelRouting_Ink7').val() !== "")
            {
                return true;
            }
            else if ($('#modelRouting_Ink8').val() !== "") {
                return true;
            }
            else
            {
                return false;
            }

        }

        function MoveUpDown(value) {
            var seq = $('.list-group').find('.active').data('itemtype');
            $.ajax({
                type: 'POST',
                url: '@Url.Action("RoutingSort", "Report")',
                data: { Material:'@Model.MaterialNo',OrderItem:'@Model.OrderSelect',seqNo: seq, action: value },
                success: function (res) {
                    $('#RoutingBox').html(res);
                    ActiveListRoutingAfterUpDown(seq, value)
                  //  CheckEnableButtonSave();
                },
                error: function () { }
            });
        }

        function ActiveListRoutingAfterUpDown(seq ,action)
        {
            var lstindex = "";
            var countlst = @Model.modelRouting.RoutingDataList.Count() ;
            if (action === "Down")
            {
                if (seq < countlst)
                {
                    seq = seq + 1;
                    lstindex = "#lst_" + seq.toString();
                    $(lstindex).addClass("active");
                }
                else
                {
                    lstindex = "#lst_"+ seq.toString();
                    $(lstindex).addClass("active");
                }
            }
            else
            {
                if (seq > 0)
                {
                    seq = seq - 1;
                    lstindex = "#lst_" + seq.toString();
                    $(lstindex).addClass("active");
                }
                else {
                    lstindex = "#lst_"+ seq.toString();
                    $(lstindex).addClass("active");
                }
            }
        }

        // Copy Function
       function CopyRouting(value) {
           if (value !== '')
           {
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("RoutingCopy", "Report")',
                    data: { seqNo: value,OrderItem:'@Model.OrderSelect',Material:'@Model.MaterialNo' },
                    success: function (res) {
                        $('#RoutingBox').html(res);
                    },
                    error: function () { }
                });
          }
       }

        function CheckPrintingPage(amout)
        {
            let result = false;
            if ($("#modelRouting_MachineGroupSelect").val() === "2")
            {
                if (amout > 0)
                {
                    if ($("#modelRouting_PrintingPlateNo").val() !== "")
                    {
                        result = true
                        $("#modelRouting_PrintingPlateNo-error").hide();
                    }
                    else
                    {
                        $("#modelRouting_PrintingPlateNo-error").show();
                    }
                }
                else
                {
                    result = true;
                }
            }
            else if ($("#modelRouting_MachineGroupSelect").val() === "3")
            {
                if (amout > 0)
                {
                    if ($("#modelRouting_PrintingPlateNo").val() !== "")
                    {
                        result = true
                        $("#modelRouting_PrintingPlateNo-error").hide();
                    } else
                    {
                        $("#modelRouting_PrintingPlateNo-error").show();
                    }
                }
                else
                {
                    result = true;
                }
            }
            else
            {
                result = true
            }
            return result;
        }

        function checkCuttingAndNoout() {
            //ถ้ากรอก cutting die No. แล้ว No Out ต้องเท่ากับ 1 ถ้าไม่เท่ากับ 1 ให้ขึ้นแจ้งเตือน "ควรเลือก No Out เท่ากับ 1" ทุกเครื่องที่ IsPropDiecut = 1 ********************
            var resaltCheckIsprop = false;
                $.ajax({
                    url: '@Url.Action("GetDataToCondition", "NewProduct")',
                    type: "POST",
                    dataType: "json",
                    data: { machine: $('#modelRouting_Machine').val() },
                    success: function (res) {
                        if (res.isPropDieCut === 1)
                        {
                            resaltCheckIsprop = true
                        }
                    },
                    error: function () {  }
            });
            return resaltCheckIsprop;
        }

        function setReadOnly(param) {
            if (param === "1") {
                $("#cardTitle :input").attr("disabled", true);
                $("#cardCalculate :input").attr("disabled", true);
                $("#cardProperty :input").attr("disabled", true);
                $("#cardCorrugator :input").attr("disabled", true);
                $("#btnGetRemark").hide();
                $("#addDieCut").hide();
                $("#ReCalculate").hide();
                $("#addprint").hide();
            }
            else
            {
                $("#cardTitle :input").attr("disabled", false);
                $("#cardCalculate :input").attr("disabled", false);
                $("#cardProperty :input").attr("disabled", false);
                $("#cardCorrugator :input").attr("disabled", false);
                $("#btnGetRemark").show();
                $("#addDieCut").show();
                $("#ReCalculate").show();
                $("#addprint").show();
            }
        }

        function checkSelectShard()
        {
            //#modelRouting_Ink1, #modelRouting_Ink2, #modelRouting_Ink3, #modelRouting_Ink4, #modelRouting_Ink5, #modelRouting_Ink6, #modelRouting_Ink7
            //#modelRouting_Shade1, #modelRouting_Shade2, #modelRouting_Shade3, #modelRouting_Shade4, #modelRouting_Shade5, #modelRouting_Shade6, #modelRouting_Shade7
            if ($('#modelRouting_Ink1').val() !== "")
            {
                if ($('#modelRouting_Shade1').val() === "" || $('#modelRouting_Shade1').val() === "--- Choose here ---" )
                {

                    return true;
                }
            }
            if ($('#modelRouting_Ink2').val() !== "") {
                if ($('#modelRouting_Shade2').val() === "" || $('#modelRouting_Shade2').val() === "--- Choose here ---") {
                    return true;
                }
            }
            if ($('#modelRouting_Ink3').val() !== "") {
                if ($('#modelRouting_Shade3').val() === "" || $('#modelRouting_Shade3').val() === "--- Choose here ---") {
                    return true;
                }
            }
            if ($('#modelRouting_Ink4').val() !== "") {
                if ($('#modelRouting_Shade4').val() === "" || $('#modelRouting_Shade4').val() === "--- Choose here ---") {
                    return true;
                }
            }
            if ($('#modelRouting_Ink5').val() !== "") {
                if ($('#modelRouting_Shade5').val() === "" || $('#modelRouting_Shade5').val() === "--- Choose here ---")  {
                    return true;
                }
            }
            if ($('#modelRouting_Ink6').val() !== "") {
                if ($('#modelRouting_Shade6').val() === "" || $('#modelRouting_Shade6').val() === "--- Choose here ---") {
                    return true;
                }
            }
            if ($('#modelRouting_Ink7').val() !== "") {
                if ($('#modelRouting_Shade7').val() === "" || $('#modelRouting_Shade7').val() === "--- Choose here ---") {
                    return true;
                }
            }
            if ($('#modelRouting_Ink8').val() !== "") {
                if ($('#modelRouting_Shade8').val() === "" || $('#modelRouting_Shade8').val() === "--- Choose here ---") {
                    return true;
                }
            }
            return false;
        }

        function checkPresaleMachineList()
        {
            var result = false;
             $.ajax({
                    type: 'POST',
                 url: '@Url.Action("CheckPresaleRoutingList", "Report")',
                 data: {OrderItem:'@Model.OrderSelect'},
                 async: false,
                 success: function (res) {
                     result = res.Result;
                    },
                    error: function () { }
            });
            return result;
        }

         //*************************************************** End Function Check **************************************

         //*************************************************** Print Function **************************************
        function PrintMastercardMO() {
            let fileUploadName = ""; //$("#file-name").text();
            if (fileUploadName != "") {
                fileUploadName = fileUploadName.split('.')[0];
            }

            var saleOrders = [];

            var saleOrdersTmp = '@Model.OrderSelect';
            saleOrders.push(saleOrdersTmp);
            if (saleOrders.length > 0) {
                var jsonObject = {
                    "OrderItem": saleOrders,
                    "MaterialNo": [],
                    "SizeOfPage": 0,
                    "FileName": fileUploadName,
                    "IsPreview": false //isPreview
                };

                $.ajax({
                    url: '@Url.Action("SetMasterCardMO", "Report")',
                    type: "POST",
                    dataType: "json",
                    data: JSON.stringify(jsonObject),
                    contentType: "application/json; charset=utf-8",
                    success: function (res) {
                        if (res.IsSuccess) {
                            window.open('@Url.Action("MasterCardMO", "Report")', '_blank');
                            return false;
                        } else {
                            //$("#errorMsg").html(res.ErrorMessage);
                            swal(res.ErrorMessage, "", "warning");
                        }
                    },
                    error: function () {
                    }
                });
            }
            else {
                swal("กรุณาเลือก Master Card MO ที่ต้องการพิมพ์", "", "warning");
            }
        }
          //*************************************************** End Print Function **************************************
        function countCharacters() {
            var text = document.getElementById("modelRouting_Remark").value;
            var charCount = text.length;
            document.getElementById("charCount").textContent = charCount + " / 300";
        }
    </script>
 }