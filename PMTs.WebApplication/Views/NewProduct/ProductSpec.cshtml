@{
    Layout = "~/Views/Shared/_LayoutNew.cshtml";
}

@model PMTs.DataAccess.ModelView.NewProduct.TransactionDataModel

@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@*<script src="http://code.jquery.com/jquery-1.9.1.js"></script>*@

@*<script src="http://code.jquery.com/jquery-migrate-3.3.2.js"
    integrity="sha256-BDmtN+79VRrkfamzD16UnAoJP8zMitAz093tvZATdiE="
    crossorigin="anonymous"></script>*@
<div id="ProductSpec" class="card">
    <div class="card-header">
        <div class="row">
            <div class="col-sm-6">
                <h3 class="card-title  text-themecolor">@Localizer["New Product"] </h3>
            </div>
            <div class="col-sm-6 text-right">
                <h3 class="card-title">
                    @Localizer["Material No"] : @Model.MaterialNo
                </h3>
            </div>
        </div> <hr />
    </div>
    <div class="card-body">
        <form id="FormProductSpec" enctype="multipart/form-data">
            <input id="modelProductSpec_DimensionPropertiesImageBase64String" asp-for="modelProductSpec.DimensionPropertiesImageBase64String" type="hidden" />
            @*<form asp-action="SaveProductSpec" asp-controller="NewProduct" id="Spec" method="post" enctype="multipart/form-data" onsubmit="return CheckValidate(this)">*@
            <!-- /.Board Combine -->
            <div class="row" id="BoardProp">
                <div class="col-sm-12">
                    <div class="card">
                        <div class="card-header with-border">
                            <h4 class="card-title">
                                @Localizer["Board Combination Properties"]
                            </h4>
                        </div>
                        <div class="card-body">
                            <div class="col-sm-12">
                                @if (Model.modelCategories.FormGroup != "TCG" && Model.modelCategories.FormGroup != "DIGITAL")
                                {@Html.Partial("_Board", Model)}
                                <input type="hidden" asp-for="modelProductSpec.CutSheetWidInit" />
                                <input type="hidden" asp-for="modelProductSpec.WeightBoxInit" />
                                <input type="hidden" asp-for="modelProductSpec.WeightBoxInit" />
                                <input type="hidden" asp-for="modelProductSpec.FlagRouting" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row" id="Dimension">
                <div class="col-sm-12">
                    <div class="card">
                        <div class="card-header with-border">
                            <h4 class="card-title">
                                @Localizer["Dimension Properties"]
                            </h4>
                        </div>
                        <div class="card-body">

                            <div class="col-sm-12">
                                <div id="Partial" class="row">

                                    @if (Model.modelCategories.RSCStyle == "Rotary")
                                    {@Html.Partial("_DimDC", Model)}
                                else if (Model.modelCategories.FormGroup == "STDRSC")
                                {@Html.Partial("_DimRSC", Model)}
                            else if (Model.modelCategories.FormGroup == "SPCRSC")
                            {@Html.Partial("_DimRSCx", Model)}
                        else if (Model.modelCategories.FormGroup == "STDDC")
                        {@Html.Partial("_DimDC", Model)}
                    else if (Model.modelCategories.FormGroup == "AC")
                    {@Html.Partial("_DimAC", Model)}
                else if (Model.modelCategories.FormGroup == "SF")
                {@Html.Partial("_DimSF", Model)}
            else if (Model.modelCategories.FormGroup == "SB")
            {@Html.Partial("_DimSF", Model)}
        else if (Model.modelCategories.FormGroup == "SS")
        {@Html.Partial("_DimSS", Model)}
    else if (Model.modelCategories.FormGroup == "OFFSETTS")
    {@Html.Partial("_DimOFFTS", Model)}
else if (Model.modelCategories.FormGroup == "PALLET")
{@Html.Partial("_DimPallet", Model)}
else if (Model.modelCategories.FormGroup == "DIGITAL")
{@Html.Partial("_DimTCG", Model)}
else if (Model.modelCategories.FormGroup == "ROLL")
{@Html.Partial("_DimSF", Model)}
else if (Model.modelCategories.FormGroup == "TCG")
{@Html.Partial("_DimTCG", Model)}
else if (Model.modelCategories.FormGroup == "CG")
{@Html.Partial("_DimCG", Model)}
else if (Model.modelCategories.FormGroup == "HC")
{@Html.Partial("_DimHC", Model)}
else if (Model.modelCategories.FormGroup == "HB")
{@Html.Partial("_DimHB", Model)}
else
{@Html.Partial("_DimRSC", Model)}
                                    @*}*@
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-6">
                    <div class="row">
                        <div class="col-sm-5">
                            <button id="btPerf" type="button" class="btn btn-info" data-target="#modal-perf">
                                <span class="btn-label">
                                    <i class="mdi mdi-grease-pencil"></i>
                                </span>@Localizer["Perforate"]
                            </button>
                        </div>
                        <div class="col-sm-10">
                            <div class="modal fade" id="modal-perf">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h4 class="modal-title"><i class="mdi mdi-grease-pencil"></i>@Localizer["Perforate"]</h4>
                                        </div>
                                        <div class="modal-body">
                                            <div class="row">
                                                <div class="col-sm-1">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate Gap"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.PerforateGap" type="text" class="form-control mytextboxNumber">
                                                </div>
                                                <div class="col-sm-5">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-1">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 1"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate1" type="text" class="form-control mytextboxNumber">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 9"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate9" type="text" class="form-control mytextboxNumber">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-1">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 2"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate2" type="text" class="form-control mytextboxNumber">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 10"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate10" type="text" class="form-control mytextboxNumber">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-1">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 3"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate3" type="text" class="form-control mytextboxNumber">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 11"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate11" type="text" class="form-control mytextboxNumber">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-1">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 4"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate4" type="text" class="form-control mytextboxNumber">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 12"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate12" type="text" class="form-control mytextboxNumber">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-1">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 5"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate5" type="text" class="form-control mytextboxNumber">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 13"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate13" type="text" class="form-control mytextboxNumber">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-1">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 6"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate6" type="text" class="form-control mytextboxNumber">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 14"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate14" type="text" class="form-control mytextboxNumber">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-1">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 7"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate7" type="text" class="form-control">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 15"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate15" type="text" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-1">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 8"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate8" type="text" class="form-control">
                                                </div>
                                                <div class="col-sm-2">
                                                    @Localizer["Perforate 16"]
                                                </div>
                                                <div class="col-sm-3">
                                                    <input asp-for="modelProductSpec.Perforate16" type="text" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <button id="closePerf" class="btn btn-danger" type="button">@Localizer["Close"]</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- /.modal-content -->
                                </div>
                                <!-- /.modal-dialog -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6  text-right">
                    <div class="">
                        <button type="button" class="btn btn-success btn-fixsize" id="btnsavespec" tabindex="-1">
                            <i class="fa fa-save"></i> @Localizer["Save"] &amp; @Localizer["Next"] <i class="fa fa-arrow-circle-right"></i>
                            @*<span id="spinSave" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>*@
                        </button>
                        <button class="btn btn-info btn-fixsize" type="button" id="btnNextLoad" disabled>
                            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                            Loading...
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

@section Scripts {

    <script type="text/javascript" src="~/lib/html2canvas/html2canvas.js"></script>
    <script>
    LoadingButton(false);
    var captureCount = 1;
    var slit = $("#modelProductSpec_Slit").val();
    var w = 0, l = 0, h = 0;
    var hbl = 0, hbr = 0, hblx = 0, hbrx = 0;
    var ll = 0, wl = 0, lr = 0, wr = 0;
    var lid = 0, h1 = 0, shWid = 0, shLen = 0;
    var v1 = 0, v2 = 0;
    var display = Array(), paper = Array(), station = Array();
    var width = document.getElementById("modelProductSpec_Wid");
    var length = document.getElementById("modelProductSpec_Leg");
    var height = document.getElementById("modelProductSpec_Hig");
    var sheet = document.getElementById("modelProductSpec_SheetArea");
    var box = document.getElementById("modelProductSpec_BoxArea");
    var sheetw = document.getElementById("modelProductSpec_WeightSh");
    var boxw = document.getElementById("modelProductSpec_WeightBox");
    var basicw = document.getElementById("modelProductSpec_Weight");
    //var la = 0, wa = 0, ha = 0, xa = 0;
    var shWidz = document.getElementById("modelProductSpec_CutSheetWid");
    var shLenz = document.getElementById("modelProductSpec_CutSheetLeng");
    var priorx;
    var sel;
    var sap = '@Model.modelProductSpec.SAPStatus';
    var pic = '@Model.modelProductSpec.PrintMaster';
    var costfield = '@Model.modelProductSpec.costField';
    var Piece2 = @Model.modelProductSpec.Size2Piece;
    var status = '@Model.EventFlag';
     var real = '@Model.RealEventFlag';
    var formGroup = '@Model.modelCategories.FormGroup';
    var isTwoP = '@Model.modelCategories.IsTwoPiece';
    var matType = '@Model.modelCategories.MatCode';
    var rscStyle = '@Model.modelCategories.RSCStyle';
    var unit = '@Model.modelCategories.Id_PU';
    var lv2 = '@Model.modelCategories.HierarchyLV2';
    var lv3 = '@Model.modelCategories.HierarchyLV3';
    var lv4 = '@Model.modelCategories.HierarchyLV4';
    var plant = '@Model.modelProductInfo.PLANTCODE';
    //var highVal = '@Model.modelProductInfo.HighValue';
    var searchBoardAltArr = [];
    var imagedata = "";
    const BoardDataList = @Html.Raw(Json.Serialize(@Model.modelProductSpec.BoardLists));
    const searchBoardAltList = @Html.Raw(Json.Serialize(@Model.modelProductSpec.SearchBoardAltLists));
    const CoatingList = @Html.Raw(Json.Serialize(@Model.modelProductSpec.Coating));
        $(function () {
            // Tassanai Update Detail
            $(".select2").select2();
            $('.mytextboxNumber').keypress(function (evt) {
                var theEvent = evt || window.event;
                // Handle paste
                if (theEvent.type == 'paste') {
                    key = event.clipboardData.getData('text/plain');
                } else {
                    // Handle key press
                    var key = theEvent.keyCode || theEvent.which;
                    key = String.fromCharCode(key);
                }
                var regex = /[0-9]|\./;
                if (!regex.test(key)) {
                    theEvent.returnValue = false;
                    if (theEvent.preventDefault) theEvent.preventDefault();
                }
            });
            //$("#spinSave").hide();

            $('#modelProductSpec_WeightBox').val(parseFloat($('#modelProductSpec_WeightBox').val()).toFixed(3));
            if ($('#modelProductSpec_Hierarchy').val() == "")
                $('#modelProductSpec_Hierarchy').val("03" + lv2.trim() + lv3 + lv4);

            if (formGroup == "DIGITAL" || formGroup == "TCG") {
                $('#BoardProp').hide();
                $('#redReq').hide();
                $('#modelProductSpec_Hierarchy').val(null);
            }
            else {
                $('#updown').hide();
                $("#spin").hide();
                $("#divCG").hide();
                $("#divHoney").hide();

                $('#modelProductSpec_WeightSh').val(parseFloat($('#modelProductSpec_WeightSh').val()).toFixed(3));

                if (plant == "") {
                    $('#modelProductSpec_CostOEM').hide();
                }

                if ($('#modelProductSpec_Code').val() != "") {
                    document.getElementById("btBoardAlt").disabled = false;
                    document.getElementById("btProcess").disabled = false;
                    document.getElementById("btCoating").disabled = false;
                    $('#FlagCode').val(0);
                    //$("#bSearch").autocomplete('search');
                }
                if ($("#modelProductSpec_UnUpgradBoard").val() == "True") {
                    $('#chkUpg').prop('checked', true);
                }

                if ($("#modelProductSpec_TwoPiece").val() == "True") {
                    $('#chkTwoP').prop('checked', true);
                }
                if (formGroup == "AC") {
                    if ($("#modelProductSpec_Wid").val() != 0 && $("#modelProductSpec_Leg").val() != 0) {
                        $("#SheetWid").val($("#modelProductSpec_Wid").val());
                        $("#SheetLeng").val($("#modelProductSpec_Leg").val());
                        //$("#modelProductSpec_Scorew2").val(Math.floor($("#modelProductSpec_CutSheetWid").val() / 2));
                        chkNoSlot();
                        //$("#modelProductSpec_No_Slot").trigger('keyup');
                        $('#lbNoSlot').val($('#modelProductSpec_No_Slot').val());
                        $('#lbSlit').val($('#modelProductSpec_Slit').val());
                    }
                    else {
                        $('#vt7').hide();
                        $('#modelProductSpec_ScoreL9').hide();
                        $('#lbNoSlot').val("1");
                        $('#lbSlit').hide();
                    }
                }
                else if (formGroup == "STDDC" || rscStyle == "Rotary" || formGroup == "PALLET") {
                    if ($("#modelProductSpec_CutSheetWid").val() != 0 && $("#modelProductSpec_CutSheetLeng").val() != 0) {
                        $("#SheetWid").val($("#modelProductSpec_CutSheetWid").val());
                        $("#SheetLeng").val($("#modelProductSpec_CutSheetLeng").val());
                        document.getElementById("chkTwoP").disabled = false;
                        document.getElementById("chkGLwid").disabled = false;
                        //RenderDC();
                    }
                    if ($("#modelProductSpec_GLWid").val() == "True") {
                        $('#chkGLwid').prop('checked', true);
                    }
                }
                else if (formGroup == "SF" || formGroup == "ROLL") {
                    if (unit == 2) {
                        $("#SheetLeng").prop("readonly", true);
                    }
                    else {
                        $("#btEdit").hide();
                        $('#modelProductSpec_Flag').val(1);
                        $("#SheetLeng").prop("readonly", false);
                    }

                    if ($("#modelProductSpec_CutSheetWid").val() != 0 && $("#modelProductSpec_CutSheetLeng").val() != 0) {
                        $("#SheetWid").val($("#modelProductSpec_CutSheetWid").val());
                        $("#SheetLeng").val($("#modelProductSpec_CutSheetLeng").val());

                        $("#dc").show();
                        RenderDC();

                        if (unit == 2) {
                            if ($("#modelProductSpec_WeightSh").val() != 0 && $("#modelProductSpec_WeightSh").val() != 1) {
                                $('#modelProductSpec_Flag').val(1);
                                $("#btEdit").hide();
                                $("#SheetLeng").prop("readonly", false);
                            }
                            else {
                                document.getElementById("btEdit").disabled = false;
                            }
                        }
                    }

                    $("#btCancel").hide();
                    $("#btScoreW").hide();
                    if (formGroup == "ROLL") {
                        $("#dc").hide();
                        $("#roll").show();
                        $("#vdc").hide();
                        $("#hdc1").hide();
                        $("#hdc2").hide();
                        $("#shLendc").hide();
                        $("#shLdc1").hide();
                        $("#shLdc2").hide();
                        $("#modelProductSpec_CutSheetLeng").hide();
                        $("#modelProductSpec_CutSheetWid").hide();
                    }
                }
                else if (formGroup == "SB") {
                    if ($("#modelProductSpec_CutSheetWid").val() != 0 && $("#modelProductSpec_CutSheetLeng").val() != 0) {
                        $("#SheetWid").val($("#modelProductSpec_CutSheetWid").val());
                        $("#SheetLeng").val($("#modelProductSpec_CutSheetLeng").val());
                        document.getElementById("btScoreW").disabled = false;
                        $("#dc").show();

                        //$("#modelProductSpec_ScoreW1").val($("#Scorew1").val());
                        //$("#modelProductSpec_Scorew2").val($("#Scorew2").val());
                        //$("#modelProductSpec_Scorew3").val($("#Scorew3").val());
                        //$("#modelProductSpec_Scorew4").val($("#Scorew4").val());

                        if ($("#modelProductSpec_Scorew4").val() != 0 && $("#modelProductSpec_Scorew4").val() != "") {
                            $('#dc').attr("src", "../images/SB4.jpg");
                            $("#modelProductSpec_ScoreW1").show();
                            $("#modelProductSpec_Scorew2").show();
                            $("#modelProductSpec_Scorew3").show();
                            $("#modelProductSpec_Scorew4").show();
                            $("#modelProductSpec_ScoreW1").css("top", "37px");
                            $("#modelProductSpec_Scorew2").css("top", "87px");
                            $("#modelProductSpec_Scorew3").css("top", "137px");
                            $("#modelProductSpec_Scorew4").css("top", "187px");

                            $("#vsb").show();
                            $("#hsb1").show();
                            $("#hsb2").show();
                        }
                        else if ($("#modelProductSpec_Scorew3").val() != 0 && $("#modelProductSpec_Scorew3").val() != "") {
                            $('#dc').attr("src", "../images/SB3.jpg");
                            $("#modelProductSpec_ScoreW1").show();
                            $("#modelProductSpec_Scorew2").show();
                            $("#modelProductSpec_Scorew3").show();
                            $("#modelProductSpec_Scorew4").hide();
                            $("#modelProductSpec_ScoreW1").css("top", "47px");
                            $("#modelProductSpec_Scorew2").css("top", "112px");
                            $("#modelProductSpec_Scorew3").css("top", "177px");

                            $("#vsb").show();
                            $("#hsb1").show();
                            $("#hsb2").show();
                        }
                        else if ($("#modelProductSpec_Scorew2").val() != 0 && $("#modelProductSpec_Scorew2").val() != "") {
                            $('#dc').attr("src", "../images/SB2.jpg");
                            $("#modelProductSpec_ScoreW1").show();
                            $("#modelProductSpec_Scorew2").show();
                            $("#modelProductSpec_Scorew3").hide();
                            $("#modelProductSpec_Scorew4").hide();
                            $("#modelProductSpec_ScoreW1").css("top", "67px");
                            $("#modelProductSpec_Scorew2").css("top", "165px");

                            $("#vsb").show();
                            $("#hsb1").show();
                            $("#hsb2").show();
                        }
                        else if ($("#modelProductSpec_ScoreW1").val() != 0 && $("#modelProductSpec_ScoreW1").val() != "") {
                            $('#dc').attr("src", "../images/DieCutx.jpg");
                            $("#modelProductSpec_ScoreW1").show();
                            $("#modelProductSpec_Scorew2").hide();
                            $("#modelProductSpec_Scorew3").hide();
                            $("#modelProductSpec_Scorew4").hide();
                            $("#modelProductSpec_ScoreW1").css("top", "114px");

                            $("#vsb").show();
                            $("#hsb1").show();
                            $("#hsb2").show();
                        }
                        else {
                            $('#dc').attr("src", "../images/DieCutx.jpg");
                            $("#modelProductSpec_ScoreW1").hide();
                            $("#modelProductSpec_Scorew2").hide();
                            $("#modelProductSpec_Scorew3").hide();
                            $("#modelProductSpec_Scorew4").hide();

                            $("#vsb").hide();
                            $("#hsb1").hide();
                            $("#hsb2").hide();
                        }
                        RenderDC()
                    }
                    $("#btEdit").hide();
                    $("#btCancel").hide();
                }
                else if (formGroup == "SS") {
                    if ($("#modelProductSpec_CutSheetWid").val() != 0 && $("#modelProductSpec_CutSheetLeng").val() != 0) {
                        $("#SheetWid").val($("#modelProductSpec_CutSheetWid").val());
                        $("#SheetLeng").val($("#modelProductSpec_CutSheetLeng").val());
                        RenderDC();
                    }
                    $("#btEdit").hide();
                    $("#btCancel").hide();
                }
                else if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary") {

                    $("#btCancel").hide();
                    $('#Slit').val($("#modelProductSpec_Slit").val());

                    if ($('#modelProductSpec_Leg').val() != 0 && $('#modelProductSpec_Wid').val() != 0 && $('#modelProductSpec_Hig').val() != 0) {
                        document.getElementById("chkTwoP").disabled = false;
                        document.getElementById("chkGLwid").disabled = false;
                        document.getElementById("chkGLtail").disabled = false;
                        document.getElementById("btDefault").disabled = false;
                        document.getElementById("btScoreW").disabled = false;
                        document.getElementById("btEdit").disabled = false;

                        if ($("#modelProductSpec_Scorew4").val() != 0 || $("#modelProductSpec_Scorew5").val() != 0 || $("#modelProductSpec_Scorew6").val() != 0 || $("#modelProductSpec_Scorew7").val() != 0 || $("#modelProductSpec_Scorew8").val() != 0 || $("#modelProductSpec_Scorew9").val() != 0 || $("#modelProductSpec_Scorew10").val() != 0 || $("#modelProductSpec_Scorew11").val() != 0 || $("#modelProductSpec_Scorew12").val() != 0 || $("#modelProductSpec_Scorew13").val() != 0 || $("#modelProductSpec_Scorew14").val() != 0 || $("#modelProductSpec_Scorew15").val() != 0 || $("#modelProductSpec_Scorew16").val() != 0) {
                            $('#MainPic').hide();
                        }
                        else {

                            $('#MainPic').show();
                            //$('#FilePic').hide();
                            if (real != "Presale") {
                                RenderWid();
                                if ($("#modelProductSpec_TwoPiece").val() == "True" || ($("#modelProductSpec_ScoreL2").val() == 0 && $("#modelProductSpec_ScoreL3").val() == 0) || ($("#modelProductSpec_ScoreL3").val() == 0 && $("#modelProductSpec_ScoreL4").val() == 0) || ($("#modelProductSpec_ScoreL4").val() == 0 && $("#modelProductSpec_ScoreL5").val() == 0)) {
                                    if ($("#modelProductSpec_ScoreL2").val() == 0 && $("#modelProductSpec_ScoreL3").val() == 0) {
                                        $("#modelProductSpec_ScoreL2").val($("#modelProductSpec_ScoreL4").val());
                                        $("#modelProductSpec_ScoreL3").val($("#modelProductSpec_ScoreL5").val());
                                    }
                                    else if ($("#modelProductSpec_ScoreL3").val() == 0 && $("#modelProductSpec_ScoreL4").val() == 0) {
                                        $("#modelProductSpec_ScoreL3").val($("#modelProductSpec_ScoreL5").val());
                                    }
                                    $("#modelProductSpec_ScoreL4").val(0);
                                    $("#modelProductSpec_ScoreL5").val(0);
                                    $("#modelProductSpec_ScoreL7").val(0);
                                    RenderTwoP();
                                }
                            }
                        }

                        if ($("#modelProductSpec_GLWid").val() == "True") {
                            $('#chkGLwid').prop('checked', true);
                        }

                        if ($("#modelProductSpec_GLTail").val() == "True") {
                            $('#chkGLtail').prop('checked', true);
                        }
                        $('#l').val($("#modelProductSpec_Leg").val());
                        $('#w').val($("#modelProductSpec_Wid").val());
                        $('#h').val($("#modelProductSpec_Hig").val());
                        $('#c').val($('#modelProductSpec_Code').val());
                        if (formGroup == "SPCRSC") {
                            $('#modelProductSpec_spcLen').val($("#modelProductSpec_CutSheetLeng").val());
                            $('#x').val($('#modelProductSpec_spcLen').val());
                        }
                    }
                    else {
                        document.getElementById("chkTwoP").disabled = true;
                        document.getElementById("chkGLwid").disabled = true;
                        document.getElementById("chkGLtail").disabled = true;
                        document.getElementById("btDefault").disabled = true;
                        document.getElementById("btScoreW").disabled = true;
                        document.getElementById("btEdit").disabled = true;
                    }
                }
                else if (formGroup == "OFFSETTS") {
                    if ($("#modelProductSpec_CutSheetWid").val() != 0 && $("#modelProductSpec_CutSheetLeng").val() != 0) {
                        $("#SheetWid").val($("#modelProductSpec_CutSheetWid").val());
                        $("#SheetLeng").val($("#modelProductSpec_CutSheetLeng").val());
                    }
                    if ((status == "Create" || status == "Presale") && $("#modelProductSpec_Code").val() == "") {
                        document.getElementById("chkTwoP").disabled = true;
                    }
                    else {
                        document.getElementById("chkTwoP").disabled = false;
                    }
                    $("#modelProductSpec_CutSheetWid").trigger('change');
                    $("#modelProductSpec_CutSheetLeng").trigger('change');
                }
                else if (formGroup == "CG") {
                    $("#divCG").show();

                    if (matType == "82") {
                        //$("#modelProductSpec_SideD").val(5);
                        //$("#modelProductSpec_IsWrap").val("NoWrap");
                        //$("#modelProductSpec_Code").val("CPCP");
                        $("#modelProductSpec_SheetArea").prop("readonly", false);
                        $("#modelProductSpec_BoxArea").prop("readonly", false);
                        $("#modelProductSpec_WeightSh").prop("readonly", false);
                        $("#modelProductSpec_WeightBox").prop("readonly", false);
                    }

                    document.getElementById("chkUpg").disabled = true;
                    $("#modelProductSpec_SideA").trigger('keyup');
                    $("#modelProductSpec_SideB").trigger('keyup');
                    $("#modelProductSpec_SideC").trigger('keyup');
                    $("#modelProductSpec_CutSheetLeng").trigger('keyup');
                    $("#modelProductSpec_SideD").trigger('change');
                    document.getElementById("btBoardAlt").disabled = true;
                    document.getElementById("btCoating").disabled = true;
                    //$("#bSearch").trigger('change');

                    if ($("#modelProductSpec_IsNotch").val() == "True") {
                        $('#chkBak').prop('checked', true);
                        $("#modelProductSpec_CGType").trigger('change');

                        document.getElementById("modelProductSpec_No_Slot").disabled = false;
                        document.getElementById("modelProductSpec_NotchDegree").disabled = false;
                        $("#modelProductSpec_NotchDegree").trigger('change');
                        //document.getElementById("modelProductSpec_NotchDegreex").disabled = false;
                        //document.getElementById("modelProductSpec_NotchArea").disabled = false;

                        if ($("#modelProductSpec_CGType").val() == "L") {
                            $("#NotchSide").show();
                        } else {
                            $("#NotchSide").hide();
                        }
                    }
                    else {
                        $("#modelProductSpec_CGType").trigger('change');
                        $("#NotchSide").hide();
                    }
                }
                else if (formGroup == "HC") {
                    $("#divHoney").show();
                    $("#SheetWid").val($("#modelProductSpec_CutSheetWid").val());
                    document.getElementById("chkUpg").disabled = true;
                    $("#modelProductSpec_Height").trigger('change');
                    $("#modelProductSpec_JoinSize").trigger('change');
                    $("#modelProductSpec_CutSheetLeng").trigger('change');
                    $("#SheetWid").trigger('keyup');
                    document.getElementById("btBoardAlt").disabled = true;
                    document.getElementById("btCoating").disabled = true;
                }
                else if (formGroup == "HB") {
                    $("#divHoney").show();
                    $("#SheetWid").val($("#modelProductSpec_CutSheetWid").val());
                    $("#SheetLen").val($("#modelProductSpec_CutSheetLeng").val());
                    document.getElementById("chkUpg").disabled = true;
                    //$("#modelProductSpec_Height").trigger('change');
                    //$("#modelProductSpec_JoinSize").trigger('change');
                    //$("#modelProductSpec_CutSheetLeng").trigger('change');
                    //$("#SheetWid").trigger('keyup');
                    document.getElementById("btBoardAlt").disabled = true;
                    document.getElementById("btCoating").disabled = true;
                }
                else {
                    $("#modelProductSpec_BoxArea").prop("readonly", false);
                }
            }

            if (isTwoP == "False") {
                $("#lbTwoP").css('opacity', '0');
            }
            if (pic != "") {
                $('#MainPic').hide();
                document.getElementById("PrintMaster").style.color = "transparent";
                $('#RM_Drawing').show();
            }
            else {
                $('#FilePic').hide();
            }

            if (sap == "True") {
                $('#bSearch').prop('disabled', true);
                if ($('#modelProductSpec_CostPerTon').val() != "") {
                    $('#modelProductSpec_CostPerTon').prop('readonly', true);
                }

                if (formGroup == "STDDC" || rscStyle == "Rotary") {
                    $('#modelProductSpec_BoxArea').prop('readonly', true);
                }

                if (formGroup == "TCG") {
                    $('#modelProductSpec_WeightBox').prop('readonly', true);
                }
            }

            if (status == "Edit") {
                var scntDiv = $('#p_scents');
                //document.getElementById("AddStation").disabled = true;
                for (var i = 0; i < CoatingList.length; i++) {

                    scntDiv.append('<tr class="' + CoatingList[i].Station + '"><td>' + CoatingList[i].Station + '</td><td>' + CoatingList[i].Slide + '/' + CoatingList[i].Layer + '</td><td>' + CoatingList[i].Type + '</td> <td>' + CoatingList[i].Name + '</td ></tr > ');

                }
            }
     });

    $("#btCoating").click(function () {
        var ck_flag = '@Model.EventFlag'
        ClearListTbl();
        bindCoating();
    });

        $("#modal-coating").on('hidden', function () {
            $("#modal-coating").modal('hide');
            $(".modal-backdrop").remove();
        });

        $('#save').on("click", function () {
            if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && parseInt($("#sum").val()) != parseInt($("#modelProductSpec_CutSheetWid").val())) {
                //if (formGroup == "SB" && parseInt($("#sum").val()) == 0) {
                //    $('#modal-default').modal('hide');
                //    $('#MainPic').show();
                //}
                //else {
                    swal("Summary of all Score Width must equal Cut Sheet Width", "", "warning");
                //}
            }
            else {
                if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary" ) {
                    if ($("#modelProductSpec_Scorew4").val() != 0 || $("#modelProductSpec_Scorew5").val() != 0 || $("#modelProductSpec_Scorew6").val() != 0 || $("#modelProductSpec_Scorew7").val() != 0 || $("#modelProductSpec_Scorew8").val() != 0 || $("#modelProductSpec_Scorew9").val() != 0 || $("#modelProductSpec_Scorew10").val() != 0 || $("#modelProductSpec_Scorew11").val() != 0 || $("#modelProductSpec_Scorew12").val() != 0 || $("#modelProductSpec_Scorew13").val() != 0 || $("#modelProductSpec_Scorew14").val() != 0 || $("#modelProductSpec_Scorew15").val() != 0 || $("#modelProductSpec_Scorew16").val() != 0) {
                        $('#MainPic').hide();
                    }
                    else {
                        $('#MainPic').show();
                    }
                    if ($("#Scorew1").val() != 0 || $("#Scorew2").val() != 0 || $("#Scorew3").val() != 0) {
                        $("#modelProductSpec_ScoreW1").val($("#Scorew1").val());
                        $("#modelProductSpec_Scorew2").val($("#Scorew2").val());
                        $("#modelProductSpec_Scorew3").val($("#Scorew3").val());
                        RenderWid();
                    }
                }
                else if (formGroup == "SB") {
                    //if ($("#Scorew1").val() != 0 || $("#mScorew2").val() != 0 || $("#Scorew3").val() != 0 || $("#modelProductSpec_Scorew4").val() != 0 || $("#modelProductSpec_Scorew5").val() != 0 || $("#modelProductSpec_Scorew6").val() != 0 || $("#modelProductSpec_Scorew7").val() != 0 || $("#modelProductSpec_Scorew8").val() != 0 || $("#modelProductSpec_Scorew9").val() != 0 || $("#modelProductSpec_Scorew10").val() != 0 || $("#modelProductSpec_Scorew11").val() != 0 || $("#modelProductSpec_Scorew12").val() != 0 || $("#modelProductSpec_Scorew13").val() != 0 || $("#modelProductSpec_Scorew14").val() != 0 || $("#modelProductSpec_Scorew15").val() != 0 || $("#modelProductSpec_Scorew16").val() != 0) {
                    //    $('#MainPic').hide();
                    //}
                    //else {
                    //    $('#MainPic').show();
                    //}
                    $("#SheetWid").val($("#sum").val());
                    $("#modelProductSpec_CutSheetWid").val($("#sum").val());
                    $("#modelProductSpec_ScoreW1").val($("#Scorew1").val());
                    $("#modelProductSpec_Scorew2").val($("#Scorew2").val());
                    $("#modelProductSpec_Scorew3").val($("#Scorew3").val());
                    $("#modelProductSpec_Scorew4").val($("#Scorew4").val());

                    if ($("#modelProductSpec_Scorew4").val() != 0 && $("#modelProductSpec_Scorew4").val() != "") {
                        $('#dc').attr("src", "../images/SB4.jpg");
                        $("#modelProductSpec_ScoreW1").show();
                        $("#modelProductSpec_Scorew2").show();
                        $("#modelProductSpec_Scorew3").show();
                        $("#modelProductSpec_Scorew4").show();
                        $("#modelProductSpec_ScoreW1").css("top", "37px");
                        $("#modelProductSpec_Scorew2").css("top", "87px");
                        $("#modelProductSpec_Scorew3").css("top", "137px");
                        $("#modelProductSpec_Scorew4").css("top", "187px");

                        $("#vsb").show();
                        $("#hsb1").show();
                        $("#hsb2").show();
                    }
                    else if ($("#modelProductSpec_Scorew3").val() != 0 && $("#modelProductSpec_Scorew3").val() != "") {
                        $('#dc').attr("src", "../images/SB3.jpg");
                        $("#modelProductSpec_ScoreW1").show();
                        $("#modelProductSpec_Scorew2").show();
                        $("#modelProductSpec_Scorew3").show();
                        $("#modelProductSpec_Scorew4").hide();
                        $("#modelProductSpec_ScoreW1").css("top", "47px");
                        $("#modelProductSpec_Scorew2").css("top", "112px");
                        $("#modelProductSpec_Scorew3").css("top", "177px");

                        $("#vsb").show();
                        $("#hsb1").show();
                        $("#hsb2").show();
                    }
                    else if ($("#modelProductSpec_Scorew2").val() != 0 && $("#modelProductSpec_Scorew2").val() != "") {
                        $('#dc').attr("src", "../images/SB2.jpg");
                        $("#modelProductSpec_ScoreW1").show();
                        $("#modelProductSpec_Scorew2").show();
                        $("#modelProductSpec_Scorew3").hide();
                        $("#modelProductSpec_Scorew4").hide();
                        $("#modelProductSpec_ScoreW1").css("top", "67px");
                        $("#modelProductSpec_Scorew2").css("top", "165px");

                        $("#vsb").show();
                        $("#hsb1").show();
                        $("#hsb2").show();
                    }
                    else if ($("#modelProductSpec_ScoreW1").val() != 0 && $("#modelProductSpec_ScoreW1").val() != "") {
                        $('#dc').attr("src", "../images/DieCutx.jpg");
                        $("#modelProductSpec_ScoreW1").show();
                        $("#modelProductSpec_Scorew2").hide();
                        $("#modelProductSpec_Scorew3").hide();
                        $("#modelProductSpec_Scorew4").hide();
                        $("#modelProductSpec_ScoreW1").css("top", "114px");

                        $("#vsb").show();
                        $("#hsb1").show();
                        $("#hsb2").show();
                    }
                    else {
                        $('#dc').attr("src", "../images/DieCutx.jpg");
                        $("#modelProductSpec_ScoreW1").hide();
                        $("#modelProductSpec_Scorew2").hide();
                        $("#modelProductSpec_Scorew3").hide();
                        $("#modelProductSpec_Scorew4").hide();

                        $("#vsb").hide();
                        $("#hsb1").hide();
                        $("#hsb2").hide();
                    }
                    RenderDC()
                }
                $('#modal-default').modal('hide');
            }
    });

        $('#close').on("click", function () {
            if (parseInt($("#sum").val()) != parseInt($("#modelProductSpec_CutSheetWid").val())) {
                if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary" ) {
                    $("#Scorew1").val($("#modelProductSpec_ScoreW1").val());
                    $("#Scorew2").val($("#modelProductSpec_Scorew2").val());
                    $("#Scorew3").val($("#modelProductSpec_Scorew3").val());
                }
                else {
                    $("#sum").val(0);
                    $("#Scorew1").val(0);
                    $("#Scorew2").val(0);
                    $("#Scorew3").val(0);
                    $("#modelProductSpec_ScoreW1").val(0);
                    $("#modelProductSpec_Scorew2").val(0);
                    $("#modelProductSpec_Scorew3").val(0);
                }
            }
            $("#modelProductSpec_Scorew4").val(0);
            $("#modelProductSpec_Scorew5").val(0);
            $("#modelProductSpec_Scorew6").val(0);
            $("#modelProductSpec_Scorew7").val(0);
            $("#modelProductSpec_Scorew8").val(0);
            $("#modelProductSpec_Scorew9").val(0);
            $("#modelProductSpec_Scorew10").val(0);
            $("#modelProductSpec_Scorew11").val(0);
            $("#modelProductSpec_Scorew12").val(0);
            $("#modelProductSpec_Scorew13").val(0);
            $("#modelProductSpec_Scorew14").val(0);
            $("#modelProductSpec_Scorew15").val(0);
            $("#modelProductSpec_Scorew16").val(0);
            $('#modal-default').modal('hide');
        });

    $("#btScoreW").click(function () {
        $("#Scorew1").val($("#modelProductSpec_ScoreW1").val());
        $("#Scorew2").val($("#modelProductSpec_Scorew2").val());
        $("#Scorew3").val($("#modelProductSpec_Scorew3").val());
        $("#Scorew4").val($("#modelProductSpec_Scorew4").val());
        //$("#sum").val($("#modelProductSpec_CutSheetWid").val());
        Sum()
        $('#modal-default').modal({ backdrop: 'static', keyboard: false });
        $('#modal-default').modal('show');
        if (formGroup == "SB" && $("#modelProductSpec_ScoreW1").val() == 0) {
            $("#modelProductSpec_ScoreW1").val($("#modelProductSpec_CutSheetWid").val());
        }
    });

    $("#btPerf").click(function () {
        $('#modal-perf').modal({ backdrop: 'static', keyboard: false });
        $('#modal-perf').modal('show');
    });

    $('#closePerf').on("click", function () {
        $('#modal-perf').modal('hide');
    });

    $('#modelProductSpec_CostPerTon').keyup(function () {
        if (formGroup == "TCG" || formGroup == "DIGITAL") {
            document.getElementById("modelProductSpec_CostPerTon").style.borderColor = "LightGray";
        }
        else {
            $('#modelProductSpec_CostPerTon-error').hide();
        }
    });

    $('#modelProductSpec_WeightBox').keyup(function () {
        //$('#modelProductSpec_Weight-error').hide();
        document.getElementById("modelProductSpec_WeightBox").style.borderColor = "LightGray";
        if ((formGroup == "TCG" || formGroup == "DIGITAL") && $(this).val() > 99.999) {
            $('#modelProductSpec_Weight-request').show();
        }
        else {
            $('#modelProductSpec_Weight-request').hide();
        }
        });

    $('#modelProductSpec_WeightBox').change(function () {
        if ($(this).val() > 99.999) {
            swal("SAP can not get FG Weight more than 100 kg.", "", "warning")
        }
    });

    $("#Scorew1").keyup(function () {
        Sum();
    });
    $("#Scorew2").keyup(function () {
        Sum();
    });
    $("#Scorew3").keyup(function () {
        Sum();
    });
    $("#Scorew4").keyup(function () {
        Sum();
    });

    $("#modelProductSpec_Scorew4").keyup(function () {
        Sum();
    });
    $("#modelProductSpec_Scorew5").keyup(function () {
        Sum();
    });
    $("#modelProductSpec_Scorew6").keyup(function () {
        Sum();
    });
    $("#modelProductSpec_Scorew7").keyup(function () {
        Sum();
    });
    $("#modelProductSpec_Scorew8").keyup(function () {
        Sum();
    });
    $("#modelProductSpec_Scorew9").keyup(function () {
        Sum();
    });
    $("#modelProductSpec_Scorew10").keyup(function () {
        Sum();
    });
    $("#modelProductSpec_Scorew11").keyup(function () {
        Sum();
    });
    $("#modelProductSpec_Scorew12").keyup(function () {
        Sum();
    });
    $("#modelProductSpec_Scorew13").keyup(function () {
        Sum();
    });
    $("#modelProductSpec_Scorew14").keyup(function () {
        Sum();
    });
    $("#modelProductSpec_Scorew15").keyup(function () {
        Sum();
    });
    $("#modelProductSpec_Scorew16").keyup(function () {
        Sum();
    });

    $("#chkUpg").click(function () {
        if ($('#chkUpg').is(":checked")) {
            $('#modelProductSpec_UnUpgradBoard').val(true);
        }
        else {
            $('#modelProductSpec_UnUpgradBoard').val(false);
        }
    });

    $("#chkAct").click(function () {
        if ($('#chkAct').is(":checked")) {
            $('#modelProductSpec_Active').val(true);
        }
        else {
            $('#modelProductSpec_Active').val(false);
        }
    });

    $("#chkTwoP").click(function () {
        if ($('#chkTwoP').is(":checked")) {
            $('#modelProductSpec_TwoPiece').val(true);
            if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary")  {
                TwoPiece();
            }
        }
        else {
            $('#modelProductSpec_TwoPiece').val(false);
            if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary")  {
                OnePiece();
            }
        }
        });

    $("#chkGLtail").click(function () {
            if ($('#chkGLtail').is(":checked")) {
                $('#modelProductSpec_GLTail').val(true);
            }
            else {
                $('#modelProductSpec_GLTail').val(false);
            }
        });

    $("#chkGLwid").click(function () {
        if ($('#chkGLwid').is(":checked")) {
                $('#modelProductSpec_GLWid').val('true');
        }
        else {
                $('#modelProductSpec_GLWid').val('false');
        }

        ll = $("#modelProductSpec_ScoreL2").val();
        wl = $("#modelProductSpec_ScoreL3").val();
        lr = $("#modelProductSpec_ScoreL4").val();
        wr = $("#modelProductSpec_ScoreL5").val();
        join = $("#modelProductSpec_JointLap").val();
        slit = $("#modelProductSpec_Slit").val();

        if ($('#chkTwoP').is(":checked")) {
            $("#modelProductSpec_ScoreL2").val(Number(wl) + 3);
            $("#modelProductSpec_ScoreL3").val(Number(ll) - 3);
            $("#modelProductSpec_ScoreL8").val(Number(wl) + 3 + Number(join));
            $("#modelProductSpec_ScoreL9").val(Number(ll) - 3 + Number(slit));
        }
        else {
            $("#modelProductSpec_ScoreL2").val(wl);
            $("#modelProductSpec_ScoreL3").val(ll);
            $("#modelProductSpec_ScoreL4").val(wl);
            $("#modelProductSpec_ScoreL5").val(lr - 3);
        }

        RenderLen();
        });

    $("#chkBak").click(function () {
        if ($('#chkBak').is(":checked")) {
            $('#modelProductSpec_IsNotch').val(true);
            $('#modelProductSpec_No_Slot').val(1);
            document.getElementById("modelProductSpec_No_Slot").disabled = false;
            document.getElementById("modelProductSpec_NotchDegree").disabled = false;
            document.getElementById("modelProductSpec_NotchDegreex").disabled = false;
            document.getElementById("modelProductSpec_NotchArea").disabled = false;
            if ($("#modelProductSpec_CGType").val() == "L") {
                $('#cgLx').show();
                $('#cgUx').hide();
                $("#NotchSide").show();
                $('#BSide').prop('checked', true);
                $('#modelProductSpec_NotchSide').val("B")
                document.getElementById("doubleBak").innerHTML = "";
            } else {
                $('#cgUx').show();
                $('#cgLx').hide();
                $('#cgLa').hide();
                document.getElementById("doubleBak").innerHTML = "คู่";
                $("#NotchSide").hide();
            }
            $('#cgL').hide();
            $('#cgU').hide();
        }
        else {
            document.getElementById("doubleBak").innerHTML = "";
            $('#modelProductSpec_IsNotch').val(false);

            document.getElementById("modelProductSpec_No_Slot").disabled = true;
            document.getElementById("modelProductSpec_NotchDegree").disabled = true;
            document.getElementById("modelProductSpec_NotchDegreex").disabled = true;
            document.getElementById("modelProductSpec_NotchArea").disabled = true;
            $("#modelProductSpec_NotchDegree").val(0);
            $("#modelProductSpec_NotchDegreex").val("");
            $("#modelProductSpec_No_Slot").val("");
            $("#modelProductSpec_NotchArea").val("");
            $("#modelProductSpec_NotchSide").val("");
            $("#NotchSide").hide();
            if ($("#modelProductSpec_CGType").val() == "L") {
                $('#cgL').show();
                $('#cgU').hide();
            } else if ($("#modelProductSpec_CGType").val() == "U") {
                $('#cgU').show();
                $('#cgL').hide();
            }
            $('#cgLx').hide();
            $('#cgLa').hide();
            $('#cgUx').hide();
        }
        $('#cgB').hide();
    });

    $("#btProcess").click(function () {
        event.preventDefault();
        $("#spin").show();
        CalculateAreaAndWeightOfRSC();
        $("#spin").hide();
    });

    $('#modelProductSpec_Leg').keyup(function () {
        $("#modelProductSpec_Leg-error").hide();
        if (formGroup == "AC") {
            $("#SheetLeng").val($("#modelProductSpec_Leg").val());
            if ($("#modelProductSpec_Wid").val() > 0 && $("#modelProductSpec_Leg").val() > 0)
                chkNoSlot();
        }
    });
    $('#modelProductSpec_Wid').keyup(function () {
        $("#modelProductSpec_Width-error").hide();
        if (formGroup == "AC") {
            $("#SheetWid").val($("#modelProductSpec_Wid").val());
            $("#modelProductSpec_Scorew16").val(Math.round($("#modelProductSpec_Wid").val()/2));
            if ($("#modelProductSpec_Wid").val() > 0 && $("#modelProductSpec_Leg").val() > 0)
                chkNoSlot();
        }
    });
    $('#modelProductSpec_Hig').keyup(function () {
        $("#modelProductSpec_Hig-error").hide();
    });

    $("#btDefault").click(function () {
        event.preventDefault();

        $('#xTop').show();
        $('#xButton').show();
        document.getElementById("chkTwoP").disabled = false;
        document.getElementById("chkGLwid").disabled = false;
        document.getElementById("chkGLtail").disabled = false;
        $('#chkTwoP').prop('checked', false);
        $('#modelProductSpec_TwoPiece').val(false);
        $('#chkGLwid').prop('checked', false);
        $('#modelProductSpec_GLWid').val(false);
        $('#chkGLtail').prop('checked', false);
        $('#modelProductSpec_GLTail').val(false);
        Render();
    });

    $("#btBoardAlt").click(function () {

        var form = document.getElementById("alt");
        form.style.display = "block";

        //Criteria List Search Board Alt
        searchBoardAltArr = [];
        $('#BoardCodeAlt').empty();

        $.each(searchBoardAltList, function (key, object) {
            if (object.Flute == $("#modelProductSpec_Flute").val()) {
                searchBoardAltArr.push({ "Code": object.Code, "Board": object.Board, "SearchBoard": object.SearchBoard });
                $('#BoardCodeAlt').append($("<option></option>").attr("value", object.Code).text(object.SearchBoard));
            }
        });

        $("#BoardCodeAlt").val($("#modelProductSpec_Code").val());
        $("#FluteAlt").val($("#modelProductSpec_Flute").val());
        document.getElementById("BoardNameAlt").innerHTML = $("#modelProductSpec_Board").val();

        GenBoardSpec();

        $.ajax({
            url: "ShowBoardAlt",
            success: function (data) {
                $("#tbBoardAlt").html(data);
                //document.getElementById("btRemove").disabled = false;
            }
        });
    });

    $("#btOK").click(function () {
        GenBoardSpec();
    });

    $("#btEdit").click(function () {
        if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary")  {
            $("#modelProductSpec_BoxArea").prop("readonly", false);
            $("#oldVal").val($("#modelProductSpec_BoxArea").val());
        }
        else {
            $("#SheetLeng").prop("readonly", false);
            $("#oldVal").val($("#SheetLeng").val());
            RenderDC();
        }

        $("#btEdit").hide();
        $("#btCancel").show();
        $("#modelProductSpec_Flag").val(1);
    });

    $("#btCancel").click(function () {
        if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary") {
            $("#modelProductSpec_BoxArea").prop("readonly", true);
            $("#modelProductSpec_BoxArea").val($("#oldVal").val());
        }
        else {
            $("#SheetLeng").prop("readonly", true);
            $("#SheetLeng").val($("#oldVal").val());
            $("#modelProductSpec_CutSheetLeng").val($("#oldVal").val());
            RenderDC();
        }
        $("#btEdit").show();
        $("#btCancel").hide();
        $("#modelProductSpec_Flag").val(0);
    });

    $("#btAdd").click(function () {
        var prior = $("#modelProductSpec_Priority").val();
        if (prior == "" || prior == "undefined" || prior == "0") {
            swal("Please fill Priority", "", "warning");
            }
            else {
                if ($('#modelProductSpec_stt1').is(':visible')) {
                    $.ajax({
                        url: "ChkPriority",
                        type: "POST",
                        data: { Board: $("#modelProductSpec_Board").val(), Priority: prior, GL: $("#GL").val(), BM: $("#BM").val(), BL: $("#BL").val(), CM: $("#CM").val(), CL: $("#CL").val(), DM: $("#DM").val(), DL: $("#DL").val() },
                        success:
                            function (data) {
                                var a = 0;
                                $.each(data, function (i, item) {
                                    display[a] = item;
                                    a++;
                                });
                                a = display[0];

                                if (a == 99) {
                                    swal("Duplicated-Priority or Board!", "", "warning");
                                    //modalDialog(warning, DupPriority);
                                }
                                else if (a == 100) {
                                    swal("Duplicated Board Alternative", "", "warning");
                                    //modalDialog(warning, DupBoardAlt);
                                }
                                else {
                                    $.ajax({
                                        url: "AddBoardAlt",
                                        data: { Priority: prior, Active: $("#modelProductSpec_Active").val(), Flute: $("#modelProductSpec_Flute").val(), GL: $("#GL").val(), BM: $("#BM").val(), BL: $("#BL").val(), CM: $("#CM").val(), CL: $("#CL").val(), DM: $("#DM").val(), DL: $("#DL").val(), stt1: $("#modelProductSpec_stt1").val(), stt2: $("#modelProductSpec_stt2").val(), stt3: $("#modelProductSpec_stt3").val(), stt4: $("#modelProductSpec_stt4").val(), stt5: $("#modelProductSpec_stt5").val(), stt6: $("#modelProductSpec_stt6").val(), stt7: $("#modelProductSpec_stt7").val() },
                                        success: function (data) {
                                            $("#tbBoardAlt").html(data);
                                            document.getElementById("btRemove").disabled = true;
                                        }
                                    })

                                    $("#modelProductSpec_Priority").val(a);
                                }
                            }
                    });
                }
                else
                    swal("Please press OK before press Add", "", "warning");
                    //modalDialog(warning, OKButton);
            }

        });

    $("#btRemove").click(function () {

            $.ajax({
                url: "RemoveBoardAlt",
                data: { prior: priorx },
                success:
                    function (data) {
                        $("#tbBoardAlt").html(data);
                        document.getElementById("btRemove").disabled = true;
                    },
                messages: {
                    results: function (resultsCount) { },
                    noResults: ""
                }
            });

    });

    $("#modelProductSpec_JointLap").keyup(function () {
        join = $("#modelProductSpec_JointLap").val();
        hblx = $("#modelProductSpec_ScoreL6").val();
        hbrx = $("#modelProductSpec_ScoreL7").val();
        slit = $("#modelProductSpec_Slit").val();
        //lr = $("#modelProductSpec_ScoreL4").val();
        ll = $("#modelProductSpec_ScoreL2").val();
        hbr = $("#modelProductSpec_ScoreL9").val();

        if ($('#chkTwoP').is(":checked")) {
            hbl = Number(ll) + Number(join);
        }
        else {
            hbl = Number(hblx) + Number(join);
        }

            shLen = Number(hbl) + Number(hbr);
        $("#modelProductSpec_ScoreL8").val(hbl);
        $("#modelProductSpec_CutSheetLeng").val(shLen);
    });

    $("#modelProductSpec_ScoreL2").keyup(function () {
        ll = $("#modelProductSpec_ScoreL2").val();
        wl = $("#modelProductSpec_ScoreL3").val();
        join = $("#modelProductSpec_JointLap").val();

        //$("#modelProductSpec_ScoreL4").val(ll);
        lr = $("#modelProductSpec_ScoreL4").val();
        wr = $("#modelProductSpec_ScoreL5").val();
        slit = $("#modelProductSpec_Slit").val();

        hblx = Number(ll) + Number(wl);
        $("#modelProductSpec_ScoreL6").val(hblx);
        hbrx = Number(lr) + Number(wr);
        $("#modelProductSpec_ScoreL7").val(hbrx);

        if (lr == 0 && wr == 0) {
            hbl = Number(ll) + Number(join);
            hbr = Number(wl) + Number(slit);
        }
        else {
            hbl = Number(hblx) + Number(join);
            hbr = Number(hbrx) + Number(slit);
        }

        var fixval = 150;

        if (hbrx == 0) {
            fixval = 300;
        }

        if (ll / hblx > 0.15 && ll / hblx < 0.85) {
            document.getElementById("lLx1").width = fixval * ll / hblx;
            document.getElementById("lLb").width = fixval * ll / hblx;
            document.getElementById("lLx2").width = fixval * ll / hblx;
            document.getElementById("wLx1").width = fixval * wl / hblx;
            document.getElementById("wLb").width = fixval * wl / hblx;
            document.getElementById("wLx2").width = fixval * wl / hblx;
            v1 = 32 + (fixval * ll / hblx);
            v2 = 180 + (fixval * lr / hbrx);
            document.getElementById("v1").style.left = v1 + "px";
            if (lr == 0) {
                document.getElementById("v2").style.left = v1 + "px";
            }
            else {
                document.getElementById("v2").style.left = v2 + "px";
            }
        }

        $("#modelProductSpec_ScoreL8").val(hbl);
        $("#modelProductSpec_ScoreL9").val(hbr);
        shLenz.value = Number(hbl) + Number(hbr);
    });

    $("#modelProductSpec_ScoreL3").keyup(function () {
        ll = $("#modelProductSpec_ScoreL2").val();
        wl = $("#modelProductSpec_ScoreL3").val();
        join = $("#modelProductSpec_JointLap").val();
        slit = $("#modelProductSpec_Slit").val();
        lr = $("#modelProductSpec_ScoreL4").val();
        $("#modelProductSpec_ScoreL5").val(wl - 3);
        wr = $("#modelProductSpec_ScoreL5").val();

        hblx = Number(ll) + Number(wl);
        $("#modelProductSpec_ScoreL6").val(hblx);
        hbrx = Number(lr) + Number(wr);
        $("#modelProductSpec_ScoreL7").val(hbrx);

        if (lr  ==  0) {
            hbl = Number(ll) + Number(join);
            hbr = Number(wl) + Number(slit);
        }
        else {
            hbl = Number(hblx) + Number(join);
            hbr = Number(hbrx) + Number(slit);
        }

        var fixval = 150;

        if (lr == 0) {
            fixval = 300;
        }

        if (wl / hblx > 0.15 && wl / hblx < 0.85) {
            document.getElementById("lLx1").width = fixval * ll / hblx;
            document.getElementById("lLb").width = fixval * ll / hblx;
            document.getElementById("lLx2").width = fixval * ll / hblx;
            document.getElementById("wLx1").width = fixval * wl / hblx;
            document.getElementById("wLb").width = fixval * wl / hblx;
            document.getElementById("wLx2").width = fixval * wl / hblx;
            v1 = 32 + (fixval * ll / hblx);
            v2 = 180 + (fixval * lr / hbrx);
            document.getElementById("v1").style.left = v1 + "px";
            if (lr == 0) {
                document.getElementById("v2").style.left = v1 + "px";
            }
            else {
                document.getElementById("v2").style.left = v2 + "px";
            }
        }

        $("#modelProductSpec_ScoreL8").val(hbl);
        $("#modelProductSpec_ScoreL9").val(hbr);
        shLenz.value = Number(hbl) + Number(hbr);

    });

    $("#modelProductSpec_ScoreL4").keyup(function () {
            lr = $("#modelProductSpec_ScoreL4").val();
            wr = $("#modelProductSpec_ScoreL5").val();

            hbrx = Number(lr) + Number(wr);
            $("#modelProductSpec_ScoreL7").val(hbrx);
            slit = $("#modelProductSpec_Slit").val();

            if (lr / hbrx > 0.15 && lr / hbrx < 0.85) {
                document.getElementById("lRx1").width = 150 * lr / hbrx;
                document.getElementById("lRb").width = 150 * lr / hbrx;
                document.getElementById("lRx2").width = 150 * lr / hbrx;
                document.getElementById("wRx1").width = 150 * wr / hbrx;
                document.getElementById("wRb").width = 150 * wr / hbrx;
                document.getElementById("wRx2").width = 150 * wr / hbrx;

                v2 = 206 + (150 * lr / hbrx);
                document.getElementById("v2").style.left = v2 + "px";
            }

            hbr = Number(hbrx) + Number(slit);
            $("#modelProductSpec_ScoreL9").val(hbr);

            hbl = $("#modelProductSpec_ScoreL8").val();
        shLenz.value = Number(hbl) + Number(hbr);
        });

    $("#modelProductSpec_ScoreL5").keyup(function () {
            lr = $("#modelProductSpec_ScoreL4").val();
            wr = $("#modelProductSpec_ScoreL5").val();
            slit = $("#modelProductSpec_Slit").val();

            hbrx = Number(lr) + Number(wr);
            $("#modelProductSpec_ScoreL7").val(hbrx);

            if (wr / hbrx > 0.15 && wr / hbrx < 0.85) {
                document.getElementById("lRx1").width = 150 * lr / hbrx;
                document.getElementById("lRb").width = 150 * lr / hbrx;
                document.getElementById("lRx2").width = 150 * lr / hbrx;
                document.getElementById("wRx1").width = 150 * wr / hbrx;
                document.getElementById("wRb").width = 150 * wr / hbrx;
                document.getElementById("wRx2").width = 150 * wr / hbrx;

                v2 = 206 + (150 * lr / hbrx);
                document.getElementById("v2").style.left = v2 + "px";
            }

            hbr = Number(hbrx) + Number(slit);
            $("#modelProductSpec_ScoreL9").val(hbr);

            hbl = $("#modelProductSpec_ScoreL8").val();
        shLenz.value = Number(hbl) + Number(hbr);
    });

    $("#modelProductSpec_Slit").keyup(function () {
            slit = $("#modelProductSpec_Slit").val();
            hbrx = $("#modelProductSpec_ScoreL7").val();
            lr = $("#modelProductSpec_ScoreL4").val();
            wl = $("#modelProductSpec_ScoreL3").val();
            hbl = $("#modelProductSpec_ScoreL8").val();

        if (formGroup == "AC") {
            if ($('#modelProductSpec_Slit').val() > 0) {
                $('#lbSlit').show();
                $('#lbSlit').val($('#modelProductSpec_Slit').val());
            }
            BindTeeth();
        }
        else if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary") {
            if ($('#chkTwoP').is(":checked")) {
                hbr = Number(wl) + Number(slit);
            }
            else {
                hbr = Number(hbrx) + Number(slit);
            }

            shLenz.value = Number(hbl) + Number(hbr);
            $("#modelProductSpec_ScoreL9").val(hbr);
        }
    });

    var h2 = 0;
    var h3 = 0;
    $("#modelProductSpec_ScoreW1").keyup(function () {
        Sum();
        if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary") {
            lid1 = $("#modelProductSpec_ScoreW1").val();
            h1 = $("#modelProductSpec_Scorew2").val();
            lid2 = $("#modelProductSpec_Scorew3").val();

            shWidz.value = Number(lid1) + Number(h1) + Number(lid2);
            shWid = shWidz.value;

            if ((lid1 / shWid > 0.15 && lid1 / shWid < 0.7) || lid1 == 0 || lid1 == "") {
                    if (lid1 == "" || lid1 == 0) {
                        $('#xTop').hide();
                    }
                    else {
                        $('#xTop').show();
                    }
                    RenderWid();
                }
            }
        });

    $("#modelProductSpec_Scorew2").keyup(function () {
        Sum();
        if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary") {
            lid1 = $("#modelProductSpec_ScoreW1").val();
            h1 = $("#modelProductSpec_Scorew2").val();
            lid2 = $("#modelProductSpec_Scorew3").val();

            shWidz.value = Number(lid1) + Number(h1) + Number(lid2);
            shWid = shWidz.value;

            if (h1 / shWid > 0.15 && h1 / shWid < 0.75) {
                RenderWid();
            }
        }
    });

    $("#modelProductSpec_Scorew3").keyup(function () {
        Sum();
        if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary") {
                lid1 = $("#modelProductSpec_ScoreW1").val();
                h1 = $("#modelProductSpec_Scorew2").val();
                lid2 = $("#modelProductSpec_Scorew3").val();
                c = $("#modelProductSpec_C").val();

                shWidz.value = Number(lid1) + Number(h1) + Number(lid2);
                shWid = shWidz.value;

            if ((lid2 / shWid > 0.15 && lid2 / shWid < 0.7) || lid2 == 0 || lid2 == "") {
                    if (lid2 == 0) {
                        $('#xButton').hide();
                    }
                    else {
                        $('#xButton').show();
                    }
                    RenderWid();
                }
            }
    });

        var dcWid = 0;
        var winch = 0, linch = 0, inch = 0;
    var dec = 0;

    $('#SheetWid').keyup(function () {
        $("#modelProductSpec_SheetWid-error").hide();
        shWid = $("#SheetWid").val();
        shLen = $("#SheetLeng").val();
        $("#modelProductSpec_CutSheetWid").val(shWid);

        if ($(this).val() < 10000) {
            //$('#modelProductSpec_SheetWid-request').hide();
            if (formGroup == "SF" || formGroup == "SB" || formGroup == "SS" || formGroup == "OFFSETTS") {
                if (shLen != "") {
                    RenderDC();
                }
            }
            else if (formGroup == "AC") {
                //$("#modelProductSpec_Scorew2").val(Math.floor(shWid / 2));
                if ($("#SheetWid").val() > 0 && $("#SheetLeng").val() > 0)
                    chkNoSlot();
            }
            else if (formGroup == "HC") {
                if ($('#SheetWid').val() == 0) {
                    $('#modelProductSpec_CutSheetWid').hide();
                } else {
                    $('#modelProductSpec_CutSheetWid').show();
                }
            }

            $("#modelProductSpec_CutSheetWid").trigger('change');
        }
    });

    $('#SheetLeng').keyup(function () {

        $("#modelProductSpec_SheetLeng-error").hide();
        shLen = $("#SheetLeng").val();
        $("#modelProductSpec_CutSheetLeng").val(shLen);
        if ($(this).val() < 10000) {
            if (formGroup == "SF" || formGroup == "SB" || formGroup == "SS" || formGroup == "OFFSETTS") {
                RenderDC();
            }
            else if (formGroup == "AC") {
                if ($("#SheetWid").val() > 0 && $("#SheetLeng").val() > 0)
                    chkNoSlot();
            }

            $("#modelProductSpec_CutSheetLeng").trigger('change');
        }

     });

    $('#modelProductSpec_CutSheetWid').change(function () {
        if (formGroup == "OFFSETTS") {
            shWid = $('#modelProductSpec_CutSheetWid').val();
            winch = shWid / 25.4;
            dec = Math.floor((winch - Math.floor(winch)) * 100);
            if (dec >= 0 && dec <= 12)
                dec = 0;
            else if (dec >= 13 && dec <= 37)
                dec = 0.25;
            else if (dec >= 38 && dec <= 62)
                dec = 0.50;
            else if (dec >= 63 && dec <= 87)
                dec = 0.75;
            else
                dec = 1;

            inch = Math.floor(winch) + dec;
            $("#modelProductSpec_CutSheetWidInch").val(inch.toFixed(2));
        }
        });

    $('#modelProductSpec_CutSheetLeng').change(function () {
        if (formGroup == "OFFSETTS") {
            shLen = $('#modelProductSpec_CutSheetLeng').val();
            linch = shLen / 25.4;
            dec = Math.floor((linch - Math.floor(linch)) * 100);
            if (dec >= 0 && dec <= 12)
                dec = 0;
            else if (dec >= 13 && dec <= 37)
                dec = 0.25;
            else if (dec >= 38 && dec <= 62)
                dec = 0.50;
            else if (dec >= 63 && dec <= 87)
                dec = 0.75;
            else
                dec = 1;

            inch = Math.floor(linch) + dec;
            $("#modelProductSpec_CutSheetLengInch").val(inch.toFixed(2));
        }
        else if (formGroup == "HC") {
            if ($('#modelProductSpec_CutSheetLeng').val() == 0) {
                $('#ll').hide();
            } else {
                $('#ll').show();
                $('#ll').val($("#modelProductSpec_CutSheetLeng").val());
            }
        }
        });

        $('#modelProductSpec_CutSheetLeng').keyup(function () {
            if (formGroup == "CG") {
                if ($('#modelProductSpec_CutSheetLeng').val() == 0) {
                    $('#ll').hide();
                } else {
                    $('#ll').show();
                    $('#ll').val("L: " + $("#modelProductSpec_CutSheetLeng").val());
                }
            }
            else if (formGroup == "HB") {
                if ($('#modelProductSpec_CutSheetLeng').val() == 0) {
                    $('#lbLen').hide();
                } else {
                    $('#lbLen').show();
                    $('#lbLen').val($("#modelProductSpec_CutSheetLeng").val());
                }
            }
    });

    $('#modelProductSpec_CutSheetWid').keyup(function () {
        if (formGroup == "HB") {
            if ($('#modelProductSpec_CutSheetWid').val() == 0) {
                $('#lbWid').hide();
            } else {
                $('#lbWid').show();
                $('#lbWid').val($("#modelProductSpec_CutSheetWid").val());
            }
        }
    });

    $('#modelProductSpec_CutSheetWidInch').keyup(function () {
            inch = $("#modelProductSpec_CutSheetWidInch").val();
            shWid = Math.round(inch * 25.4);
            $('#SheetWid').val(shWid);
        });

    $('#modelProductSpec_CutSheetLengInch').keyup(function () {
            inch = $("#modelProductSpec_CutSheetLengInch").val();
            shLen = Math.round(inch * 25.4);
            $('#SheetLeng').val(shLen);
        });

    $('#modelProductSpec_No_Slot').keyup(function () {
        if (formGroup == "AC") {
            if ($('#modelProductSpec_No_Slot').val() > 0) {
                chkNoSlot();
                $("#modelProductSpec_NoSlot-error").hide();
                //$('#lbNoSlot').show();
                $('#lbNoSlot').val($('#modelProductSpec_No_Slot').val());
            }
            else {
                $("#modelProductSpec_NoSlot-error").show();
               // $('#lbNoSlot').hide();
            }
        }
        else if (formGroup == "CG") {
            if ($("#modelProductSpec_No_Slot").val() > 1) {
                $('#MainPic').hide();
            } else {
                $('#MainPic').show();
            }
        }
    });

    $("#btnMoveUp, #btnMoveDown").click(function () {
            $.ajax({
                type: "POST",
                url: "SortBoardAlt",
                data: { seqNo: priorx, action: $(this).val() },
                success: function (res) {
                    $('#tbBoardAlt').html(res);
                },
            error: function () { }
            });
        });

    $('#modelProductSpec_NotchDegree').change(function () {
        if ($('#modelProductSpec_NotchDegree').val() == "0") {
            //$('#modelProductSpec_NotchDegreex').show();
            document.getElementById("modelProductSpec_NotchDegreex").disabled = false;
            document.getElementById("modelProductSpec_NotchArea").disabled = false;
        }
        else {
            //$('#modelProductSpec_NotchDegreex').hide();
            document.getElementById("modelProductSpec_NotchDegreex").disabled = true;
            document.getElementById("modelProductSpec_NotchArea").disabled = true;
            $("#modelProductSpec_NotchDegreex").val("");
            document.getElementById("modelProductSpec_NotchDegreex").style.borderColor = "LightGray";
        }
        });

    $("#ASide").click(function () {
        $('#modelProductSpec_NotchSide').val("A");
        $('#cgLx').hide();
        $('#cgLa').show();
    });

    $("#BSide").click(function () {
        $('#modelProductSpec_NotchSide').val("B");
        $('#cgLx').show();
        $('#cgLa').hide();
    });

    $("#BoardCodeAlt").change(function () {
        var code = $(this).val();
        for (var i = 0; i < searchBoardAltArr.length; i++) {
            if (searchBoardAltArr[i].Code == code) {
                document.getElementById("BoardNameAlt").innerHTML = searchBoardAltArr[i].Board;
                GenBoardSpec();
                break;
            }
        }
    });
        var BoardAutoCompleteData = $.map(BoardDataList, function (item) {
            return {
                label: item.Code + " " + item.Flute + " " + item.BoardCombine1,
                value: item.Code,
                board: item.BoardCombine1,
            }
        });
    $("#bSearch").autocomplete({
        minLength: 2,
        maxShowItems: 10,
        source: BoardAutoCompleteData,
        select: function (event, ui) {
            event.preventDefault();
            $("#bSearch").val(ui.item.label);
            for (var i = 0; i < BoardDataList.length; i++) {
                if (BoardDataList[i].Code == ui.item.value) {
                    $.ajax({
                        url: "GetBoard",
                        type: "POST",
                        dataType: "json",
                        data: { Code: BoardDataList[i].Code, Code1: $('#modelProductSpec_Code').val(), BoardCombine: BoardDataList[i].BoardCombine1, Flute: BoardDataList[i].Flute, lv2: lv2, lv3: lv3, lv4: lv4, BoardKIWI: BoardDataList[i].Kiwi, CostPerTon: $('#modelProductSpec_CostPerTon').val(), PlantCode: plant, costField: costfield, jointLap: $('#modelProductSpec_JointLap').val(), CostOEM: $('#modelProductSpec_CostOEM').val() },
                        success: function (data) {
                            if (data != '[object Object]') {
                                window.location.href = '@Url.Action("Index", "Login")';
                            }
                            document.getElementById("Station").innerHTML = "";
                            $('#Station').append($("<option></option>").attr("value", "").text("--- Please Select Item ---"));
                            $.each(data[0].StationList, function (x) {
                                $('#Station').append($("<option></option>").attr("value", data[0].StationList[x].Station).text(data[0].StationList[x].Station));
                            });
                            if (data[0].A == null) {
                                //swal("You can't use this Board, You must add Flute for this Board before.", "", "warning");
                                swal("ไม่สามารถใช้ Board นี้ได้เนื่องจากโรงงานของคุณยังไม่ได้เพิ่ม Flute นี้.", "", "warning");
                                $('#modelProductSpec_A').val(0);
                                $('#modelProductSpec_B').val(0);
                                $('#modelProductSpec_C').val(0);
                                $('#modelProductSpec_D1').val(0);
                                $('#modelProductSpec_D2').val(0);
                                $('#modelProductSpec_JointLap').val(0);

                                $('#modelProductSpec_Code').val("");
                                $('#modelProductSpec_Board').val("");
                                $('#modelProductSpec_Flute').val("");
                                $('#modelProductSpec_Weight').val(0);
                                $('#modelProductSpec_BoardKIWI').val("");
                                $('#modelProductSpec_CostPerTon').val(0);
                                $('#modelProductSpec_CostOEM').val(0);
                                $('#modelProductSpec_Hierarchy').val(data[0].Hierarchy);
                            }
                            else {
                                $('#modelProductSpec_Hierarchy').val(data[0].Hierarchy);
                                $('#modelProductSpec_Weight').val(data[0].Weight);
                                $('#modelProductSpec_BoardKIWI').val(data[0].BoardKIWI);
                                $('#modelProductSpec_CostPerTon').val(data[0].CostPerTon.toFixed(2));
                                $('#modelProductSpec_A').val(data[0].A);
                                $('#modelProductSpec_B').val(data[0].B);
                                $('#modelProductSpec_C').val(data[0].C);
                                $('#modelProductSpec_D1').val(data[0].D1);
                                $('#modelProductSpec_D2').val(data[0].D2);
                                $('#modelProductSpec_JointLap').val(data[0].JointLap);
                                $('#modelProductSpec_JoinSize').val(data[0].JoinSize);
                                $("#modelProductSpec_JoinSize").trigger('change');

                                $('#modelProductSpec_Code').val(BoardDataList[i].Code);
                                $('#modelProductSpec_Board').val(BoardDataList[i].Board);
                                $('#modelProductSpec_Flute').val(BoardDataList[i].Flute);
                                //$('#bSearch').val(BoardDataList[i].Code);
                                if (BoardDataList[i].Board.includes('O1') == true)
                                    $('#modelProductSpec_IsWrap').val('Wrap');
                                if (data[0].CostOEM != null) {
                                    $('#modelProductSpec_CostOEM').val(data[0].CostOEM.toFixed(2));
                                }
                            }
                        }
                    });
                    closeALT();
                    document.getElementById("chkTwoP").disabled = false;

                    if (formGroup != "DIGITAL" && formGroup != "TCG")
                        document.getElementById("btProcess").disabled = false;

                    if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary") {
                        document.getElementById("btDefault").disabled = false;
                        document.getElementById("btEdit").disabled = false;
                        document.getElementById("btScoreW").disabled = false;
                        document.getElementById("chkTwoP").disabled = true;
                        document.getElementById("btBoardAlt").disabled = false;
                        document.getElementById("btCoating").disabled = false;
                    }
                    else if (formGroup == "STDDC" || rscStyle == "Rotary" || formGroup == "PALLET") {
                        document.getElementById("chkGLwid").disabled = false;
                        document.getElementById("btBoardAlt").disabled = false;
                        document.getElementById("btCoating").disabled = false;
                        document.getElementById("btScoreW").disabled = false;
                    }
                    else if (formGroup == "SB") {
                        document.getElementById("btScoreW").disabled = false;
                        document.getElementById("btBoardAlt").disabled = false;
                        document.getElementById("btCoating").disabled = false;
                    }
                    else if (formGroup == "ROLL" || formGroup == "SF") {
                        document.getElementById("btEdit").disabled = false;
                        document.getElementById("btBoardAlt").disabled = false;
                        document.getElementById("btCoating").disabled = false;
                    }
                    else if (formGroup == "SS" || formGroup == "AC") {
                        document.getElementById("btBoardAlt").disabled = false;
                        document.getElementById("btCoating").disabled = false;
                    }
                    break;
                }
            }
        }
    });

    $("#ddlSearch").change(function (e) {
        var code = $(this).val();

        if (($('#FlagCode').val() == "" || $('#FlagCode').val() == 0) && $('#modelProductSpec_Code').val() != "") {
            code = $('#modelProductSpec_Code').val();
        }

        if (code != 0) {

            for (var i = 0; i < BoardDataList.length; i++) {
                if (BoardDataList[i].Code == code) {
                    $.ajax({
                        url: "GetBoard",
                        type: "POST",
                        dataType: "json",
                        data: { Code: BoardDataList[i].Code, Code1: $('#modelProductSpec_Code').val(), BoardCombine: BoardDataList[i].BoardCombine1, Flute: BoardDataList[i].Flute, lv2: lv2, lv3: lv3, lv4: lv4, BoardKIWI: BoardDataList[i].Kiwi, CostPerTon: $('#modelProductSpec_CostPerTon').val(), PlantCode: plant, costField: costfield, jointLap: $('#modelProductSpec_JointLap').val(), CostOEM: $('#modelProductSpec_CostOEM').val() },
                        success: function (data) {
                            if (data != '[object Object]') {
                                window.location.href = '@Url.Action("Index", "Login")';
                            }
                            document.getElementById("Station").innerHTML = "";
                            $('#Station').append($("<option></option>").attr("value", "").text("--- Please Select Item ---"));
                            $.each(data[0].StationList, function (x) {
                                $('#Station').append($("<option></option>").attr("value", data[0].StationList[x].Station).text(data[0].StationList[x].Station));
                            });
                            if (data[0].A == null) {
                                //swal("You can't use this Board, You must add Flute for this Board before.", "", "warning");
                                swal("ไม่สามารถใช้ Board นี้ได้เนื่องจากโรงงานของคุณยังไม่ได้เพิ่ม Flute นี้.", "", "warning");
                                $('#modelProductSpec_A').val(0);
                                $('#modelProductSpec_B').val(0);
                                $('#modelProductSpec_C').val(0);
                                $('#modelProductSpec_D1').val(0);
                                $('#modelProductSpec_D2').val(0);
                                $('#modelProductSpec_JointLap').val(0);

                                $('#modelProductSpec_Code').val("");
                                $('#modelProductSpec_Board').val("");
                                $('#modelProductSpec_Flute').val("");
                                $('#modelProductSpec_Weight').val(0);
                                $('#modelProductSpec_BoardKIWI').val("");
                                $('#modelProductSpec_CostPerTon').val(0);
                                $('#modelProductSpec_CostOEM').val(0);
                                $('#modelProductSpec_Hierarchy').val(data[0].Hierarchy);
                            }
                            else {
                                $('#modelProductSpec_Hierarchy').val(data[0].Hierarchy);
                                $('#modelProductSpec_Weight').val(data[0].Weight);
                                $('#modelProductSpec_BoardKIWI').val(data[0].BoardKIWI);
                                $('#modelProductSpec_CostPerTon').val(data[0].CostPerTon.toFixed(2));
                                $('#modelProductSpec_A').val(data[0].A);
                                $('#modelProductSpec_B').val(data[0].B);
                                $('#modelProductSpec_C').val(data[0].C);
                                $('#modelProductSpec_D1').val(data[0].D1);
                                $('#modelProductSpec_D2').val(data[0].D2);
                                $('#modelProductSpec_JointLap').val(data[0].JointLap);
                                $('#modelProductSpec_JoinSize').val(data[0].JoinSize);
                                $("#modelProductSpec_JoinSize").trigger('change');

                                $('#modelProductSpec_Code').val(BoardDataList[i].Code);
                                $('#modelProductSpec_Board').val(BoardDataList[i].Board);
                                $('#modelProductSpec_Flute').val(BoardDataList[i].Flute);
                                $('#ddlSearch').val(BoardDataList[i].Code);
                                if (BoardDataList[i].Board.includes('O1') == true)
                                    $('#modelProductSpec_IsWrap').val('Wrap');
                                if (data[0].CostOEM != null) {
                                    $('#modelProductSpec_CostOEM').val(data[0].CostOEM.toFixed(2));
                                }
                            }
                        }
                    });
                    closeALT();
                    document.getElementById("chkTwoP").disabled = false;

                    if (formGroup != "DIGITAL" && formGroup != "TCG")
                        document.getElementById("btProcess").disabled = false;

                    if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary") {
                        document.getElementById("btDefault").disabled = false;
                        document.getElementById("btEdit").disabled = false;
                        document.getElementById("btScoreW").disabled = false;
                        document.getElementById("chkTwoP").disabled = true;
                        document.getElementById("btBoardAlt").disabled = false;
                        document.getElementById("btCoating").disabled = false;
                    }
                    else if (formGroup == "STDDC" || rscStyle == "Rotary" || formGroup == "PALLET") {
                        document.getElementById("chkGLwid").disabled = false;
                        document.getElementById("btBoardAlt").disabled = false;
                        document.getElementById("btCoating").disabled = false;
                        document.getElementById("btScoreW").disabled = false;
                    }
                    else if (formGroup == "SB") {
                        document.getElementById("btScoreW").disabled = false;
                        document.getElementById("btBoardAlt").disabled = false;
                        document.getElementById("btCoating").disabled = false;
                    }
                    else if (formGroup == "ROLL" || formGroup == "SF") {
                        document.getElementById("btEdit").disabled = false;
                        document.getElementById("btBoardAlt").disabled = false;
                        document.getElementById("btCoating").disabled = false;
                    }
                    else if (formGroup == "SS" || formGroup == "AC") {
                        document.getElementById("btBoardAlt").disabled = false;
                        document.getElementById("btCoating").disabled = false;
                    }
                    break;
                }
            }
        }
        else {
            $('#modelProductSpec_Code').val("");
            $('#modelProductSpec_Board').val("");
            $('#modelProductSpec_Flute').val("");
            $('#modelProductSpec_Weight').val(0);
            $('#modelProductSpec_BoardKIWI').val("");
            $('#modelProductSpec_CostPerTon').val(0);
            //$('#modelProductSpec_Hierarchy').val("");
        }
        $('#FlagCode').val(1);
    });

    $("#modelProductSpec_Height").change(function () {
        if (formGroup == "HC" || formGroup == "HB") {
            if ($("#modelProductSpec_Height").val() == 0) {
                //document.getElementById("ddlSearch").innerHTML = "";
                //$('#ddlSearch').append($("<option></option>").attr("value", "").text("Choose Board"));
                //$("#ddlSearch").trigger('change');
                //$('#ddlSearch').prop('disabled', true);
                document.getElementById("bSearch").innerHTML = "";
                $('#bSearch').append($("<option></option>").attr("value", "").text("Choose Board"));
                $("#bSearch").trigger('change');
                $('#bSearch').prop('disabled', true);
                $('#hh').hide();
            } else {
                //$('#ddlSearch').prop('disabled', false);
                $('#bSearch').prop('disabled', false);
                $.ajax({
                    url: "CriteriaBoardHoney",
                    type: "POST",
                    dataType: "json",
                    data: { Hig: $("#modelProductSpec_Height").val(), JointLap: $("#modelProductSpec_JoinSize").val() },
                    success:
                        function (data) {
                            document.getElementById("bSearch").innerHTML = "";
                            $('#bSearch').append($("<option></option>").attr("value", "").text("Choose Board"));
                            $.each(data.BoardLists, function (x) {
                                $('#bearch').append($("<option></option>").attr("value", data.BoardLists[x].Code).text(data.BoardLists[x].SearchBoard));
                            });
                        },
                    messages: {
                        results: function (resultsCount) { },
                        noResults: ""
                    }
                });
                $('#hh').show();
                $('#hh').val("Height: " + $("#modelProductSpec_Height").val());
            }
        }
        });

        $("#modelProductSpec_JoinSize").change(function () {
            if (formGroup == "HC" || formGroup == "HB") {
                    $.ajax({
                        url: "CriteriaBoardHoney",
                        type: "POST",
                        dataType: "json",
                        data: { Hig: $("#modelProductSpec_Height").val(), JointLap: $("#modelProductSpec_JoinSize").val() },
                        success:
                            function (data) {
                                document.getElementById("bSearch").innerHTML = "";
                                $('#bSearch').append($("<option></option>").attr("value", "").text("Choose Board"));
                                $.each(data.BoardLists, function (x) {
                                    $('#bSearch').append($("<option></option>").attr("value", data.BoardLists[x].Code).text(data.BoardLists[x].SearchBoard));
                                });
                            },
                        messages: {
                            results: function (resultsCount) { },
                            noResults: ""
                        }
                });
                if ($("#modelProductSpec_JoinSize").val() == 0) {
                    $('#cc').hide();
                }
                else {
                    $('#cc').show();
                    $('#cc').val("Cell Size: " + $("#modelProductSpec_JoinSize").val());
                }
            }
        });

        $('#modelProductSpec_SideA').keyup(function () {
            if (formGroup == "CG") {
                if ($('#modelProductSpec_SideA').val() == 0) {
                    $('#aa').hide();
                } else {
                    $('#aa').show();
                    $('#aa').val("A: " + $("#modelProductSpec_SideA").val());
                }
            }
        });

        $('#modelProductSpec_SideB').keyup(function () {
            if (formGroup == "CG") {
                if ($('#modelProductSpec_SideB').val() == 0) {
                    $('#bb').hide();
                } else {
                    $('#bb').show();
                    $('#bb').val("B: " + $("#modelProductSpec_SideB").val());
                }
            }
        });

        $('#modelProductSpec_SideC').keyup(function () {
            if (formGroup == "CG") {
                if ($('#modelProductSpec_SideC').val() == 0) {
                    $('#cc').hide();
                } else {
                    $('#cc').show();
                    $('#cc').val("C: " + $("#modelProductSpec_SideC").val());
                }
            }
    });

    $("#modelProductSpec_SideD").change(function () {
        //$('#modelProductSpec_Hierarchy').val("03" + lv2.trim() + lv3 + lv4);
        if (formGroup == "CG" && $("#modelProductSpec_SideD").val() == 0) {
            document.getElementById("bSearch").innerHTML = "";
            $('#bSearch').append($("<option></option>").attr("value", "").text("Choose Board"));
            $("#bSearch").trigger('change');
            $('#bSearch').prop('disabled', true);
            $('#dd').hide();
        } else {
            $('#bSearch').prop('disabled', false);
            $('#dd').show();
            $('#dd').val("Thickness: " + $("#modelProductSpec_SideD").val());
            CriteriaCG();
        }
    });

    $("#modelProductSpec_IsWrap").change(function () {
        if ($("#modelProductSpec_IsWrap").val() == "Wrap")
            $("#chkWrap2").val(1);
        else
            $("#chkWrap2").val(0);

        if ($("#modelProductSpec_SideD").val() != 0 && ($("#chkWrap1").val() == "" || $("#chkWrap2").val() != $("#chkWrap1").val() || $("#modelProductSpec_IsWrap").val() == "")) {
            CriteriaCG();
        }

        if ($("#modelProductSpec_IsWrap").val() == "Wrap")
            $("#chkWrap1").val(1);
        else
            $("#chkWrap1").val(0);
    });

    $("#modelProductSpec_CGType").change(function () {

        if ($("#modelProductSpec_CGType").val() == "B") {
            document.getElementById("chkBak").disabled = true;
            $('#cgB').show();
            $('#cgL').hide();
            $('#cgU').hide();
            $('#cgLx').hide();
            $('#cgLa').hide();
            $('#cgUx').hide();
            $('#modelProductSpec_SideA').prop('readonly', true);
            $('#modelProductSpec_SideB').prop('readonly', false);
            $('#modelProductSpec_SideC').prop('readonly', true);
            $('#modelProductSpec_SideA').val("");
            $('#modelProductSpec_SideC').val("");
            $('#aa').hide();
            $('#cc').hide();
            $("#ll").css("top", "88px");
            document.getElementById("modelProductSpec_SideA").style.borderColor = "LightGray";
            document.getElementById("modelProductSpec_SideC").style.borderColor = "LightGray";

            $('#chkBak').prop('checked', false);
            $('#modelProductSpec_IsNotch').val(false);
            document.getElementById("modelProductSpec_No_Slot").disabled = true;
            document.getElementById("modelProductSpec_NotchDegree").disabled = true;
            document.getElementById("modelProductSpec_NotchDegreex").disabled = true;
            document.getElementById("modelProductSpec_NotchArea").disabled = true;
            $("#modelProductSpec_NotchDegree").val(0);
            $("#modelProductSpec_NotchDegreex").val("");
            $("#modelProductSpec_No_Slot").val("");
            $("#modelProductSpec_NotchArea").val("");
            $('#modelProductSpec_NotchSide').val("");
            $("#NotchSide").hide();
            document.getElementById("doubleBak").innerHTML = "";

            if ($('#PrintMaster').val() == "") {
                $('#MainPic').show();
                $('#FilePic').hide();
            } else {
                $('#MainPic').hide();
                $('#FilePic').show();
            }
        }
        else if ($("#modelProductSpec_CGType").val() == "U") {
            document.getElementById("chkBak").disabled = false;

            $('#cgB').hide();
            $('#cgL').hide();
            $('#cgLx').hide();
            $('#cgLa').hide();
            $("#ll").css("top", "52px");
            $('#modelProductSpec_SideA').prop('readonly', false);
            $('#modelProductSpec_SideB').prop('readonly', false);
            $('#modelProductSpec_SideC').prop('readonly', false);
            $('#modelProductSpec_NotchSide').val("");
            $("#NotchSide").hide();
            if ($('#chkBak').is(":checked")) {
                document.getElementById("doubleBak").innerHTML = "คู่";
                $('#cgU').hide();
                $('#cgUx').show();
            }
            else {
                document.getElementById("doubleBak").innerHTML = "";
                $('#cgU').show();
                $('#cgUx').hide();
            }
        }
        else {
            document.getElementById("chkBak").disabled = false;
            $('#cgB').hide();
            $('#cgU').hide();
            $('#cgUx').hide();
            $('#modelProductSpec_SideA').prop('readonly', false);
            $('#modelProductSpec_SideB').prop('readonly', false);
            $('#modelProductSpec_SideC').prop('readonly', true);
            $('#modelProductSpec_SideC').val("");
            $('#cc').hide();
            $("#ll").css("top", "52px");
            document.getElementById("modelProductSpec_SideC").style.borderColor = "LightGray";
            document.getElementById("doubleBak").innerHTML = "";
            if ($('#chkBak').is(":checked")) {
                $('#cgL').hide();
                $("#NotchSide").show();
                if ($('#modelProductSpec_NotchSide').val() == "A") {
                    $('#ASide').prop('checked', true);
                    $('#cgLa').show();
                }
                else if ($('#modelProductSpec_NotchSide').val() == "B") {
                    $('#BSide').prop('checked', true);
                    $('#cgLx').show();
                }
                else {
                    $('#BSide').prop('checked', true);
                    $('#cgLx').show();
                }
            }
            else {
                $('#cgL').show();
                $('#cgLx').hide();
                $('#cgLa').hide();
            }
        }

    });

    $('#btnsavespec').click(function () {
        debugger;
        LoadingButton(true);
        if ($('#modelProductSpec_CostPerTon').val() == 0) {
            if (formGroup == "TCG" || formGroup == "DIGITAL") {
                document.getElementById("modelProductSpec_CostPerTon").style.borderColor = "red";
            }
            else {
                $("#modelProductSpec_CostPerTon-error").show();
            }
            LoadingButton(false);
            //$("#spinSave").hide();
            return false;
        }
        else {
            //if (plant != "" && $('#modelProductSpec_CostOEM').val() == 0) {
            //    swal("กรุณาระบุ Cost OEM (Cost ของผู้ผลิต) ด้วยค่ะ", "", "");
            //    $("#spinSave").hide();
            //    return false;
            //}
            //else {
                if (sap == "True") {
                    if (formGroup != "DIGITAL" && formGroup != "TCG") {
                        if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary" && rscStyle != "Sleeve") {
                            if ($("#modelProductSpec_Scorew2").val() == 0) {
                                swal("กรุณาระบุค่า Score Width Line2", "", "warning");
                                LoadingButton(false);
                                return false;
                            }
                        }

                        if (parseFloat($('#modelProductSpec_WeightBox').val()) != parseFloat($('#modelProductSpec_WeightBoxInit').val())) {
                            swal({
                                title: "เนื่องจากสินค้ามีการส่งขึ้น SAP แล้ว ไม่สามารถเปลี่ยนแปลงน้ำหนัก FG ได้",
                                text: "",
                                icon: "warning"
                            })
                            LoadingButton(false);
                            return false;
                        }
                        else {
                            LoadingButton(false);
                            CaptureDimension();
                        }
                    }
                    else {
                        if (parseFloat($('#modelProductSpec_WeightBox').val()) != parseFloat($('#modelProductSpec_WeightBoxInit').val())) {
                            swal({
                                title: "เนื่องจากสินค้ามีการส่งขึ้น SAP แล้ว ไม่สามารถเปลี่ยนแปลงน้ำหนัก FG ได้",
                                text: "",
                                icon: "warning"
                            })
                            LoadingButton(false);
                            return false;
                        } else {
                            submitPage();
                        }
                    }
                }
                else {
                    if (formGroup == "TCG" || formGroup == "DIGITAL") {

                        if ($('#modelProductSpec_WeightBox').val() == 0) {
                            document.getElementById("modelProductSpec_WeightBox").style.borderColor = "red";
                            LoadingButton(false);
                            return false;
                        }
                        else if ($('#modelProductSpec_WeightBox').val() > 99.999) {
                            LoadingButton(false);
                            return false;
                        }
                    }
                    else {
                        if ($('#modelProductSpec_Code').val() != "") {
                            if ($('#modelProductSpec_WeightBox').val() == 0.000 || $('#modelProductSpec_BoxArea').val() == 0) {
                                if (formGroup == "PALLET") {
                                    swal("กรุณาใส่ค่า Finished Good Weight. ", "", "");
                                }
                                else if (formGroup == "CG" && matType == "82") {
                                    swal("กรุณาใส่ค่าน้ำหนักให้ครบถ้วน", "", "");
                                }
                                else {
                                    swal("กรุณากดปุ่ม Calculate เพื่อให้ระบบคำนวนน้ำหนักก่อน ", "", "");
                                }
                                LoadingButton(false);
                                return false;
                            }
                            else {
                                if (formGroup == "STDRSC" && rscStyle != "Rotary" && rscStyle != "Sleeve") {
                                    if ($("#modelProductSpec_Scorew2").val() == 0) {
                                        swal("กรุณาระบุค่า Score Width Line2", "", "warning");
                                        LoadingButton(false);
                                        return false;
                                    }
                                    else {
                                        if ($("#modelProductSpec_Leg").val() == $('#l').val() && $("#modelProductSpec_Wid").val() == $('#w').val() && $("#modelProductSpec_Hig").val() == $('#h').val() && $('#c').val() == $('#modelProductSpec_Code').val()) {
                                            ComputeWeightAndArea();
                                        }
                                        else {
                                            //if (real == "Presale") {
                                            if ($("#modelProductSpec_CutSheetWid").val() != 0 && $("#modelProductSpec_CutSheetLeng").val() != 0) {
                                                ComputeWeightAndArea();
                                            }
                                            else {
                                                RenderRSC();
                                            }
                                        }
                                    }
                                }
                                else if (formGroup == "SPCRSC" && rscStyle != "Rotary" && rscStyle != "Sleeve") {
                                    if ($("#modelProductSpec_Scorew2").val() == 0) {
                                        swal("กรุณาระบุค่า Score Width Line2", "", "warning");
                                        LoadingButton(false);
                                        return false;
                                    }
                                    else {
                                        chkSpcRsc();
                                    }
                                }
                                else if (formGroup == "AC") {
                                    RenderTeeth();
                                }
                                else if (formGroup == "STDDC" || rscStyle == "Rotary" || formGroup == "SB" || formGroup == "SS" || formGroup == "OFFSETTS") {
                                    ComputeDC();
                                }
                                else if (formGroup == "SF") {
                                    if (unit == 2)
                                        ComputeSF();
                                    else
                                        ComputeDC();
                                }
                                else if (formGroup == "ROLL") {
                                    ComputeSF();
                                }
                                else if (formGroup == "HC") {
                                    ComputeHC();
                                }
                                else if (formGroup == "HB") {
                                    ComputeHB();
                                }
                                else if (formGroup == "CG") {
                                    ComputeCG();
                                }
                            }
                        }
                        else {
                            swal("กรุณาเลือก Board ก่อน", "", "warning");
                            LoadingButton(false);
                            return false;
                        }
                    }

                    if ($('#modelProductSpec_FlagRouting').val() == 1) {
                        //alert(parseFloat($('#modelProductSpec_WeightBox').val()));
                        //alert(parseFloat($('#modelProductSpec_WeightBoxInit').val()));
                        if (parseFloat($('#modelProductSpec_WeightBox').val()) != parseFloat($('#modelProductSpec_WeightBoxInit').val())) {
                            swal({
                                title: "มีการเปลี่ยนแปลงขนาดสินค้าและน้ำหนัก ควรแก้ขนาดสินค้าและน้ำหนักใน Routing ด้วย",
                                text: "",
                                icon: "warning",
                                buttons: {
                                    confirm: "Ok",
                                    cancel: true,
                                },
                                dangerMode: false,
                            })
                                .then((warn) => {
                                    if (warn) {
                                        if (formGroup != "DIGITAL" && formGroup != "TCG") {
                                            LoadingButton(false);
                                            CaptureDimension();
                                        }
                                        else {
                                            submitPage();
                                        }
                                    }
                                    else {
                                        LoadingButton(false);
                                        return false;
                                    }
                                });
                        }
                        else {
                            if (unit == 2 || formGroup == "HC") {
                                if ($('#SheetWid').val() != $('#modelProductSpec_CutSheetWidInit').val()) {
                                    swal({
                                        title: "มีการเปลี่ยนแปลงขนาดสินค้า ควรแก้ขนาดสินค้าใน Routing ด้วย",
                                        text: "",
                                        icon: "warning",
                                        buttons: {
                                            confirm: "Ok",
                                            cancel: true,
                                        },
                                        dangerMode: false,
                                    })
                                        .then((warn) => {
                                            if (warn) {
                                                LoadingButton(false);
                                                CaptureDimension();
                                            }
                                            else {
                                                LoadingButton(false);
                                                return false;
                                            }
                                        });
                                }
                                else {
                                    LoadingButton(false);
                                    CaptureDimension();
                                }
                            }
                            else {
                                if (formGroup != "DIGITAL" && formGroup != "TCG") {
                                    LoadingButton(false);
                                    CaptureDimension();
                                }
                                else {
                                    submitPage();
                                }
                            }
                        }
                    }
                    else {
                        if (formGroup != "DIGITAL" && formGroup != "TCG") {
                            CaptureDimension();
                        }
                        else {

                            submitPage();
                        }
                    }
                }
            //}
        }
    });
    function submitPage() {
        LoadingButton(true);
        var fdata = new FormData();

        var fileInput = $('#PrintMaster')[0];
        if (typeof fileInput !== 'undefined') {
            var file = fileInput.files[0];
            fdata.append("PrintMaster", file);
        }

        $("input").each(function (x, y) {
            if ($(y).attr("name") != "undefined") {
                if ($(y).attr("name") == "modelProductSpec.DimensionPropertiesImageBase64String") {
                    fdata.append($(y).attr("name"), imagedata);
                }
                else {
                    fdata.append($(y).attr("name"), $(y).val());
                }
            }
        });

        $("select").each(function (x, y) {
             fdata.append($(y).attr("name"), $(y).val());
        });

        $.ajax({
            url: '@Url.Action("SaveProductSpec", "NewProduct")',
            type: "POST",
            async: false,
            data: fdata,
            dataType: "json",
            processData: false,
            contentType: false,
            success: function (data) {
                if (data.isSuccess)
                    window.location.href = '@Url.Action("ProductProp", "NewProduct")';
                else {
                    swal("Save Failed", "", "warning")
                        .then((willAccept) => {
                            if (willAccept) {
                                LoadingButton(false);
                            }
                        });
                }
            }
        });
    }
    function CriteriaCG() {
        $.ajax({
            url: "CriteriaBoardFromThickness",
            type: "POST",
            dataType: "json",
            data: { SideD: $("#modelProductSpec_SideD").val(), IsWrap: $("#modelProductSpec_IsWrap").val() },
            success:
                function (data) {
                    document.getElementById("bSearch").innerHTML = "";
                    $('#bSearch').append($("<option></option>").attr("value", "").text("Choose Board"));
                    $.each(data.BoardLists, function (x) {
                        $('#bSearch').append($("<option></option>").attr("value", data.BoardLists[x].Code).text(data.BoardLists[x].SearchBoard));
                    });
                },
            messages: {
                results: function (resultsCount) { },
                noResults: ""
            }
        });
    }
    function Sum() {
        var sum = 0;
        if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary") {
            sum = Number($("#Scorew1").val()) + Number($("#Scorew2").val()) + Number($("#Scorew3").val()) + Number($("#modelProductSpec_Scorew4").val()) + Number($("#modelProductSpec_Scorew5").val()) + Number($("#modelProductSpec_Scorew6").val()) + Number($("#modelProductSpec_Scorew7").val()) + Number($("#modelProductSpec_Scorew8").val()) + Number($("#modelProductSpec_Scorew9").val()) + Number($("#modelProductSpec_Scorew10").val()) + Number($("#modelProductSpec_Scorew11").val()) + Number($("#modelProductSpec_Scorew12").val()) + Number($("#modelProductSpec_Scorew13").val()) + Number($("#modelProductSpec_Scorew14").val()) + Number($("#modelProductSpec_Scorew15").val()) + Number($("#modelProductSpec_Scorew16").val());
        }
        else if (formGroup == "SB") {
            sum = Number($("#Scorew1").val()) + Number($("#Scorew2").val()) + Number($("#Scorew3").val()) + Number($("#Scorew4").val()) + Number($("#modelProductSpec_Scorew5").val()) + Number($("#modelProductSpec_Scorew6").val()) + Number($("#modelProductSpec_Scorew7").val()) + Number($("#modelProductSpec_Scorew8").val()) + Number($("#modelProductSpec_Scorew9").val()) + Number($("#modelProductSpec_Scorew10").val()) + Number($("#modelProductSpec_Scorew11").val()) + Number($("#modelProductSpec_Scorew12").val()) + Number($("#modelProductSpec_Scorew13").val()) + Number($("#modelProductSpec_Scorew14").val()) + Number($("#modelProductSpec_Scorew15").val()) + Number($("#modelProductSpec_Scorew16").val());
        }
        else {
            sum = Number($("#modelProductSpec_ScoreW1").val()) + Number($("#modelProductSpec_Scorew2").val()) + Number($("#modelProductSpec_Scorew3").val()) + Number($("#modelProductSpec_Scorew4").val()) + Number($("#modelProductSpec_Scorew5").val()) + Number($("#modelProductSpec_Scorew6").val()) + Number($("#modelProductSpec_Scorew7").val()) + Number($("#modelProductSpec_Scorew8").val()) + Number($("#modelProductSpec_Scorew9").val()) + Number($("#modelProductSpec_Scorew10").val()) + Number($("#modelProductSpec_Scorew11").val()) + Number($("#modelProductSpec_Scorew12").val()) + Number($("#modelProductSpec_Scorew13").val()) + Number($("#modelProductSpec_Scorew14").val()) + Number($("#modelProductSpec_Scorew15").val()) + Number($("#modelProductSpec_Scorew16").val());
        }
        $("#sum").val(sum);
    }
    function GenBoardSpec() {
        $.ajax({
            url: "BoardSpec",
            type: "POST",
            dataType: "json",
            data: { Code: $("#BoardCodeAlt").val(), flute: $("#modelProductSpec_Flute").val(), plant: plant },
            success:
                function (data) {
                    var d = 0;
                    $.each(data, function (i, item) {
                        paper[d] = item.PaperDes;
                        if (paper[d] == "0")
                            paper[d] = "--000";
                        station[d] = item.Station;
                        d++;
                    })

                    document.getElementById("GL").value = "";
                    document.getElementById("BM").value = "";
                    document.getElementById("BL").value = "";
                    document.getElementById("CM").value = "";
                    document.getElementById("CL").value = "";
                    document.getElementById("DM").value = "";
                    document.getElementById("DL").value = "";

                    $('#modelProductSpec_stt1').hide();
                    $('#modelProductSpec_stt2').hide();
                    $('#modelProductSpec_stt3').hide();
                    $('#modelProductSpec_stt4').hide();
                    $('#modelProductSpec_stt5').hide();
                    $('#modelProductSpec_stt6').hide();
                    $('#modelProductSpec_stt7').hide();

                    document.getElementById("GL").style.visibility = "hidden";
                    document.getElementById("BM").style.visibility = "hidden";
                    document.getElementById("BL").style.visibility = "hidden";
                    document.getElementById("CM").style.visibility = "hidden";
                    document.getElementById("CL").style.visibility = "hidden";
                    document.getElementById("DM").style.visibility = "hidden";
                    document.getElementById("DL").style.visibility = "hidden";

                    if (d > 0) {
                        $('#modelProductSpec_stt1').show();
                        $('#modelProductSpec_stt1').val(station[0]);
                        document.getElementById("GL").value = paper[0];
                        document.getElementById("GL").style.visibility = "visible";
                    }
                    if (d > 1) {
                        $('#modelProductSpec_stt2').show();
                        $('#modelProductSpec_stt2').val(station[1]);
                        document.getElementById("BM").value = paper[1];
                        document.getElementById("BM").style.visibility = "visible";
                    }
                    if (d > 2) {
                        $('#modelProductSpec_stt3').show();
                        $('#modelProductSpec_stt3').val(station[2]);
                        document.getElementById("BL").value = paper[2];
                        document.getElementById("BL").style.visibility = "visible";
                    }
                    if (d > 3) {
                        $('#modelProductSpec_stt4').show();
                        $('#modelProductSpec_stt4').val(station[3]);
                        document.getElementById("CM").value = paper[3];
                        document.getElementById("CM").style.visibility = "visible";
                    }
                    if (d > 4) {
                        $('#modelProductSpec_stt5').show();
                        $('#modelProductSpec_stt5').val(station[4]);
                        document.getElementById("CL").value = paper[4];
                        document.getElementById("CL").style.visibility = "visible";
                    }
                    if (d > 5) {
                        $('#modelProductSpec_stt6').show();
                        $('#modelProductSpec_stt6').val(station[5]);
                        document.getElementById("DM").value = paper[5];
                        document.getElementById("DM").style.visibility = "visible";
                    }
                    if (d > 6) {
                        $('#modelProductSpec_stt7').show();
                        $('#modelProductSpec_stt7').val(station[6]);
                        document.getElementById("DL").value = paper[6];
                        document.getElementById("DL").style.visibility = "visible";
                    }
                },
            messages: {
                results: function (resultsCount) { },
                noResults: ""
            }
        });
    }
    function closeALT() {
            var from = document.getElementById("alt");
            from.style.display = "none";
    }
    function RenderWid() {
        lid1 = $("#modelProductSpec_ScoreW1").val();
        h1 = $("#modelProductSpec_Scorew2").val();
        lid2 = $("#modelProductSpec_Scorew3").val();
        shWid = $("#modelProductSpec_CutSheetWid").val();

        h2 = 68 + (179 * lid1 / shWid);
        h3 = 247 - (179 * lid2 / shWid);

        var w1 = h2 / 2 + 39;
        var w2 = h2 + (h3 - h2) / 2 + 8;
        var w3 = h3 + (260 - h3) / 2;

        document.getElementById("h2").style.top = h2 + "px";
        document.getElementById("h3").style.top = h3 + "px";

        if (lid1 == 0) {
            document.getElementById("modelProductSpec_ScoreW1").style.top = "61px";
            document.getElementById("modelProductSpec_ScoreW1").style.width = "15px";
            document.getElementById("modelProductSpec_ScoreW1").style.left = "383px";
        }
        else {
            document.getElementById("modelProductSpec_ScoreW1").style.top = w1 + "px";
            document.getElementById("modelProductSpec_ScoreW1").style.width = "35px";
            document.getElementById("modelProductSpec_ScoreW1").style.left = "371px";
        }

        document.getElementById("modelProductSpec_Scorew2").style.top = w2 + "px";

        if (lid2 == 0)
            document.getElementById("modelProductSpec_Scorew3").style.top = "264px";
        else
            document.getElementById("modelProductSpec_Scorew3").style.top = w3 + "px";

        document.getElementById("jlapPic1").height = 180 * lid1 / shWid;
        document.getElementById("jLapMid").height = 180 * h1 / shWid;
        document.getElementById("jlapPic2").height = 180 * lid2 / shWid;

        document.getElementById("lLx1").height = 180 * lid1 / shWid;
        document.getElementById("lLb").height = 180 * h1 / shWid;
        document.getElementById("lLx2").height = 180 * lid2 / shWid;
        document.getElementById("wLx1").height = 180 * lid1 / shWid;
        document.getElementById("wLb").height = 180 * h1 / shWid;
        document.getElementById("wLx2").height = 180 * lid2 / shWid;

        document.getElementById("lRx1").height = 180 * lid1 / shWid;
        document.getElementById("lRb").height = 180 * h1 / shWid;
        document.getElementById("lRx2").height = 180 * lid2 / shWid;
        document.getElementById("wRx1").height = 180 * lid1 / shWid;
        document.getElementById("wRb").height = 180 * h1 / shWid;
        document.getElementById("wRx2").height = 180 * lid2 / shWid;

        document.getElementById("slitx1").height = 180 * lid1 / shWid;
        document.getElementById("slitb").height = 180 * h1 / shWid;
        document.getElementById("slitx2").height = 180 * lid2 / shWid;
        if (lid1  ==  0) {
            $('#xTop').hide();
        }
        else {
            $('#xTop').show();
        }

        if (lid2  ==  0) {
            $('#xButton').hide();
        }
        else {
            $('#xButton').show();
        }
        RenderLen();
    }
    function RenderLen() {
        ll = $("#modelProductSpec_ScoreL2").val();
        wl = $("#modelProductSpec_ScoreL3").val();
        lr = $("#modelProductSpec_ScoreL4").val();
        wr = $("#modelProductSpec_ScoreL5").val();
        hblx = $("#modelProductSpec_ScoreL6").val();
        hbrx = $("#modelProductSpec_ScoreL7").val();

        var v0 = 150;

        if ($('#chkTwoP').is(":checked")) {
            v1 = 49 + (300 * ll / hblx);
            v2 = v1;
            v0 = 300;
        }
        else {
            v1 = 50 + (150 * ll / hblx);
            v2 = 199 + (150 * lr / hbrx);
        }

        document.getElementById("lLx1").width = v0 * ll / hblx + 1;
        document.getElementById("lLb").width = v0 * ll / hblx + 1;
        document.getElementById("lLx2").width = v0 * ll / hblx + 1;
        document.getElementById("wLx1").width = v0 * wl / hblx + 1;
        document.getElementById("wLb").width = v0 * wl / hblx + 1;
        document.getElementById("wLx2").width = v0 * wl / hblx + 1;

        document.getElementById("v1").style.left = v1 + "px";
        document.getElementById("v2").style.left = v2 + "px";

        document.getElementById("lRx1").width = 150 * lr / hbrx;
        document.getElementById("lRb").width = 150 * lr / hbrx;
        document.getElementById("lRx2").width = 150 * lr / hbrx;
        document.getElementById("wRx1").width = 150 * wr / hbrx;
        document.getElementById("wRb").width = 150 * wr / hbrx;
        document.getElementById("wRx2").width = 150 * wr / hbrx;

        document.getElementById("jLapMid").width = 16;
        document.getElementById("jlapPic1").width = 16;
        document.getElementById("jlapPic2").width = 16;

        document.getElementById("slitx1").width = 16;
        document.getElementById("slitb").width = 16;
        document.getElementById("slitx2").width = 16;
    }
    function Render() {
        w = width.value;
        l = length.value;
        h = height.value;

        if (w !=  "" && l !=  "" && h !=  "") {
            $.ajax({
                url: "Compute",
                type: "POST",
                data: { Wid: w, Leg: l, Hig: h, Flute: $("#modelProductSpec_Flute").val(), TwoPiece: $('#modelProductSpec_TwoPiece').val(), GLWid: $('#modelProductSpec_GLWid').val(), Weight: $('#modelProductSpec_Weight').val(), rscStyle: rscStyle, BoxArea: $('#modelProductSpec_BoxArea').val(), Flag: $('#modelProductSpec_Flag').val(), PlantCode: plant },
                async: false,
                success:
                    function (data) {
                        if (data != '[object Object]') {
                            window.location.href = '@Url.Action("Index", "Login")';
                        }

                        RenderDefault();

                        $("#modelProductSpec_ScoreL8").val(data[0].ScoreL8);
                        $("#modelProductSpec_ScoreL9").val(data[0].ScoreL9);
                        $("#modelProductSpec_ScoreL6").val(data[0].ScoreL6);
                        $("#modelProductSpec_ScoreL7").val(data[0].ScoreL7);
                        $("#modelProductSpec_JointLap").val(data[0].JointLap);
                        $("#modelProductSpec_ScoreL2").val(data[0].ScoreL2);
                        $("#modelProductSpec_ScoreL3").val(data[0].ScoreL3);
                        $("#modelProductSpec_ScoreL4").val(data[0].ScoreL4);
                        $("#modelProductSpec_ScoreL5").val(data[0].ScoreL5);
                        $("#modelProductSpec_Slit").val(data[0].Slit);
                        $("#modelProductSpec_ScoreW1").val(data[0].ScoreW1);
                        $("#modelProductSpec_Scorew2").val(data[0].Scorew2);

                        $("#modelProductSpec_Scorew3").val(data[0].Scorew3);
                        $("#modelProductSpec_CutSheetLeng").val(data[0].CutSheetLeng);
                        $("#modelProductSpec_CutSheetWid").val(data[0].CutSheetWid);

                        $("#modelProductSpec_SheetArea").val(data[0].SheetArea);
                        $("#modelProductSpec_BoxArea").val(data[0].BoxArea);
                        $("#modelProductSpec_WeightSh").val(data[0].WeightSh.toFixed(3));
                        $("#modelProductSpec_WeightBox").val(data[0].WeightBox.toFixed(3));
                    }
            });
            $("#modelProductSpec_WeightBox").trigger('change');
            RenderWid();
        }
    }
    function RenderDefault() {

        document.getElementById("modelProductSpec_ScoreL6").style.left = "110px";
        document.getElementById("modelProductSpec_ScoreL2").style.left = "70px";
        document.getElementById("modelProductSpec_ScoreL3").style.left = "150px";

        document.getElementById("modelProductSpec_ScoreL7").style.visibility = "visible";
        document.getElementById("modelProductSpec_ScoreL4").style.visibility = "visible";
        document.getElementById("modelProductSpec_ScoreL5").style.visibility = "visible";

    }
    function RenderRSC() {
        w = width.value;
        l = length.value;
        h = height.value;

        if (w !=  "" && l !=  "" && h !=  "") {
            $.ajax({
                url: "Compute",
                type: "POST",
                data: { Wid: w, Leg: l, Hig: h, Flute: $("#modelProductSpec_Flute").val(), JoinSize: $("#modelProductSpec_JointLap").val(), Slit: $("#modelProductSpec_Slit").val(), TwoPiece: $('#modelProductSpec_TwoPiece').val(), GLWid: $('#modelProductSpec_GLWid').val(), Weight: $('#modelProductSpec_Weight').val(), rscStyle: rscStyle, spcLen: $('#modelProductSpec_spcLen').val(), BoxArea: $('#modelProductSpec_BoxArea').val(), Flag: $('#modelProductSpec_Flag').val(), PlantCode: plant },
                async: false,
                success:
                    function (data) {
                        if (data != '[object Object]') {
                            window.location.href = '@Url.Action("Index", "Login")';
                        }

                        $("#modelProductSpec_ScoreL8").val(data[0].ScoreL8);
                        $("#modelProductSpec_ScoreL9").val(data[0].ScoreL9);
                        $("#modelProductSpec_ScoreL6").val(data[0].ScoreL6);
                        $("#modelProductSpec_ScoreL7").val(data[0].ScoreL7);
                        $("#modelProductSpec_JointLap").val(data[0].JointLap);
                        $("#modelProductSpec_ScoreL2").val(data[0].ScoreL2);
                        $("#modelProductSpec_ScoreL3").val(data[0].ScoreL3);
                        $("#modelProductSpec_ScoreL4").val(data[0].ScoreL4);
                        $("#modelProductSpec_ScoreL5").val(data[0].ScoreL5);
                        $("#modelProductSpec_Slit").val(data[0].Slit);
                        $("#modelProductSpec_ScoreW1").val(data[0].ScoreW1);
                        $("#modelProductSpec_Scorew2").val(data[0].Scorew2);

                        $("#modelProductSpec_Scorew3").val(data[0].Scorew3);
                        $("#modelProductSpec_CutSheetLeng").val(data[0].CutSheetLeng);
                        $("#modelProductSpec_CutSheetWid").val(data[0].CutSheetWid);

                        $("#modelProductSpec_SheetArea").val(data[0].SheetArea);
                        $("#modelProductSpec_BoxArea").val(data[0].BoxArea);
                        $("#modelProductSpec_WeightSh").val(data[0].WeightSh.toFixed(3));
                        $("#modelProductSpec_WeightBox").val(data[0].WeightBox.toFixed(3));
                    }
            });

            $("#modelProductSpec_WeightBox").trigger('change');
            ll = $("#modelProductSpec_ScoreL2").val();
            wl = $("#modelProductSpec_ScoreL3").val();
            lr = $("#modelProductSpec_ScoreL4").val();
            wr = $("#modelProductSpec_ScoreL5").val();

            if ($('#chkGLwid').is(":checked")) {
                $("#modelProductSpec_ScoreL2").val(wl);
                $("#modelProductSpec_ScoreL3").val(ll);
                $("#modelProductSpec_ScoreL4").val(wl);
                $("#modelProductSpec_ScoreL5").val(lr - 3);
                if ($('#chkTwoP').is(":checked")) {
                    $("#modelProductSpec_ScoreL2").val(Number(wl) + 3);
                    $("#modelProductSpec_ScoreL3").val(Number(ll) - 3);
                }
            }

            RenderWid();

            document.getElementById("chkTwoP").disabled = false;
            document.getElementById("chkGLwid").disabled = false;
            document.getElementById("chkGLtail").disabled = false;

            if ($("#modelProductSpec_CutSheetLeng").val() > Piece2) {
                swal("หน้ากว้าง เกินความยาวที่เครื่องรับได้ กรุณาเลือก 2 ชิ้นต่อ", "", "");
            }
        }
    }
    function OnePiece() {
        $.ajax({
            url: "ComputeOneP",
            type: "POST",
            data: { Wid: $("#modelProductSpec_Wid").val(), Leg: $("#modelProductSpec_Leg").val(), Hig: $("#modelProductSpec_Hig").val(), ScoreL2: $("#modelProductSpec_ScoreL2").val(), CutSheetWid: $("#modelProductSpec_CutSheetWid").val(), Flute: $("#modelProductSpec_Flute").val(), JoinSize: $("#modelProductSpec_JointLap").val(), Slit: $("#modelProductSpec_Slit").val(), Weight: $('#modelProductSpec_Weight').val(), rscStyle: rscStyle, PlantCode: plant },
            async: false,
            success:
                function (data) {
                    $("#modelProductSpec_ScoreL2").val(data[0].ScoreL2);
                    $("#modelProductSpec_ScoreL3").val(data[0].ScoreL3);
                    $("#modelProductSpec_ScoreL4").val(data[0].ScoreL4);
                    $("#modelProductSpec_ScoreL5").val(data[0].ScoreL5);
                    $("#modelProductSpec_ScoreL6").val(data[0].ScoreL6);
                    $("#modelProductSpec_ScoreL7").val(data[0].ScoreL7);
                    $("#modelProductSpec_ScoreL8").val(data[0].ScoreL8);
                    $("#modelProductSpec_ScoreL9").val(data[0].ScoreL9);

                    $("#modelProductSpec_CutSheetLeng").val(data[0].CutSheetLeng);
                    $("#modelProductSpec_SheetArea").val(data[0].SheetArea);
                    $("#modelProductSpec_BoxArea").val(data[0].BoxArea);
                    $("#modelProductSpec_WeightSh").val(data[0].WeightSh.toFixed(3));
                    $("#modelProductSpec_WeightBox").val(data[0].WeightBox.toFixed(3));
                }
        });
        $("#modelProductSpec_WeightBox").trigger('change');
        if ($('#chkGLwid').is(":checked")) {
            ll = $("#modelProductSpec_ScoreL2").val();
            wl = $("#modelProductSpec_ScoreL3").val();
            lr = $("#modelProductSpec_ScoreL4").val();
            wr = $("#modelProductSpec_ScoreL5").val();

            $("#modelProductSpec_ScoreL2").val(wl);
            $("#modelProductSpec_ScoreL3").val(ll);
            $("#modelProductSpec_ScoreL4").val(wl);
            $("#modelProductSpec_ScoreL5").val(lr - 3);
        }

        RenderLen();
        $("#bigMidV").css("height", "56px");
        RenderDefault();

    }
    function TwoPiece() {
        $.ajax({
            url: "ComputeTwoP",
            type: "POST",
            data: { Wid: $("#modelProductSpec_Wid").val(), Leg: $("#modelProductSpec_Leg").val(), Hig: $("#modelProductSpec_Hig").val(), ScoreL2: $("#modelProductSpec_ScoreL2").val(), ScoreL3: $("#modelProductSpec_ScoreL3").val(), ScoreL4: $("#modelProductSpec_ScoreL4").val(), ScoreL5: $("#modelProductSpec_ScoreL5").val(), ScoreW1: $("#modelProductSpec_ScoreW1").val(), Scorew2: $("#modelProductSpec_Scorew2").val(), Scorew3: $("#modelProductSpec_Scorew3").val(), Flute: $("#modelProductSpec_Flute").val(), JoinSize: $("#modelProductSpec_JointLap").val(), Slit: $("#modelProductSpec_Slit").val(), TwoPiece: $('#modelProductSpec_TwoPiece').val(), Weight: $('#modelProductSpec_Weight').val(), GLWid: $('#modelProductSpec_GLWid').val(), rscStyle: rscStyle, PlantCode: plant },
            async: false,
            success:
                function (data) {
                    $("#modelProductSpec_ScoreL2").val(data[0].ScoreL2);
                    $("#modelProductSpec_ScoreL3").val(data[0].ScoreL3);
                    $("#modelProductSpec_ScoreL4").val(data[0].ScoreL4);
                    $("#modelProductSpec_ScoreL5").val(data[0].ScoreL5);
                    $("#modelProductSpec_ScoreL6").val(data[0].ScoreL6);
                    $("#modelProductSpec_ScoreL7").val(data[0].ScoreL7);
                    $("#modelProductSpec_ScoreL8").val(data[0].ScoreL8);
                    $("#modelProductSpec_ScoreL9").val(data[0].ScoreL9);
                    $("#modelProductSpec_JointLap").val(data[0].JointLap);

                    $("#modelProductSpec_ScoreW1").val(data[0].ScoreW1);
                    $("#modelProductSpec_Scorew2").val(data[0].Scorew2);
                    $("#modelProductSpec_Scorew3").val(data[0].Scorew3);

                    $("#modelProductSpec_CutSheetWid").val(data[0].CutSheetWid);
                    $("#modelProductSpec_CutSheetLeng").val(data[0].CutSheetLeng);
                    $("#modelProductSpec_SheetArea").val(data[0].SheetArea);
                    $("#modelProductSpec_BoxArea").val(data[0].BoxArea);
                    $("#modelProductSpec_WeightSh").val(data[0].WeightSh.toFixed(3));
                    $("#modelProductSpec_WeightBox").val(data[0].WeightBox.toFixed(3));
                }
        });
        $("#modelProductSpec_WeightBox").trigger('change');
        RenderTwoP();
    }
    function RenderTwoP() {
        ll = $("#modelProductSpec_ScoreL2").val();
        wl = $("#modelProductSpec_ScoreL3").val();
        hblx = Number(ll) + Number(wl);
        $("#modelProductSpec_ScoreL6").val(hblx);
        document.getElementById("lRx1").width = 0;
        document.getElementById("lRb").width = 0;
        document.getElementById("lRx2").width = 0;
        document.getElementById("wRx1").width = 0;
        document.getElementById("wRb").width = 0;
        document.getElementById("wRx2").width = 0;

        document.getElementById("lLx1").width = 300 * ll / hblx;
        document.getElementById("lLb").width = 300 * ll / hblx;
        document.getElementById("lLx2").width = 300 * ll / hblx;
        document.getElementById("wLx1").width = 300 * wl / hblx;
        document.getElementById("wLb").width = 300 * wl / hblx;
        document.getElementById("wLx2").width = 300 * wl / hblx;

        $("#bigMidV").css("height", "0px");

        document.getElementById("modelProductSpec_ScoreL6").style.left = "186px";
        document.getElementById("modelProductSpec_ScoreL2").style.left = "108px";
        document.getElementById("modelProductSpec_ScoreL3").style.left = "268px";

        //hblx = $("#modelProductSpec_ScoreL6").val();

        v1 = 49 + (300 * ll / hblx);
        document.getElementById("v1").style.left = v1 + "px";
        document.getElementById("v2").style.left = v1 + "px";
        document.getElementById("modelProductSpec_ScoreL7").style.visibility = "hidden";
        document.getElementById("modelProductSpec_ScoreL4").style.visibility = "hidden";
        document.getElementById("modelProductSpec_ScoreL5").style.visibility = "hidden";

        join = $("#modelProductSpec_JointLap").val();
        slit = $("#modelProductSpec_Slit").val();
        $("#modelProductSpec_ScoreL8").val(Number(ll) + Number(join));
        $("#modelProductSpec_ScoreL9").val(Number(wl) + Number(slit));
    }
    function RenderDC() {
        shLen = $("#modelProductSpec_CutSheetLeng").val();
        shWid = $("#SheetWid").val();

        if (shLen / shWid >= 1 && shLen / shWid <= 1.65) {
            dcWid = 200 * shLen / shWid + 10;
            document.getElementById("dc").width = dcWid;
        }
        else if (shLen / shWid > 1.65) {
            dcWid = 330;
            document.getElementById("dc").width = 330;
        }
        else {
            dcWid = 200;
            document.getElementById("dc").width = 200;
        }
        document.getElementById("dc").height = 200;

        $("#shLendc").css("width", dcWid + "px");
        document.getElementById("modelProductSpec_CutSheetLeng").style.left = (dcWid / 2) + 28 + "px";
        $("#shLdc2").css("left", dcWid + 39 + "px");

        $("#vdc").css("left", dcWid + 63 + "px");
        $("#hdc1").css("left", dcWid + 50 + "px");
        $("#hdc2").css("left", dcWid + 50 + "px");
        document.getElementById("modelProductSpec_CutSheetWid").style.left = dcWid + 46 + "px";

        if (formGroup == "SB") {
            document.getElementById("modelProductSpec_ScoreW1").style.left = dcWid + 46 + "px";
            document.getElementById("modelProductSpec_Scorew2").style.left = dcWid + 46 + "px";
            document.getElementById("modelProductSpec_Scorew3").style.left = dcWid + 46 + "px";
            document.getElementById("modelProductSpec_Scorew4").style.left = dcWid + 46 + "px";

            $("#vsb").css("left", dcWid + 99 + "px");
            $("#hsb1").css("left", dcWid + 86 + "px");
            $("#hsb2").css("left", dcWid + 86 + "px");

            if ($("#modelProductSpec_ScoreW1").val() != 0 && $("#modelProductSpec_ScoreW1").val() != "") {
                document.getElementById("modelProductSpec_CutSheetWid").style.left = dcWid + 80 + "px";
            }

        }
    }
    function ComputeDC() {
                $.ajax({
                    url: "ComputeDC",
                    type: "POST",
                    data: { CutSheetWid: $("#SheetWid").val(), CutSheetLeng: $("#SheetLeng").val(), SheetArea: $("#modelProductSpec_SheetArea").val(), BoxArea: $("#modelProductSpec_BoxArea").val(), Weight: $('#modelProductSpec_Weight').val() },
                    success:
                        function (data) {

                            $("#modelProductSpec_SheetArea").val(data[0].SheetArea);
                            $("#modelProductSpec_BoxArea").val(data[0].BoxArea);
                            $("#modelProductSpec_WeightSh").val(data[0].WeightSh.toFixed(3));
                            $("#modelProductSpec_WeightBox").val(data[0].WeightBox.toFixed(3));
                        }
        });
        $("#modelProductSpec_WeightBox").trigger('change');
    }
    function ComputeSF() {
        if (formGroup == "ROLL") {
            $("#modelProductSpec_BoxArea").val($("#modelProductSpec_SheetArea").val());
        }

        $.ajax({
            url: "ComputeSF",
            type: "POST",
            data: { CutSheetWid: $("#SheetWid").val(), CutSheetLeng: $("#SheetLeng").val(), SheetArea: $("#modelProductSpec_SheetArea").val(), BoxArea: $("#modelProductSpec_BoxArea").val(), Weight: $('#modelProductSpec_Weight').val(), Flag: $('#modelProductSpec_Flag').val() },
            success:
                function (data) {
                    $("#SheetLeng").val(data[0].CutSheetLeng);
                    $("#modelProductSpec_CutSheetLeng").val(data[0].CutSheetLeng);
                    $("#modelProductSpec_SheetArea").val(data[0].SheetArea);
                    $("#modelProductSpec_BoxArea").val(data[0].BoxArea);
                    $("#modelProductSpec_WeightSh").val(data[0].WeightSh.toFixed(3));
                    $("#modelProductSpec_WeightBox").val(data[0].WeightBox.toFixed(3));
                }
        });

        $("#w").val($("#SheetWid").val());
        $("#l").val($("#SheetLeng").val());

        $("#modelProductSpec_WeightBox").trigger('change');

    }
    function ComputeHC() {
        $.ajax({
            url: "ComputeHC",
            type: "POST",
            data: { Code: $("#modelProductSpec_Code").val(), Flute: $("#modelProductSpec_Flute").val(), CutSheetWid: $("#modelProductSpec_CutSheetWid").val(), CutSheetLeng: $("#modelProductSpec_CutSheetLeng").val(), Weight: $('#modelProductSpec_Weight').val(), PlantCode: plant },
            success:
                function (data) {
                    $('#ll').val(data[0].CutSheetLeng);
                    $("#modelProductSpec_CutSheetLeng").val(data[0].CutSheetLeng);
                    $("#modelProductSpec_SheetArea").val(data[0].SheetArea);
                    $("#modelProductSpec_BoxArea").val(data[0].BoxArea);
                    $("#modelProductSpec_WeightSh").val(data[0].WeightSh.toFixed(3));
                    $("#modelProductSpec_WeightBox").val(data[0].WeightBox.toFixed(3));
                }
        });
        $('#ll').show();
        $("#modelProductSpec_WeightBox").trigger('change');
    }
    function ComputeHB() {
        $.ajax({
            url: "ComputeHB",
            type: "POST",
            data: { Code: $("#modelProductSpec_Code").val(), Flute: $("#modelProductSpec_Flute").val(), CutSheetWid: $("#modelProductSpec_CutSheetWid").val(), CutSheetLeng: $("#modelProductSpec_CutSheetLeng").val(), Weight: $('#modelProductSpec_Weight').val(), PlantCode: plant },
            success:
                function (data) {
                    $("#modelProductSpec_shrink").val(data[0].shrink);
                    $("#modelProductSpec_stretch").val(data[0].stretch);
                    $("#modelProductSpec_widHC").val(data[0].widHC);
                    $("#modelProductSpec_lenHC").val(data[0].lenHC);
                    $("#modelProductSpec_SheetArea").val(data[0].SheetArea);
                    $("#modelProductSpec_BoxArea").val(data[0].BoxArea);
                    $("#modelProductSpec_WeightSh").val(data[0].WeightSh.toFixed(3));
                    $("#modelProductSpec_WeightBox").val(data[0].WeightBox.toFixed(3));
                }
        });
        $("#modelProductSpec_WeightBox").trigger('change');
    }
    function ComputeCG() {
            var notch = $('#modelProductSpec_NotchDegree').val();
            if (notch == 0)
                notch = $('#modelProductSpec_NotchDegreex').val();

        $.ajax({
            url: "ComputeCG",
            type: "POST",
            data: { Code: $("#modelProductSpec_Code").val(), SideA: $("#modelProductSpec_SideA").val(), SideB: $("#modelProductSpec_SideB").val(), SideC: $("#modelProductSpec_SideC").val(), SideD: $("#modelProductSpec_SideD").val(), CutSheetLeng: $("#modelProductSpec_CutSheetLeng").val(), Weight: $("#modelProductSpec_Weight").val(), No_Slot: $("#modelProductSpec_No_Slot").val(), IsNotch: $("#modelProductSpec_IsNotch").val(), NotchDegree: notch, NotchArea: $("#modelProductSpec_NotchArea").val(), IsWrap: $("#modelProductSpec_IsWrap").val(), CGType: $("#modelProductSpec_CGType").val(), NotchSide: $("#modelProductSpec_NotchSide").val()},
            success:
                function (data) {
                    $("#modelProductSpec_NotchArea").val(data[0].NotchArea);
                    $("#modelProductSpec_SheetArea").val(data[0].SheetArea);
                    $("#modelProductSpec_BoxArea").val(data[0].BoxArea);
                    $("#modelProductSpec_WeightSh").val(data[0].WeightSh.toFixed(3));
                    $("#modelProductSpec_WeightBox").val(data[0].WeightBox.toFixed(3));
                }
        });
            $("#modelProductSpec_WeightBox").trigger('change');
    }
    function RenderTeeth() {
                $.ajax({
                    url: "ComputeTeeth",
                    type: "POST",
                    data: { CutSheetWid: $("#modelProductSpec_CutSheetWid").val(), CutSheetLeng: $("#modelProductSpec_CutSheetLeng").val(), Slit: $("#modelProductSpec_Slit").val(), No_Slot: $("#modelProductSpec_No_Slot").val(), Weight: $('#modelProductSpec_Weight').val(), Scorew16: $('#modelProductSpec_Scorew16').val(), ScoreL8: $('#modelProductSpec_ScoreL8').val(), ScoreL9: $('#modelProductSpec_ScoreL9').val(), BoxArea: $('#modelProductSpec_BoxArea').val(), Wid: $('#modelProductSpec_Wid').val(), Leg: $('#modelProductSpec_Leg').val()  },
                    success:
                        function (data) {
                            hbl = data[0].ScoreL8;
                            hbr = data[0].ScoreL9;
                            h1 = data[0].Scorew16;

                            $("#modelProductSpec_ScoreL8").val(hbl);
                            $("#modelProductSpec_ScoreL9").val(hbr);
                            $("#modelProductSpec_Scorew16").val(h1);

                            $("#modelProductSpec_SheetArea").val(data[0].SheetArea);
                            $("#modelProductSpec_BoxArea").val(data[0].BoxArea);
                            $("#modelProductSpec_WeightSh").val(data[0].WeightSh.toFixed(3));
                            $("#modelProductSpec_WeightBox").val(data[0].WeightBox.toFixed(3));
                        }
        });
        $("#modelProductSpec_WeightBox").trigger('change');
    }
    function ComputeWeightAndArea() {
        if ($('#modelProductSpec_JointLap').val()  ==  0)
            join = $('#modelProductSpec_JoinSize').val();
        else
            join = $('#modelProductSpec_JointLap').val();

        boxa = $('#modelProductSpec_BoxArea').val();

        $.ajax({
            url: "ComputeWeightAndArea",
            type: "POST",
            data: { CutSheetWid: $("#modelProductSpec_CutSheetWid").val(), CutSheetLeng: $("#modelProductSpec_CutSheetLeng").val(), Slit: $("#modelProductSpec_Slit").val(), JointLap: join, No_Slot: $("#modelProductSpec_No_Slot").val(), Weight: $('#modelProductSpec_Weight').val(), Scorew2: $('#modelProductSpec_Scorew2').val(), Scorew16: $('#modelProductSpec_Scorew16').val(), BoxArea: boxa, Flag: $('#modelProductSpec_Flag').val(), Wid: $('#modelProductSpec_Wid').val(), Leg: $('#modelProductSpec_Leg').val() },
            success:
                function (data) {
                    $("#modelProductSpec_SheetArea").val(data[0].SheetArea);
                    $("#modelProductSpec_BoxArea").val(data[0].BoxArea);
                    $("#modelProductSpec_WeightSh").val(data[0].WeightSh.toFixed(3));
                    $("#modelProductSpec_WeightBox").val(data[0].WeightBox.toFixed(3));
                }
        });
        $("#modelProductSpec_WeightBox").trigger('change');
    }
    function chkNoSlot() {
        if ($('#modelProductSpec_No_Slot').val() == 1) {
            $('#tooth').show();
            $('#teeth2').hide();
            $('#teeth3').hide();

            document.getElementById("SheetWid").style.left = "338px";
            document.getElementById("SheetLeng").style.left = "198px";

            document.getElementById("modelProductSpec_ScoreL8").style.left = "150px";
            document.getElementById("modelProductSpec_Scorew16").style.left = "314px";
            $("#lbSlit").css("left", "208px");
            $("#lbSlit").css("top", "147px");

            $('#modelProductSpec_ScoreL9').hide();
        }
        else if ($('#modelProductSpec_No_Slot').val() == 2) {
            $('#tooth').hide();
            $('#teeth2').show();
            $('#teeth3').hide();

            document.getElementById("SheetWid").style.left = "337px";
            document.getElementById("SheetLeng").style.left = "196px";

            document.getElementById("modelProductSpec_ScoreL8").style.left = "124px";
            document.getElementById("modelProductSpec_ScoreL9").style.left = "198px";
            document.getElementById("modelProductSpec_Scorew16").style.left = "313px";
            $("#lbSlit").css("left", "163px");
            $("#lbSlit").css("top", "146px");

            $('#modelProductSpec_ScoreL9').show();
        }
        else if ($('#modelProductSpec_No_Slot').val() > 2) {
            $('#tooth').hide();
            $('#teeth2').hide();
            $('#teeth3').show();

            document.getElementById("SheetWid").style.left = "372px";
            document.getElementById("SheetLeng").style.left = "180px";

            document.getElementById("modelProductSpec_ScoreL8").style.left = "46px";
            document.getElementById("modelProductSpec_ScoreL9").style.left = "118px";
            document.getElementById("modelProductSpec_Scorew16").style.left = "350px";
            $("#lbSlit").css("left", "84px");
            $("#lbSlit").css("top", "146px");

            $('#modelProductSpec_ScoreL9').show();
        }

        if ($('#s').val() != "" && $('#n').val() != "")
            BindTeeth();

        $('#n').val($("#modelProductSpec_No_Slot").val());
        $('#s').val($("#modelProductSpec_Slit").val());
    }
    function BindTeeth() {
        if ($('#modelProductSpec_No_Slot').val() == 0) {
            $('#modelProductSpec_No_Slot').val(1);
            $("#modelProductSpec_NoSlot-error").hide();
        }

        var u = $('#modelProductSpec_Leg').val() / (parseInt($('#modelProductSpec_No_Slot').val()) + 1);
        $('#modelProductSpec_ScoreL8').val(Math.floor(u));
        $('#modelProductSpec_ScoreL9').val(Math.ceil(u));
    }
    function ClosePic() {
            $.ajax({
                url: "RemoveFileSpec",
                error: function () { }
            });
            $('#FilePic').hide();

        if ((formGroup == "STDRSC" || formGroup == "SPCRSC") && rscStyle != "Rotary") {
            if ($("#modelProductSpec_Scorew4").val() != 0 || $("#modelProductSpec_Scorew5").val() != 0 || $("#modelProductSpec_Scorew6").val() != 0 || $("#modelProductSpec_Scorew7").val() != 0 || $("#modelProductSpec_Scorew8").val() != 0 || $("#modelProductSpec_Scorew9").val() != 0 || $("#modelProductSpec_Scorew10").val() != 0 || $("#modelProductSpec_Scorew11").val() != 0 || $("#modelProductSpec_Scorew12").val() != 0 || $("#modelProductSpec_Scorew13").val() != 0 || $("#modelProductSpec_Scorew14").val() != 0 || $("#modelProductSpec_Scorew15").val() != 0 || $("#modelProductSpec_Scorew16").val() != 0) {
                $('#MainPic').hide();
            }
            else {
                $('#MainPic').show();
            }
        }
        else if (formGroup == "SB") {
            if ($("#sum").val() != 0) {
                $('#MainPic').show();
            }
            else {
                $('#MainPic').show();
            }
        }
        else if (formGroup == "CG") {
            $('#MainPic').show();
            if ($('#chkBak').is(":checked")) {
                if ($("#modelProductSpec_CGType").val() == "L") {
                    $('#cgLx').show();
                    $('#cgUx').hide();
                } else if ($("#modelProductSpec_CGType").val() == "U") {
                    $('#cgUx').show();
                    $('#cgLx').hide();
                    $('#cgLa').hide();
                }
                $('#cgL').hide();
                $('#cgU').hide();
                $('#cgB').hide();
            }
            else {
                if ($("#modelProductSpec_CGType").val() == "L") {
                    $("#cgL").show();
                    $("#cgU").hide();
                } else if ($("#modelProductSpec_CGType").val() == "U") {
                    $("#cgU").show();
                    $("#cgL").hide();
                }
                else if ($("#modelProductSpec_CGType").val() == "B") {
                    $("#cgB").show();
                    $("#cgL").hide();
                    $("#cgU").hide();
                }
                $('#cgLx').hide();
                $('#cgLa').hide();
                $('#cgUx').hide();
            }
        }
        else {
            $('#MainPic').show();
        }
        $('#RM_Drawing').hide();
        $('#PrintMaster').val("");
        $('#modelProductSpec_PrintMasterPath').val("");
        $('#Pic_Drawing').attr('src', "");
        if (formGroup == "STDDC" || rscStyle == "Rotary")
            document.getElementById("PrintMaster").style.top = "229px";
    }
    function show_Drawing(input) {
        if (input.files && input.files[0]) {
            var filerdr = new FileReader();
            filerdr.onload = function (e) {
                $('#Pic_Drawing').attr('src', e.target.result);
                $('#RM_Drawing').show();
                $('#MainPic').hide();
                $('#FilePic').show();
                document.getElementById("PrintMaster").style.color = "black";
                var temp = e.target.result;
                $('#iDrawingPath').val(temp);
                if (formGroup == "STDDC" || rscStyle == "Rotary")
                    document.getElementById("PrintMaster").style.top = "0px";
            }

            filerdr.readAsDataURL(input.files[0]);
        }

    }
    // Capture Dimension Properties Image To Base64String
    function CaptureDimension() {
        html2canvas(document.querySelector("#pic"),
            {
                scale: 2,
                width: 465,
                scrollX: -window.scrollX,
                scrollY: -window.scrollY,
                allowTaint: true,
                backgroundColor: '#fff'
            }).then(canvas => {
            $("#modelProductSpec_DimensionPropertiesImageBase64String").val(canvas.toDataURL());
            imagedata = canvas.toDataURL();

            submitPage();
        });
    }

    function CalculateAreaAndWeightOfRSC() {
        debugger;
        if (formGroup == "STDRSC" || formGroup == "SPCRSC" || formGroup == "STDDC" || formGroup == "AC") {
                w = width.value;
                l = length.value;
                h = height.value;
        }

        if (formGroup == "STDRSC" && rscStyle != "Rotary" ) {
            $('#modelProductSpec_spcLen').val(1);
            if (l == "" || l == "0" || w == "" || w == "0" || h == "" || h == "0") {
                if (l == "" || l == "0") {
                    $("#modelProductSpec_Leg-error").show();
                } else {
                    $("#modelProductSpec_Leg-error").hide();
                }
                if (w == "" || w == "0") {
                    $("#modelProductSpec_Width-error").show();
                } else {
                    $("#modelProductSpec_Width-error").hide();
                }
                if (h == "" || h == "0") {
                    $("#modelProductSpec_Hig-error").show();
                } else {
                    $("#modelProductSpec_Hig-error").hide();
                }
            }
            else {
                if ($('#l').val() != "" && $('#w').val() != "" && $('#h').val() != "") {
                    if ($("#modelProductSpec_Leg").val() == $('#l').val() && $("#modelProductSpec_Wid").val() == $('#w').val() && $("#modelProductSpec_Hig").val() == $('#h').val() && $('#c').val() == $('#modelProductSpec_Code').val()) {
                        ComputeWeightAndArea();
                    }
                    else {
                        RenderRSC();
                    }
                }
                else {
                    if ($("#modelProductSpec_WeightBox").val() != 0) {
                        ComputeWeightAndArea();
                    }
                    else {
                        RenderRSC();
                    }
                }

            }

            $('#l').val(l);
            $('#w').val(w);
            $('#h').val(h);
            $('#x').val($('#modelProductSpec_spcLen').val());
            $('#c').val($('#modelProductSpec_Code').val());

            document.getElementById("btDefault").disabled = false;
            document.getElementById("btScoreW").disabled = false;
            document.getElementById("btEdit").disabled = false;
        }
        else if (formGroup == "SPCRSC") {
            if (l == "" || l == "0" || w == "" || w == "0" || h == "" || h == "0") {
                if (l == "" || l == "0") {
                    $("#modelProductSpec_Leg-error").show();
                } else {
                    $("#modelProductSpec_Leg-error").hide();
                }
                if (w == "" || w == "0") {
                    $("#modelProductSpec_Width-error").show();
                } else {
                    $("#modelProductSpec_Width-error").hide();
                }
                if (h == "" || h == "0") {
                    $("#modelProductSpec_Hig-error").show();
                } else {
                    $("#modelProductSpec_Hig-error").hide();
                }
            }
            else {
                if (($('#l').val() == l && $('#w').val() == w && $('#h').val() == h && $('#x').val() == $('#modelProductSpec_spcLen').val() && $('#c').val() == $('#modelProductSpec_Code').val()) && $("#modelProductSpec_WeightBox").val() != 0) {
                    ComputeWeightAndArea();
                    }
                else {
                    chkSpcRsc();
                }
            }

            $('#l').val(l);
            $('#w').val(w);
            $('#h').val(h);
            $('#x').val($('#modelProductSpec_spcLen').val());
            $('#c').val($('#modelProductSpec_Code').val());

            document.getElementById("btDefault").disabled = false;
            document.getElementById("btScoreW").disabled = false;
            document.getElementById("btEdit").disabled = false;
            //la = l;
            //wa = w;
            //ha = h;
            //xa = $('#modelProductSpec_spcLen').val();
        }
        else if (formGroup == "AC") {
                if ($('#modelProductSpec_CutSheetWid').val() == "undefined" || $('#modelProductSpec_CutSheetWid').val() == 0) {
                    $("#modelProductSpec_SheetWid-error").show();
                } else {
                    $("#modelProductSpec_SheetWid-error").hide();
                }
                if ($('#modelProductSpec_CutSheetLeng').val() == "undefined" || $('#modelProductSpec_CutSheetLeng').val() == 0) {
                    $("#modelProductSpec_SheetLeng-error").show();
                } else {
                    $("#modelProductSpec_SheetLeng-error").hide();
                }
                if ($("#modelProductSpec_No_Slot").val() == 0) {
                    $("#modelProductSpec_No_Slot-error").show();
                } else {
                    $("#modelProductSpec_No_Slot-error").hide();
                }
                if (($('#modelProductSpec_CutSheetWid').val() != "undefined" && $('#modelProductSpec_CutSheetWid').val() != 0) && ($('#modelProductSpec_CutSheetLeng').val() != "undefined" && $('#modelProductSpec_CutSheetLeng').val() != 0) && $("#modelProductSpec_No_Slot").val() != 0) {
                    var xxx = $("#modelProductSpec_No_Slot").val() * $('#modelProductSpec_Slit').val();

                    if ($("#l").val() != "" && $("#w").val() != "" && $("#n").val() != "" && $('#s').val() != "") {
                        if (xxx >= $("#l").val())
                            swal("จำนวนร่องฟัน x ขนาดร่องฟัน ต้องน้อยกว่าความยาวรวมของ Board");
                        else
                            RenderTeeth();
                    }
                    else {
                        if (xxx >= $("#SheetLeng").val())
                            swal("จำนวนร่องฟัน x ขนาดร่องฟัน ต้องน้อยกว่าความยาวรวมของ Board");
                        else
                            ComputeWeightAndArea();
                    }
                }

                $('#l').val($("#SheetLeng").val());
                $('#w').val($("#SheetWid").val());
                $('#n').val($("#modelProductSpec_No_Slot").val());
                $('#s').val($("#modelProductSpec_Slit").val());
            }
        else if (formGroup == "STDDC" || rscStyle == "Rotary" || formGroup == "SB" || formGroup == "SS" || formGroup == "OFFSETTS")
        {
                if ($('#modelProductSpec_CutSheetWid').val() == "undefined" || $('#modelProductSpec_CutSheetWid').val() == 0) {
                    $("#modelProductSpec_SheetWid-error").show();
                }
                else if ($('#modelProductSpec_CutSheetLeng').val() == "undefined" || $('#modelProductSpec_CutSheetLeng').val() == 0) {
                    $("#modelProductSpec_SheetLeng-error").show();
                }
                else {
                    if ($("#SheetWid").val() < 10000 && $("#SheetLeng").val() < 10000)
                        ComputeDC();
                }
            }
        else if (formGroup == "SF") {

            if ($('#modelProductSpec_CutSheetWid').val() == "undefined" || $('#modelProductSpec_CutSheetWid').val() == 0) {
                $("#modelProductSpec_SheetWid-error").show();
            } else {
                $("#modelProductSpec_SheetWid-error").hide();
            }

            if ($('#modelProductSpec_CutSheetWid').val() != "undefined" && $('#modelProductSpec_CutSheetWid').val() != 0) {
                if (unit == 2) {
                    //if ($('#modelProductSpec_CutSheetLeng').val() == "0" || $('#modelProductSpec_CutSheetLeng').val() == "") {
                        ComputeSF();
                    //}
                    //else {
                    //    ComputeDC();
                    //}
                }
                else {
                    if ($('#modelProductSpec_CutSheetLeng').val() == "0" || $('#modelProductSpec_CutSheetLeng').val() == "") {
                        $("#modelProductSpec_SheetLeng-error").show();
                    }
                    else {
                        ComputeDC();
                    }
                    ComputeDC();
                }
            }
        }
        else if (formGroup == "ROLL") {
                if ($('#modelProductSpec_CutSheetWid').val() == "undefined" || $('#modelProductSpec_CutSheetWid').val() == 0) {
                    $("#modelProductSpec_SheetWid-error").show();
                } else {
                    $("#modelProductSpec_SheetWid-error").hide();
                    ComputeSF();
                }
            }
        else if (formGroup == "CG") {

            if ($("#modelProductSpec_CGType").val() == "B") {
                if ($('#modelProductSpec_SideB').val() == "" || $('#modelProductSpec_SideB').val() == 0 || $('#modelProductSpec_CutSheetLeng').val() == "" || $('#modelProductSpec_CutSheetLeng').val() == 0) {
                    if ($('#modelProductSpec_SideB').val() == "" || $('#modelProductSpec_SideB').val() == 0) {
                        document.getElementById("modelProductSpec_SideB").style.borderColor = "red";
                    } else {
                        document.getElementById("modelProductSpec_SideB").style.borderColor = "LightGray";
                    }
                    if ($('#modelProductSpec_CutSheetLeng').val() == "" || $('#modelProductSpec_CutSheetLeng').val() == 0) {
                        document.getElementById("modelProductSpec_CutSheetLeng").style.borderColor = "red";
                    } else {
                        document.getElementById("modelProductSpec_CutSheetLeng").style.borderColor = "LightGray";
                    }
                }
                else {
                    chkDegreeAndCompute();
                }
            }
            else if ($("#modelProductSpec_CGType").val() == "L") {
                if ($('#modelProductSpec_SideA').val() == "" || $('#modelProductSpec_SideA').val() == 0 || $('#modelProductSpec_SideB').val() == "" || $('#modelProductSpec_SideB').val() == 0 || $('#modelProductSpec_CutSheetLeng').val() == "" || $('#modelProductSpec_CutSheetLeng').val() == 0) {
                    if ($('#modelProductSpec_SideA').val() == "" || $('#modelProductSpec_SideA').val() == 0) {
                        document.getElementById("modelProductSpec_SideA").style.borderColor = "red";
                    } else {
                        document.getElementById("modelProductSpec_SideA").style.borderColor = "LightGray";
                    }
                    if ($('#modelProductSpec_SideB').val() == "" || $('#modelProductSpec_SideB').val() == 0) {
                        document.getElementById("modelProductSpec_SideB").style.borderColor = "red";
                    } else {
                        document.getElementById("modelProductSpec_SideB").style.borderColor = "LightGray";
                    }
                    if ($('#modelProductSpec_CutSheetLeng').val() == "" || $('#modelProductSpec_CutSheetLeng').val() == 0) {
                        document.getElementById("modelProductSpec_CutSheetLeng").style.borderColor = "red";
                    } else {
                        document.getElementById("modelProductSpec_CutSheetLeng").style.borderColor = "LightGray";
                    }
                }
                else {
                        chkDegreeAndCompute();
                }
            }
            else {
                if ($('#modelProductSpec_SideA').val() == "" || $('#modelProductSpec_SideA').val() == 0 || $('#modelProductSpec_SideB').val() == "" || $('#modelProductSpec_SideB').val() == 0 || $('#modelProductSpec_SideC').val() == "" || $('#modelProductSpec_SideC').val() == 0 || $('#modelProductSpec_CutSheetLeng').val() == "" || $('#modelProductSpec_CutSheetLeng').val() == 0) {
                    if ($('#modelProductSpec_SideA').val() == "" || $('#modelProductSpec_SideA').val() == 0) {
                        document.getElementById("modelProductSpec_SideA").style.borderColor = "red";
                    } else {
                        document.getElementById("modelProductSpec_SideA").style.borderColor = "LightGray";
                    }
                    if ($('#modelProductSpec_SideB').val() == "" || $('#modelProductSpec_SideB').val() == 0) {
                        document.getElementById("modelProductSpec_SideB").style.borderColor = "red";
                    } else {
                        document.getElementById("modelProductSpec_SideB").style.borderColor = "LightGray";
                    }
                    if ($('#modelProductSpec_SideC').val() == "" || $('#modelProductSpec_SideC').val() == 0) {
                        document.getElementById("modelProductSpec_SideC").style.borderColor = "red";
                    } else {
                        document.getElementById("modelProductSpec_SideC").style.borderColor = "LightGray";
                    }
                    if ($('#modelProductSpec_CutSheetLeng').val() == "" || $('#modelProductSpec_CutSheetLeng').val() == 0) {
                        document.getElementById("modelProductSpec_CutSheetLeng").style.borderColor = "red";
                    } else {
                        document.getElementById("modelProductSpec_CutSheetLeng").style.borderColor = "LightGray";
                    }
                }
                else {
                        chkDegreeAndCompute();
                }

            }
        }
        else if (formGroup == "HC") {
                if ($('#modelProductSpec_CutSheetWid').val() == "undefined" || $('#modelProductSpec_CutSheetWid').val() == 0) {
                    $("#modelProductSpec_SheetWid-error").show();
                }
                else {
                    ComputeHC();
                }
            }
        else if (formGroup == "HB") {
                if ($('#modelProductSpec_CutSheetWid').val() == "undefined" || $('#modelProductSpec_CutSheetWid').val() == 0) {
                    $("#modelProductSpec_CutSheetWid-error").show();
                }
                else if ($('#modelProductSpec_CutSheetLeng').val() == "undefined" || $('#modelProductSpec_CutSheetLeng').val() == 0) {
                    $("#modelProductSpec_CutSheetWid-error").hide();
                    $("#modelProductSpec_CutSheetLeng-error").show();
                }
                else {
                    $("#modelProductSpec_CutSheetWid-error").hide();
                    $("#modelProductSpec_CutSheetLeng-error").hide();
                    ComputeHB();
                }
            }
        else {
                if ($('#SheetWid').val() == "" || $('#SheetWid').val() == 0) {
                    $("#modelProductSpec_SheetWid-error").show();
                }
                else if ($('#SheetLeng').val() == "" || $('#SheetLeng').val() == 0) {
                    $("#modelProductSpec_SheetLeng-error").show();
                }
            }

        }
    function chkDegreeAndCompute() {
            var widBak = 0;
            if ($("#modelProductSpec_CGType").val() == "L") {
                if ($("#modelProductSpec_NotchSide").val() == "A")
                    widBak = $('#modelProductSpec_SideA').val();
                else
                    widBak = $('#modelProductSpec_SideB').val();
            }
            else if ($("#modelProductSpec_CGType").val() == "U") {
                if (Number($('#modelProductSpec_SideA').val()) >= Number($('#modelProductSpec_SideC').val()))
                    widBak = $('#modelProductSpec_SideA').val();
                else if (Number($('#modelProductSpec_SideC').val()) > Number($('#modelProductSpec_SideA').val())) {
                    widBak = $('#modelProductSpec_SideC').val();
                }
            }
            else {
                widBak = $('#modelProductSpec_SideB').val();
            }
            document.getElementById("modelProductSpec_SideA").style.borderColor = "LightGray";
            document.getElementById("modelProductSpec_SideB").style.borderColor = "LightGray";
            document.getElementById("modelProductSpec_SideC").style.borderColor = "LightGray";
            document.getElementById("modelProductSpec_CutSheetLeng").style.borderColor = "LightGray";
        if ($("#modelProductSpec_IsNotch").val() == "true" && (($("#modelProductSpec_NotchDegree").val() == 0 && $("#modelProductSpec_NotchDegreex").val() == "") || $("#modelProductSpec_No_Slot").val() == 0)) {
            if ($("#modelProductSpec_NotchDegree").val() == 0 && ($("#modelProductSpec_NotchDegreex").val() == 0 || $("#modelProductSpec_NotchDegreex").val() == ""))
                document.getElementById("modelProductSpec_NotchDegreex").style.borderColor = "red";
            else
                document.getElementById("modelProductSpec_NotchDegreex").style.borderColor = "LightGray";

            if ($("#modelProductSpec_No_Slot").val() == 0 || $("#modelProductSpec_No_Slot").val() == "")
                document.getElementById("modelProductSpec_No_Slot").style.borderColor = "red";
            else
                document.getElementById("modelProductSpec_No_Slot").style.borderColor = "LightGray";
        }
        else {
            document.getElementById("modelProductSpec_No_Slot").style.borderColor = "LightGray";
            document.getElementById("modelProductSpec_NotchDegreex").style.borderColor = "LightGray";
            document.getElementById("modelProductSpec_No_Slot").style.borderColor = "LightGray";
            //if ($("#modelProductSpec_IsNotch").val() == "true" && $("#modelProductSpec_CGType").val() == "L" && $("#modelProductSpec_NotchSide").val() == "")
            //    swal("Please Select Side for Notch!", "", "warning")
            //else
            if (($("#modelProductSpec_IsNotch").val() == "true" || $("#modelProductSpec_IsNotch").val() == "True") && Number(widBak) > Number($('#modelProductSpec_CutSheetLeng').val()/2))
                swal("Length L is too short.");
            else
                ComputeCG();
        }
        }
    function chkSpcRsc() {
            if ($("#modelProductSpec_Leg").val() == $('#l').val() && $("#modelProductSpec_Wid").val() == $('#w').val() && $("#modelProductSpec_Hig").val() == $('#h').val() && $('#x').val() == $('#modelProductSpec_spcLen').val() && $('#c').val() == $('#modelProductSpec_Code').val())
                ComputeWeightAndArea();
            else {
                if ($('#modelProductSpec_spcLen').val() == 0 || $('#modelProductSpec_spcLen').val() == "") {
                    RenderRSC();
                }
                else {
                    join = $('#modelProductSpec_JointLap').val();
                    if ($('#modelProductSpec_CutSheetLeng').val() == 0) {
                        a = $("#modelProductSpec_A").val();
                        b = $("#modelProductSpec_B").val();
                        slit = $('#modelProductSpec_Slit').val();
                        var aa = w * 2 + l * 2 + a * 3 + Number(b) + Number(slit) + Number(join);
                        if ($('#modelProductSpec_spcLen').val() > aa) {
                            RenderRSC();
                        }
                        else {
                            swal("Special Length is too less.", "", "warning");
                        }
                    }
                    else {
                        hblx = $("#modelProductSpec_ScoreL6").val();
                        hbrx = $("#modelProductSpec_ScoreL7").val();
                        var aa = Number(hblx) + Number(hbrx) + Number(join);
                        if ($('#modelProductSpec_spcLen').val() >= aa) {
                            RenderRSC();
                        }
                        else {
                            swal("Special Length must more than " + aa + ".", "", "warning");
                        }
                    }
                }
            }

        }

    const TypeList = @Html.Raw(Json.Serialize(@Model.modelProductSpec.Additive.Select(s => s.Type).Distinct()));
        var dup = [];

        function addStation() {

        var scntDiv = $('#p_scents');
        var Station = $("#Station").val().toUpperCase();
        var checkdup = true;

            $.each(dup, function (index) {
                if (dup[index] == Station) {
                    checkdup = false;
                }

            });
            if (checkdup) {
                if (Station == "") {
                    swal("Please Select Item!");
                } else {
                    dup.push(Station);
                    var index = dup.indexOf(Station);
                    scntDiv.append('<tr class="' + Station + '"><input type="hidden" class="Station" asp-for="modelProductSpec.CoatingTable[' + index + '].Station" value="' + Station + '"><td>' + Station + '</td><td>Top 3</td><td><select  class="form-control ' + Station + 'ty" onchange=selectType("' + Station + 'T3")  style="width: 100px; border: 0px;" name="modelProductSpec.CoatingTable.' + Station + 'T3Type" asp-for="modelProductSpec.CoatingTable.' + Station + 'T3Type"></select></td> <td><select class="form-control name" style="width: 200px; border: 0px;" asp-for="modelProductSpec.CoatingTable.' + Station + 'T3Name" name="modelProductSpec.CoatingTable.' + Station + 'T3Name"></select></td></tr> <tr class="' + Station + '"><td>' + Station + '</td><td>Top 2</td><td><select class="form-control ' + Station + 'ty" onchange=selectType("' + Station + 'T2") style="width: 100px; border: 0px;" asp-for="modelProductSpec.CoatingTable.' + Station + 'T2Type" name="modelProductSpec.CoatingTable.' + Station + 'T2Type"></select></td><td><select class="form-control name" style="width: 200px; border: 0px;" asp-for="modelProductSpec.CoatingTable.' + Station + 'T2Name" name="modelProductSpec.CoatingTable.' + Station + 'T2Name"></select></td></tr> <tr class="' + Station + '"><td>' + Station + '</td><td>Top 1</td><td><select class="form-control ' + Station + 'ty" onchange=selectType("' + Station + 'T1") style="width: 100px; border: 0px;" asp-for="modelProductSpec.CoatingTable.' + Station + 'T1Type" name="modelProductSpec.CoatingTable.' + Station + 'T1Type"></select></td><td><select class="form-control name" style="width: 200px; border: 0px;" asp-for="modelProductSpec.CoatingTable.' + Station + 'T1Name" name="modelProductSpec.CoatingTable.' + Station + 'T1Name"></select></td></tr><tr class="' + Station + '"><td>' + Station + '</td><td>Botton 1</td><td><select class="form-control ' + Station + 'ty" onchange=selectType("' + Station + 'B1") style="width: 100px; border: 0px;" asp-for="modelProductSpec.CoatingTable.' + Station + 'B1Type" name="modelProductSpec.CoatingTable.' + Station + 'B1Type"></select></td><td><select class="form-control name" style="width: 200px; border: 0px;" asp-for="modelProductSpec.CoatingTable.' + Station + 'B1Name" name="modelProductSpec.CoatingTable.' + Station + 'B1Name"></select></td></tr><tr class="' + Station + '"><td>' + Station + '</td><td>Botton 2</td><td><select class="form-control ' + Station + 'ty" onchange=selectType("' + Station + 'B2") style="width: 100px; border: 0px;" asp-for="modelProductSpec.CoatingTable.' + Station + 'B2Type" name="modelProductSpec.CoatingTable.' + Station + 'B2Type"></select></td><td><select class="form-control name" style="width: 200px; border: 0px;" asp-for="modelProductSpec.CoatingTable.' + Station + 'B2Name" name="modelProductSpec.CoatingTable.' + Station + 'B2Name"></select></td></tr> <tr class="' + Station + '"><td>' + Station + '</td><td>Botton 3</td><td><select class="form-control ' + Station + 'ty" onchange=selectType("' + Station + 'B3") style="width: 100px; border: 0px;" asp-for="modelProductSpec.CoatingTable.' + Station + 'B3Type" name="modelProductSpec.CoatingTable.' + Station + 'B3Type"></select></td><td><select class="form-control name" style="width: 200px; border: 0px;" asp-for="modelProductSpec.CoatingTable.' + Station + 'B3Name" name="modelProductSpec.CoatingTable.' + Station + 'B3Name"></select></td><td style="border: 1px solid transparent; border-left:black; width: 20px;"><a href="#" id="remScnt" onclick=DelStation("' + Station + '")><i class="fas fa-trash text-danger"></i></a></td></tr> ');

                    console.log(dup);
                }
                var list = document.getElementsByClassName(Station+"ty");

                for (var l = 0; l < list.length; l++) {
                    list[l].options[0] = new Option("", "");
                    for (var i = 0; i < TypeList.length; i++) {

                        list[l].options[i + 1] = new Option(TypeList[i], TypeList[i]);
                    }
                }
            } else {
                swal("Oops", "Something went wrong!", "error")

            }
        }

        function SaveCoating() {
            var array = [];
            var rows = $("#STA tbody tr");

            $.each(rows, function (index, row) {
                var columns = $(row).find("td");
                //  var ddd = $(row).find('input');
                var ccc = $(row).find('select');
                console.log(ccc);
                // console.log(columns);
                // debugger;
                array[index] = {};
                array[index].Station = columns[0].innerHTML;
                array[index].Layer = columns[1].innerHTML; // columns[1].innerHTML;
                array[index].Type = ccc[0].value;
                array[index].Name = ccc[1].value;

            });

            console.log(JSON.stringify(array));
            $.ajax({
                dataType: 'json',
                type: 'POST',
               // url: 'Coating',
                      url: '@Url.Action("Coating", "NewProduct")',
                data: { CoatingArray: JSON.stringify(array) },

                    success: function (data) {
                        $("#modal-coating").modal('hide');
                    }
                })

        }

    const NameList = @Html.Raw(Json.Serialize(Model.modelProductSpec.Additive));

    function selectType(tp) {
        if (tp != null) {
            var valtype = document.getElementsByName("modelProductSpec.CoatingTable." + tp + "Type")[0].value;
            //var Name = document.getElementsByName("modelProductSpec.CoatingTable." + tp + "Name")[0];
            //var Tag = "modelProductSpec.CoatingTable." + tp + "Name"+

            $('[name="modelProductSpec.CoatingTable.' + tp + 'Name"]').empty();
            $('[name="modelProductSpec.CoatingTable.' + tp + 'Name"]').append($("<option></option>").attr("value", "").text(""));
            for (var i = 0; i < NameList.length; i++) {

                if (NameList[i].Type == valtype) {
                    //Name.options[i + 1] = new Option(NameList[i].Code + " " + NameList[i].Description, NameList[i].Description);
                    $('[name="modelProductSpec.CoatingTable.' + tp + 'Name"]').append($("<option></option>").attr("value", NameList[i].Description).text(NameList[i].Code + " " + NameList[i].Description));
                }
            }
        } else {
        }
    }
    function DelStation(input) {
        var name = "." + input;
        $(name).remove();

        var Station = input.substring(0, 2)

        var index = dup.indexOf(Station);

        if (index > -1) {
            dup.splice(index, 1);
        }

    }

    function bindCoating()
    {
              $.ajax({
                  type: 'POST',
                  async: false,
                    url: '@Url.Action("GetGroupCoating", "NewProduct")',
                  success: function (res1) {
                      $.each(res1, function (index) {
                                    var total_element = $(".tblelement1").length;
                                    var lastid = $(".tblelement1:last").attr("id");
                                    var split_id = lastid.split("_");
                                    var nextindex = Number(split_id[1]) + 1;
                                    var max = 20;
                                    if (total_element < max) {
                                        $(".tblelement1:last").after("<div class='tblelement1 card card-outline-danger text-center' id='tbl_" + nextindex + "'><i class='fa fa-trash-alt tblremovetagprint' style='font-size:22px;position:absolute;right:50px;' aria-hidden='true' id='tbl_" + nextindex + "'></i> <div id='tbls_" + nextindex + "'> </div></div>");
                                       // var Station = $("#Station").val().toUpperCase();
                                        $.ajax({
                                            type: 'POST',
                                            async: false,
                                            url: '@Url.Action("editCoating", "NewProduct")',
                                            data: { station: res1[index] },
                                            success: function (res) {
                                                $("#tbls_" + nextindex).html(res)
                                            },
                                            error: function () { }
                                        });
                                    }
                      });
                    },
                    error: function () { }
            });
            $("#modal-coating").modal('show');
        }

    function ClearListTbl() {
        var countdiv = $(".tblelement1").length;
        var i;
        arrayid = [];
        for (i = 0; i < countdiv; i++) {
            var idelement = ""
            idelement = document.getElementsByClassName('tblelement1')[i].id;
            arrayid.push(idelement);
        }
        var j;
        for (j = 0; j < arrayid.length; j++) {
            idname = arrayid[j];
            if (idname !== "tbl_1") {
                $("#" + idname).remove();
            }
        }
    }

    function LoadingButton(value) {
        if (value) {
            $('#btnsavespec').hide();
            $('#btnNextLoad').show();
        } else {
            $('#btnNextLoad').hide();
            $('#btnsavespec').show();
        }
    }

    $(document).ready(function () {
        $('.tblcontainer1').on('click', '.tblremovetagprint', function () {
            var id = this.id;
            var split_id = id.split("_");
            var deleteindex = split_id[1];
            swal({
                title: "Are you sure ?",
                text: "Do you want delete .",
                icon: "warning",
                buttons: {
                    confirm: "Yes",
                    cancel: "No",
                },
                dangerMode: true,
            })
                .then((willDelete) => {
                    if (willDelete) {
                        $("#tbl_" + deleteindex).remove();
                    }
                });

        });
    });
    </script>

}